<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>종수술 등급 + KCD + ICD-O(형태/신생물코드) 통합 검색</title>
<style>
  :root{ --bg:#f6f8ff; --card:#fff; --ink:#14203a; --muted:#66759a; --line:#e6ecf7;
         --g1:#5b8cff; --g2:#22d3ee; --radius:18px; --shadow:0 12px 36px rgba(20,32,58,.08); }
  *{box-sizing:border-box} html,body{height:100%}
  body{margin:0;background:
       radial-gradient(900px 500px at 10% -10%, #eaf1ff 0%, transparent 60%),
       radial-gradient(900px 500px at 120% 0%, #f2fffb 0%, transparent 60%), var(--bg);
       color:var(--ink);font:15px/1.6 "Pretendard",ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Noto Sans KR,Arial;
       padding:28px;display:flex;justify-content:center;align-items:flex-start}
  .wrap{width:min(1120px,100%)}
  .title{margin:0 0 18px;text-align:center;font-weight:900;letter-spacing:.3px;font-size:clamp(22px,3.4vw,34px)}

  .panel{background:var(--card);border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
  .searchrow{display:grid;grid-template-columns:1fr auto;gap:10px;align-items:center}
  .searchbox{position:relative}
  .searchbox input{width:100%;height:58px;border:1px solid var(--line);border-radius:14px;padding:0 56px 0 16px;font-size:16px;outline:none;background:#fff;color:var(--ink)}
  .searchbox input:focus{border-color:#7aa2ff;box-shadow:0 0 0 5px #e8eeff}
  .btn{height:58px;padding:0 22px;border:0;border-radius:14px;font-weight:900;letter-spacing:.2px;cursor:pointer;
       background:linear-gradient(135deg,var(--g1),var(--g2));color:#fff;box-shadow:0 10px 24px rgba(91,140,255,.28)}
  .status{margin-top:8px;font-size:12px;color:var(--muted);text-align:right}

  /* autocomplete */
  .ac{position:absolute;left:0;right:0;top:62px;background:#fff;border:1px solid var(--line);border-radius:12px;box-shadow:var(--shadow);overflow:hidden;z-index:10;display:none}
  .ac.open{display:block}
  .ac ul{list-style:none;margin:0;padding:6px;max-height:360px;overflow:auto}
  .ac li{padding:10px 12px;border-radius:8px;cursor:pointer;display:flex;align-items:center;justify-content:space-between;gap:10px}
  .ac li:hover{background:#f6f9ff}
  .ac .code{font:12px/1.2 ui-monospace,Consolas,Menlo;color:#2f5bff;background:#eef3ff;border:1px solid #d8e2ff;padding:2px 6px;border-radius:6px}
  .ac .desc{font-size:12px;color:#6b7aa6}

  .grid2{display:grid;grid-template-columns:1fr 1fr;gap:14px;margin-top:14px}
  .card{background:#fff;border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);overflow:hidden}
  .card h3{margin:0;padding:14px 16px;font-size:16px;letter-spacing:.3px;color:#fff;background:linear-gradient(135deg,var(--g1),var(--g2));text-align:center}
  .card .body{padding:24px 16px;display:flex;align-items:center;justify-content:center;min-height:140px}
  .big{font-size:56px;font-weight:900;line-height:1}
  .muted{color:var(--muted)}

  .blk{margin-top:14px}
  .blk h3{margin:0;padding:14px 16px;font-size:16px;letter-spacing:.3px;color:#fff;background:linear-gradient(135deg,var(--g1),var(--g2));text-align:center;border-radius:12px 12px 0 0}
  .blk .body{border:1px solid var(--line);border-top:0;background:#fff;border-radius:0 0 12px 12px;padding:12px}
  .blk ul{margin:0;padding-left:20px}
  .blk li{padding:6px 0;border-bottom:1px dashed var(--line)}
  .blk li:last-child{border-bottom:0}
  .error{color:#c0392b}
</style>
</head>
<body>
  <main class="wrap">
    <h1 class="title">종수술 등급 + KCD + ICD-O 통합 검색</h1>

    <section class="panel">
      <div class="searchrow">
        <div class="searchbox">
          <input id="q" type="text" placeholder="예: 대장용종절제술 / K63.5 / 결장의 폴립 / M9523/3 / C30.0…" aria-label="검색" autocomplete="off" />
          <div class="ac" id="ac"><ul id="acList"></ul></div>
        </div>
        <button id="btn" class="btn">검색</button>
      </div>
      <div class="status" id="status">데이터 로딩 대기…</div>

      <div class="grid2">
        <div class="card">
          <h3>1~3종 수술비</h3>
          <div class="body" id="rA"><span class="muted">검색 후 표시</span></div>
        </div>
        <div class="card">
          <h3>1~5종 수술비</h3>
          <div class="body" id="rB"><span class="muted">검색 후 표시</span></div>
        </div>
      </div>

      <div class="blk">
        <h3>KCD 결과</h3>
        <div class="body"><ul id="kcdList"><li class="muted">검색 후 표시</li></ul></div>
      </div>

      <div class="blk">
        <h3>ICD-O(형태/연결 C코드)</h3>
        <div class="body"><ul id="icdoList"><li class="muted">검색 후 표시</li></ul></div>
      </div>
    </section>
  </main>

  <script>
  /* ===== 파일 경로 ===== */
  const KCD_XLSX  = "/assets/KCD-9.xlsx";     // A=KCD, B=한글명
  const ICDO_XLSX = "/assets/ICDO-3.xlsx";    // A=M코드, B=형태명칭, C=신생물(C코드)

  /* ===== DOM ===== */
  const elQ = document.getElementById('q');
  const elBtn = document.getElementById('btn');
  const elAC = document.getElementById('ac');
  const elACList = document.getElementById('acList');
  const elStatus = document.getElementById('status');
  const elRA = document.getElementById('rA');
  const elRB = document.getElementById('rB');
  const elK = document.getElementById('kcdList');
  const elM = document.getElementById('icdoList');

  const nz = v => (v ?? '').toString();
  const nkey = s => nz(s).replace(/\s+/g,'').trim();
  const isKcd = s => /^[A-TV-Z]\d{2}(\.\d+)?$/i.test(nz(s).trim());
  const isTopography = s => /^C\d{2}(\.\d)?$/i.test(nz(s).trim()); // C코드 허용
  const isIcdo = s => /^M\d{4}\/[0-9]$/i.test(nz(s).trim());
  const normalizeCode = c => nz(c).trim().toUpperCase().replace(/\s+/g,'');

  /* xlsx.js 로드 */
  (function ensureXLSX(){
    if(window.XLSX) return;
    const s=document.createElement('script');
    s.src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js";
    document.head.appendChild(s);
  })();

  /* ===== 저장소 ===== */
  let READY=false, READY_K=false, READY_M=false;

  // KCD
  let KCD_BY_CODE = new Map();     // 'K63.5' / 'K635' / 'C300' → '한글명'
  let KCD_NAME_IDX = [];           // [{code,name}]
  function addKcdRow(code, name){
    const c = normalizeCode(code);
    const n = nz(name).trim();
    if(!isKcd(c) || !n) return;
    const cNoDot = c.replace('.','');
    if(!KCD_BY_CODE.has(c))      KCD_BY_CODE.set(c,n);
    if(!KCD_BY_CODE.has(cNoDot)) KCD_BY_CODE.set(cNoDot,n);
    KCD_NAME_IDX.push({code:c,name:n});
  }

  // ICD-O (형태+연결 C코드)
  // M_BY_CODE: M코드 → {name, cTopos:[…]}
  // M_NAME_IDX: 형태명칭 인덱스
  // TOPO_TO_M: C코드(점/하이픈 제거 prefix) → Set(M코드)
  let M_BY_CODE = new Map();
  let M_NAME_IDX = [];
  let TOPO_TO_M = new Map();

  function normTopo(c){ // C34, C34.1, C34- → 'C34' / 'C341'
    if(!c) return null;
    let t = normalizeCode(c).replace(/[^A-Z0-9.]/g,'');
    if(!/^C\d{2}(\.\d)?$/.test(t)) {
      // 'C34-' 같이 접미 하이픈이 있을 수 있음 → 앞 3자리만
      const m = t.match(/^C(\d{2})/); if(m) return 'C'+m[1];
      return null;
    }
    return t.replace('.','');
  }
  function addIcdoRow(mCode, mName, cTopoRaw){
    const mc = normalizeCode(mCode);
    const mn = nz(mName).trim();
    const topo = normTopo(cTopoRaw); // null 허용
    if(!isIcdo(mc) || !mn) return;
    if(!M_BY_CODE.has(mc)) M_BY_CODE.set(mc, {name:mn, cTopos:new Set()});
    if(topo){
      M_BY_CODE.get(mc).cTopos.add(topo);
      if(!TOPO_TO_M.has(topo)) TOPO_TO_M.set(topo, new Set());
      TOPO_TO_M.get(topo).add(mc);
    }
    M_NAME_IDX.push({code:mc, name:mn});
  }

  function parseTwoColsKCD(sheet){
    const rows = XLSX.utils.sheet_to_json(sheet, {header:1, defval:"", raw:false, blankrows:false});
    for(const r of rows){ addKcdRow(r[0], r[1]); }
  }
  function parseThreeColsICDO(sheet){
    const rows = XLSX.utils.sheet_to_json(sheet, {header:1, defval:"", raw:false, blankrows:false});
    for(const r of rows){ addIcdoRow(r[0], r[1], r[2]); }
  }

  async function fetchAB(url){
    const res = await fetch(url, {cache:"no-cache"});
    if(!res.ok) throw new Error(`HTTP ${res.status} @ ${url}`);
    return await res.arrayBuffer();
  }
  async function loadKCD(){
    try{
      const ab = await fetchAB(KCD_XLSX);
      const wb = XLSX.read(ab, {type:'array'});
      parseTwoColsKCD(wb.Sheets[wb.SheetNames[0]]);
      READY_K = true;
      return true;
    }catch(e){
      READY_K = false;
      elK.innerHTML = `<li class="error">KCD 로드 실패: ${e.message}</li>`;
      return false;
    }
  }
  async function loadICDO(){
    try{
      const ab = await fetchAB(ICDO_XLSX);
      const wb = XLSX.read(ab, {type:'array'});
      parseThreeColsICDO(wb.Sheets[wb.SheetNames[0]]);
      READY_M = true;
      return true;
    }catch(e){
      READY_M = false;
      elM.innerHTML = `<li class="error">ICD-O 로드 실패: ${e.message}</li>`;
      return false;
    }
  }

  /* ===== 수술 RAW: 앞자리=1~3, 뒷자리=1~5 ===== */
  const RAW_DATA = String.raw`
12(내시경적) 위용종제거술
12(내시경적) 위출혈지혈술
11andrew method
11bassini repair
11halsted's operation
21IVS 수술
11Lichtenstein tension free hernioplasty
11lucas championniere's op.
11marcy's simple ringclosure
11mcvay repair
21MMK 수술
11shouldice hernioplasty
11TAPP laparoscopic hernia  repair
23Y-자 인공혈관 우회술
35Y-자 인공혈관 우회술
12가관절수술
12각막 궤양 냉동응고술
X1각막 봉합술
X1각막 봉합술
XX각막 성형술
XX각막 수술(굴절이상교정술)
12각막 이식술
1X각막 절개술 및 절제술
12각막 종양 냉동응고술
12각막 판누스 냉동응고술
XX각막궤양 결막피복술
XX각막궤양소작술 및 소파술
XX각막이물제거술
XX각막표층제거 및 결막피복술
12간경변에서 줄기세포이식술
12간경변에서 줄기세포이식술
24간낭종 적출술
24간내담관 공장문합술
24간내담관 문합술
24간농양 절개 배농술
24간동맥 결찰술(관혈술)
12간동맥화학색전술
24간분절절제술
13간암에 대한 고주파치료술
24간엽절제술
25간이식수술
24간파열 봉합술
24간폐고정술
23감각피판술
XX감돈 탈장 비관혈적 정복술
XX감돈포경정복술
13감마나이프수술
23감압 개두술
23감압 척수 절개술
23감압개두술
23갑상선 부분절제술
11갑상선 설관낭종 절제술
11갑상선 설관낭종 절제술
23갑상선 전절제술
23갑상선 종양적출술
23갑상선암의 고주파치료술
12갑상선양성종양고주파제거술
22개방성 악관절 원판정위술
12개방적정복술&내고정술(사지골)
22개복 전립선절제술
12개복 천공부 폐쇄 배액술
23개흉 혈종제거술
12거골종골 유합절제술
11거설증수술
11건 문합술
11건 봉합술
11건 성형술
11건 연장술
11건 이식술
11건 이전술
11건 절제술
11건초절개술
23건피판술
12견갑골 골절 관혈수술
12견갑골 하단 절제술
12견갑대 이단술
12견갑쇄골 골절 관혈적 정복술
12견골 골절관혈적 정복술
12견관절 탈구관혈적 정복술
11견관절 회전근개 재건술
12견관절오구돌기 이행술
12견괘관절탈구관혈정복술
12견봉성형술
12견봉하감압술
12견쇄관절 성형술
12견쇄관절 절제술
XX견쇄관절탈구 비관혈적 정복술
XX결막 결석제거술
XX결막 육아종적출술
XX결막 이물제거술
12결막 이식술
12결막 종양 냉동응고술
XX결막, 공막이물 제거술
1X결막공막 봉합술
12결막낭 성형술
12결막낭 이식술
24결장 아전적술
24결장 전절제술
12결장, 직장용종 절제술
24결장게실 적출술
24결장루 복원술(closure of colostomy)
24결장루 복원술(colostomy take down)
24결장루 복원술(repair of colostomy)
24결장루 조성술
12결장용종절제술
24결장종양적출술(개복)
12결절종적출술
12결핵관절소파술
23결핵성 복막염수술
12경골극 제거술
12경뇨도적 내요도 절개술
12경뇨도적 방광내수술
12경뇨도적 요관결석감압술
12경뇨도적 요관쇄석술
12경뇨도적 요관응혈제거술
12경뇨도적 요관종양적출술
12경뇨도적 요관협착확장술
12경뇨도적 요도 스텐트(부목)삽입술
12경뇨도적 요도 풍선카테터삽입술
12경뇨도적 요로결석제거술
12경뇨도적 용종절제술
12경뇨도적 전기소작응고술
12경늑절제술
23경동맥, 경정맥 결찰술
23경미로적 내이도 개방술
11경부임파선 절제술
11경부임파선 절제술
12경요도적 요로결석제거술
22경요도적전립선 고온도치료
22경요도적전립선 레이져절제술
22경요도적전립선 절제술
13경접형동적 뇌척수액비루폐쇄술
22경피적 강선자삽입 고정술(상악골, 하악골)
13경피적 개존증 폐쇄술(혈관 카테터)
12경피적 경막외강감압 신경성형술
13경피적 관상동맥 혈전용해술
13경피적 관상동맥 혈전용해술
13경피적 관상동맥성형술(혈관카테터)
13경피적 관상동맥중재술
13경피적 관상동맥중재술
13경피적 관상동맥확장술(성형술)
13경피적 관상동맥확장술(성형술)
23경피적 나사못고정술
22경피적 내시경,레이저 디스크 제거술
13경피적 담낭루조성술
12경피적 담낭루조성술
12경피적 담즙배액술
13경피적 동맥관 개존증 수술
13경피적 동맥관 개존증 폐쇄술
12경피적 신루술 또는 신루조성술
12경피적 신루술 &신루조성술
12경피적 신장결석적출술
23경피적 에탄올주입술
22경피적 위루 조성술(PEG : Percutaneous Endoscopic Gastrostomy)
12경피적 위루조성술
22경피적 자동 디스크 제거술
12경피적 척추성형술 및 고무풍선성형술
23고(대퇴)동맥사지혈관문합술
23고(대퇴)동맥인공혈관우회술
23고관절 치환술(인공고관절골두삽입술 or 치환술)
XX고관절 탈구비관혈적 정복술
23고막 성형술
23고막 유착증수술
XX고막 천공폐쇄술
11고막 환기관(통기관) 삽입술
XX고막절개술
22고색신경절제술
23고실 개방술
23고실 성형술
22고실 신경총절제술
11고위 결찰술
24고위 항문폐쇄(쇄항)근치수술
11고위결찰술(정맥류결찰술)
13고주파 전극도자 절제술(RFA)
22고환(정류정소) 고정술
22고환절제술
12골 단축술
12골 연장술
12골 전적술
23골결핵 소파술
XX골단연골발육 억제술
23골반 복막염수술
12골반 복막의 농양절개술
12골반 임파절곽청술
XX골반골절비관혈적 정복술
11골반부 탈장수술
22골반유착제거술
22골반유착제거술
23골병소 곽청술
23골병소 소파술(골수염 진단시)
23골수염, 골결핵수술
12골수이식수술
12골시멘트주입술
23골융합술(척추, 골반)
12골종양절제술(사지골)
12골편 절제술
23골피판술
24공동절개술
12공막 이식술
12공막단축술
12공막돌융술
12공막동륭술
12공막두르기
23공막절개술(녹내장)
23공막절제술(녹내장)
24공장 공장문합술
24공장 공장문합술
35관동맥 기시이상증 수술
35관동맥루 개흉적 차단술
XX관상동맥 조영술
13관상동맥 죽종제거술
13관상동맥 죽종제거술
35관상동맥 협착증수술(우회술)
12관절 고정술(관혈적)
12관절 골액막낭종 절제술
12관절 연마술
12관절 절제술
12관절경적세척술
11관절경하 건, 인대수술
22관절경하 악관절 원판정위술
12관절낭유리술
12관절내 골절 관혈적수술
12관절내 이물제거술
12관절내 활액낭종 적출술
12관절석 수술
XX관절수동술(비관혈적)
12관절탈구 관혈적정복술
XX관절포단축술
12관절활막 절제술
12관혈적 견쇄관절고정술
12관혈적 관절성형술
23관혈적 동맥혈전적출술
23관혈적 디스크 제거술
12관혈적 쇄골골절 접합술
12관혈적 쇄골골절 정복고정술
22관혈적 악관절 수동술
23관혈적 요도확장술
22광범 교감신경 절제술
32광범위 자궁전적제술
11광범위 정맥류 발거술
11광투시전동형 정맥류 제거술
22교감신경 절제술
12교정절골술 
XX구개열 성형술
11구개편도적출술
1X구순성형술
XX구순소대 성형수술
34그라함 폐쇄술
11근막봉합술
XX근염수술
11근육봉합술
23근육피판술
23근치유방절제술(변형)
23근치유방절제술(표준)
23근치유방절제술(확대)
23급성 범발성복막염수술
XX급성화농성관절염절개술(농배액)
12기관 이물제거술
11기관 절개술
11기관 절개술
12기관, 기관지 스텐트삽입술
24기관게실 절제술
XX기관봉합술
XX기관봉합술
XX기관절개공 봉합술(폐쇄술)
11기관절개술
11기관절개술
24기관지 절개술
12기관지 종양적출술
24기관지루 폐쇄술
24기관협착증 수술
23길리씨 수술
22난관 가교술
12난관 개구술 및 성형술
XX난관 결찰술
22난관난소 유착박리술
22난관난소 이식술
22난관난소 절제술
11난관난소혈종 전기응고술
11난관난소혈종 제거술
22난소 부분절제술
22난소 유피낭종 적출술
11난소낭종 알코올주입술
22난소낭종 절제술
11난소자궁내막증 전기소작술
23내경동맥 박리술
23내단락 설치술
12내시경적 담관(담도)결석제거
12내시경적 요관쇄석술
11내시경적 요관쇄석술
12내시경적 위용종 절제술
12내시경적 지혈술
12내안각 성형술
23내이 개창술
23내이 내임파낭 개방술(감압술)
23내이 전적제술
22내정소(고환)정맥 결찰술
11내직근후전술(사시 수술)
XX내향성 모조근치수술
23내흉동맥 결찰술
23너스 수술
12너슬씨 수술
13노빌리스 광자빔
23농흉 근치술
35뇌경막 혈관결찰술
23뇌경막하 혈종 - 오마야리저버 수술
23뇌경막하 혈종 오마야리저버수술
35뇌농양적출술(개두술 수반)
23뇌농양적출술(천공, 천두시)
35뇌동맥류 결찰술
13뇌동맥류 코일색전술
13뇌동맥류 코일색전술
35뇌동정맥기형 적출술
35뇌신경수술
23뇌실 개두, 천두 동반된 배농술
23뇌실-복강 단락술
23뇌실복강단락술
23뇌실-심방 단락술
23뇌실외배액술
23뇌실외배액술
23뇌정위적 혈종배액술
23뇌정위적 혈종배액술
35뇌종양 적출술
35뇌종양 적출술
35뇌지주막 유착박리술
35뇌척수액 폐쇄술(개두시)
35뇌척수액루 비루 폐쇄술
35뇌하수체선종 절제술
35뇌하수체종양 절제술
13뇌혈관 성형술
XX누관 절개술
12누관실리콘튜브 삽입술
12누낭누관 폐쇄술 및 적제술
12누비강 문합술
12누선절개술 및 적출술
12누소관 성형술
XX누점 절개술
XX누점 탐침술
12늑골 절제술
23늑골(흉골)골양수술 (caries operation)
12늑골골절 관혈적 정복술
XX늑골골절 비관혈적정복술
12늑연골 이식술
12다발성 연골성 외골종양적출술
12다발성 연골성외골종양 적출술
XX다지증수술
12단단성형술(골성형)
XX단순농양절제술
23단순유방절제술
22단순자궁전적제술
22단지증기형 성형수술(골이식동반시)
23담관 절개 결석적출술(관혈적)
23담관 종양 절제술
23담낭공장 문합술
23담낭공장루 조성술
12담낭루술
23담낭루술(내루에 한함)
23담낭위장문합술
23담낭절제술(개복 또는 복강경)
23담도 장문합술
23담도 재건술
23담도 절개술
24담도폐쇄증수술
13담석 레이져제거술
23담석 수술(개복 또는 복강경)
12담석레이저제거술
35대동맥 교액증 근치수술
35대동맥 근치수술
35대동맥 전환수술법
35대동맥 축착증 근치수술
35대동맥 협착증 근치수술
35대동맥간 우회로 조성술
12대망 절제술
12대장용종절제술
11대퇴 탈장수술
12대퇴골 개창술
XX대퇴골 골절 강선견인
12대퇴골 골절 내고정술
12대퇴골 골종양 적제술
12대퇴골 관혈적 골접합술
XX대퇴동맥 삽관술
23대퇴동맥 patch 봉합술
XX대퇴직달견인 발정술
XX더블유 성형술
XX도수정복술(사지골절 및 관절탈구)
12동공 성형술
12동공막 제거술
35동맥관 결찰술
23동맥관 우회절제술
23동맥류 적출술
XX동맥포트삽입술(간암)
23동맥피판술
23동정맥 문합술
23동정맥루 조성술
23두개 개두술
23두개 견인술
35두개강내 혈종, 수종, 이물제거술
23두개골 골절편 거상술
23두개골 성형술
23두개골 정복술
23두개골 종양 절제술
23두개골 집게형 견인
23두개골막하 혈종적출술
35두개내 간접 혈관문합술
35두개내 미세(미소)혈관감압술
23두개내 오마야리저버 삽입술
35두개내 직접 혈관문합술
35두개내 혈관문합술
23두개내 혈종 천공배액술
35두개내신경감압술(개두시)
13두개내신생물근치감마나이프 (Gammaknife)
13두개내신생물근치감마나이프 (Gammaknife)정위적방사선치료
23두개내압센서 삽입술
35두개인두종 절제술
23두개천공 경막성형술
22두씨 색시수술
12드워-바링톤수술
22등골 가동화수술
22등골 제거술
12디스크내 수핵성형술
12디스크내 고주파열 치료술
23라비치 수술
35라스텔리 수술법
35라트케열낭종 절제술
12레이저 쇄석술
11레이져 비염수술
11레이져 치핵절제술
24루 양 와이 문합술
24루프결장루 조성술
11루프환상투열 절제술
11루프환상투열 절제술
11루프환상투열 절제술(상피내암)
XX마이봄선(안검의 검선) 결석적출 및 절개술
24마일즈 수술
35마즈 수술
23만성경막하혈종 천공세정술
11맘모톰수술(치료목적에 한함)
12망막 광응고술
12망막 냉동응고술
12망막 레이져수술
12망막 열공의 냉동응고폐쇄
12망막박리 교정술, 복위술
12망막박리의 실리콘오일주입술
12망막박리증 수술
12망막박리증의 가스주입술
23매립형제세동기 교환술
23매립형제세동기 이식술
11맥도날드 수술
23맥락총 적출술(천공 및 천두)
XX맥립종 절개술
21맨체스터 수술
12맹장봉축술
35머스타드 수술법
12모양체 광(열)응고술
12모양체 냉동응고술
23모양체 박리술(녹내장)
12모양체 종양 절제술
23모양체 투열요법(녹내장)
12무지외반수술
22무지화수술(골이식시)
35문맥 하대정맥 문합술
23미로 적출술(개창술)
23미로 초음파수술
23미세현미경하 레이져 디스크제거술
22미주신경 절제술
11밀러근 단축술
11밀리건-모건 치핵근본수술
XX바르톨린선 낭종 절제술
XX바제도우씨병(그레이브스병)
12반월판 봉합술
12반월판 부분절제술
12반월판 적출술
12반월판연골 절제술
12반카트수술(방카르트수술)
XX반흔구축절제
XX반흔절제
11반흔탈장 수술
21발만 수술
XX발정술
XX발조술
XX발치, 의치
23밧줄피부판이식술
22방광 부분절제술
22방광 요관문합술
22방광 전절제술
22방광 파열봉합술
22방광 파열폐쇄술
22방광게실절제술
22방광경부견인술
XX방광내 응혈제거술
22방광뇨관역류수술
22방광루 수술
21방광류 수술
22방광문합술
XX방광세정
12방광종양소작술(내시경)
XX방광천자
13방사선 내부조사
21백내장 수술
21버치수술
22버치수술
12베이커낭종 적출술
XX변연절제술
12변형 반카트수술(변형 방카르트수술)
12변형 페미스터수술
12변형치유골절 성형술
11보행정맥류 절제술
24복강경하 간낭포절제술
24복강경하 간절제술
24복강경하 결장, 소장, 직장 절제술
23복강경하 비장적출술
11복강경하 서경헤르니아수술
22복강경하 식도하부 미주신경 선택적절제술
24복강경하 신적출술
34복강경하 위절제술
22복강경하 자궁적출술
12복강경하 충수절제술
22복강내 고환절제술
12복강내 연결된복벽누공 적출술
12복막 성형술
12복막투석용 도관삽입술
XX복벽농양절개술
12복부자창에 의한 개복술
22복식 난소출혈 지혈술
23복합조직이식술
24복회음절제술
23부갑상선 선종과형성 적출술
23부갑상선 절제술
22부고환 적출술
23부골적출술(골수염진단시)
23부분층피부이식술
11부비강 개방술
11부비강 공성형수술
11부비동 수술
24부신 부분절제술
24부신 수질절제술
24부신 전절제술
24부신 종양적출술
24부신 피질절제술
XX부암검 수술(덧눈꺼풀)
11부유방절제술
XX부이(개) 절제술
35부전도로절단술
35부정맥수술
12부주상골 절제술(키드너수술)
XX분만시경관열상봉합술
23분문성형술(복강경하 포함)
24브라운 문합술
24브라운 문합술
11브로스트롬수술
35블라록-한론 심방중격절제술
XX비강점막소작술
11비골골절 관혈적 정복술
11비골골절 도수정복술 및 교정술
11비골골절 비관혈적 정복술
11비골골절 폐쇄적 정복술
XX비골낭포적출 및 절개술
XX비골농양적출 및 절개술
11비골변형 치유골절 교정술
22비골신경초절개술
XX비골혈종적출 및 절개술
XX비관혈적 장중첩증정복술
23비구주위 회전절골술
11비내 전두동수술
XX비내이물제거술
12비동맥류 색전술
12비루관 문합술
12비루관 부지법
11비부비강 종양적출술
23비신정맥 문합술
11비염으로 인한중비갑개절제술
11비염으로 인한하비갑개 레이져절제술
11비염으로 인한하비갑개 절제술
XX비용종 적출술
11비인강 섬유종 적출술
11비인두 양성종양 절제술
12비장 봉합술
23비장동맥류 결찰술
23비장적축술
23비장파열 제거술
XX비중격 교정술
XX비중격만곡증수술
XX비출혈 소작술
XX비출혈 지혈법
34빌로쓰 수술(BillrothⅠ, Ⅱ)
11사경수술
11사골동, 접형동 수술
23사지 재절단술
23사지 절단술
12사지골절 관혈수술
12사지골절K-강선고정술(핀, 나사못 포함)
23사지관절 이단술
12사지관절 절제술
23사지접합수술
XX산립종 적출술 및 절개술
XX산립종 절개술
35삼차신경 감압술(개두술수반)
XX삼차신경 반월신경절 파괴술
12상고실 유돌동 개방술
12상사근 이동술
22상악골 관혈수술
XX상악골함몰 지방이식술
11상악동 근본수술
11상악동 비내수술
11상악동, 사골동 근본수술
11상악동, 사골동, 전두동 근본수술
11상악동, 사골동, 접형동 근본수술
XX상악동성후비공 폴립절제술
11상안거근 단축술
12상직근 단축술
11서경 고음순 헤르니아근본수술
11서혜 탈장수술
XX선천성 고관절 탈구 비관혈적 정복술
X2선천성 비루관폐색 개방술
XX선천성 이루관 적출술
XX선천성 이루관 폐쇄술
XX설 성형수술
XX설계반흔성 단축교정술
12설상절골술
XX설소대 절단술
11설절제술
12설하선 적출술
12설하선 종양적출술
23섬유주 절제술(녹내장)
12성대물혹 미세 후두경절제술
12성체줄기세포 이식술
24세기관지 이물제거술
23세정 및 배액술(복막염)
21셔터 수술
XX소이증 수술
24소장 절제술
24소장게실 적출술
24소장루 폐쇄술
24소장종양 적출술
12쇄골골절 관혈적 정복술
XX쇄골골절 비관혈적 정복술
12쇄골전절제술
12수근골 절제술
23수두증 수술
23수액단락술
21수정체 낭내 적출술(백내장)
21수정체 낭외 적출술(백내장)
21수정체 냉동적출술(백내장)
21수정체 초음파유화흡입술(백내장)
11쉬로드카 수술
21스파크 수술
21스파크 수술
12슬개골 부분절제술
12슬개골활액낭 절제술
11슬개인대 단열봉합술
11슬관절 건 막리술
12슬관절내유리체 적출술
21슬링 수술
21슬링 수술
12슬와낭종 적출술
35승모판 협측증수술
11시톤수술(설치술)
23시험적 개두술
12시험적 개복술
12시험적 개복술 및 개흉술
23시험적 개흉술
23식도 게실절제술
34식도 성형술
23식도 아칼라지아 근절개술
23식도 이물제거술
34식도 재건술
34식도기관지루 폐쇄술
23식도분문 성형수술
11식도열공 탈장수술
23식도열공 헤르니아수술
34식도위문합술(복강내)
34식도이단봉합술(식도정맥류)
12식도이완불능증 풍선확장술
34식도입구 종양적출술
34식도전 적제술
12식도정맥류 결찰술
12식도정맥류 결찰술(내시경적)
12식도정맥류 경화요법
12식도정맥류 경화요법(내시경적)
23식도주위 농양절제유도술
23식도폐쇄증 근치수술
22식도하부 미주신경 선택적 절제술
12식도협착증에서 부지삽입술
23식피술(표피, 피부판)
22신경 매몰술
22신경 문합술
22신경 박리술
22신경 봉합술
22신경 염제술
22신경 이식술
22신경 이행술
22신경건 박리술
22신경종 절제술
XX신경차단술
XX신경탐험술
24신고정술
24신낭종 조대술
23신동맥혈관 성형술
23신동맥혈관 우회술
13신생물 근치 방사선조사
24신우(뇨관)성형술
XX신우세정
24신우절석술
24신장 파열봉합술
24신장결석쇄석술
24신장결석쇄석술
44신장결석제거술(관혈적)
XX신장낭포 천자알코올고정술
XX신장낭포 천자축소술
35신장이식술
35신장이식술
12신장절제 후 심부누공 근본수술
24신장주위 임파선 절제술
24신적출술
11신전건 봉합술
24신전절제술
24신절개술
24신절반술
23신혈관성 고혈압증 수술
23심근 전극 교환술
24심낭루조성술
24심낭창성형술
35심내막상결손증수술
24심막낭포 절제술
24심막낭포 박리절제술
24심막봉합술
24심막절개술
23심박조절기 매입술
23심박조절기 이식술
35심방전환수술법
35심방중격결손증수술
35심방중격결손증수술
35심실 빈맥증수술
35심실중격결손증수술
35심실중격결손증수술
35심장이식수술
XX심혈관 조영술
24십이지장 게실절제술
24십이지장 궤양수술
24십이지장게실 절제술
24십이지장게실 절제술
11십자인대 성형술
11십자인대 접합술
22쌍각자궁 수술
35씨닝 수술법
11아킬레스건 단열봉합술
11아킬레스건 봉합술
11아킬레스건 성형술
11아킬레스건 연장술
22악골골절 관혈수술
22악관절 관혈적 정복술
XX악관절 수동술
35악성신생물 근치수술
13악성신생물 온열요법
12악하선 적출술
12악하선 종양적출술
XX안검 종양 냉동응고적출술
XX안검내반증 수술
XX안검농양 절개술
XX안검외반증 수술
XX안검종양 절제술
XX안검판 봉합술 및 절제술
11안검하수증 수술
23안구 내용제거술
23안구 적제 및조직 or 의안태 충전술
23안구 적출술
23안구 전적제술
12안구 천공 이물 제거술
XX안구조직내 PEG 삽입술
12안근 이식술
XX안면거상술
23안면다발골절 관혈적수술
22안면신경 감압술
22안면신경 박리술
22안면신경 재생 및 이식술
22안면신경관 개방술
12안와 내용제거술
XX안와 농양 절개술
XX안와 농양절개술
XX안와 누공 삽입술
23안와 누선종양 적출술
23안와 종양적출술
12안와내 이물적제술
23안와내 종양적출술
23안와벽재건술
23안와상 골절 정복술
12양막이식술(각막표면제거술)
12양막이식술(결막표면재건술)
12연골이식술
12연골판 부분절제술
11연부조직 종양적출술 지방종
23와다 수술
XX와단락 혈전제거술
35와터스톤 수술
XX외비성형술
XX외요도구 절개술
XX외이도 골종절제술
XX외이도 골증생(외골종)절제술
XX외이도 성형수술
XX외이도 외골종 절제술
XX외이도 이물제거술
XX외이도 종양적출술
XX외이도 진주종수술
XX외이도 폐쇄증수술
XX외치핵 동결술
11외향비갑개 골절술
12요골 골낭종 절제술
23요골동맥봉합술(문합술)
24요관 절석술(관혈적)
23요도 게실절제술
23요도 양성종양 적출술
23요도 절개술
12요도결석(이물)제거술
23요도류 수술
23요도상열성형수술
23요도성형술 또는 재건술
XX요도주위농양 절개술
12요도판막 근치술
12요도판막근치술
23요도하열성형수술
23요도협착수술
23요루절제술
21요실금 교정술(TVT 및 테이프술식)
21요실금 교정술(TVT 및 테이프술식)
21요실금 근본수술
21요실금 근본수술(근본술로 정가능수술에한함)
23요추 복강단락술
12우각 광응고술
23우각절개술 및우각 천자술(녹내장)
24우측결장 절제술
12원추각막 수술
11원추절제술
11원추절제술
12웨버-던 수술
34위 근전절제술
34위 부분절제 및위 공장문합술
34위 부분절제 및위 십이지장문합술
34위 부분절제술
23위 분문근 절제술
34위 상부 이단술
34위 쐐기절제술
34위 아전절제술
23위 유문근 절제술
34위 전절제술
34위 절제술
34위 축소술
34위 횡단술
23위공장문합술(암)
34위궤양 근치술
23위궤양 천공봉합술
23위루 폐쇄술
23위루(위장루)조성술
24위유문부보존췌장십이지장 문합술
23위장조루술 or 위조루술(개복)
23위절개술
23위점막하 종양적출술
XX위축성비염점막하이물삽입술
34위플 수술(췌장십이지장 문합술)
23유경피부판이식술
12유돌동 삭개술
12유돌동 충전술
23유리피판술
34유문 공치술
34유문동 절제술
23유문성형술
23유미흉 수술
23유방 보존수술
23유방 부분절제술
23유방 쐐기절제술
11유방 양성종양적출술
11유방 이형성적출술(제거술)
23유방 1/4절제술
11유방농양제거술
11유방소괴(결절)제거술(적출술)
23유방암의 냉동응고 적출술
23유선 전절제술
12유양동 개방술
12유양동 삭개술
22유착성 자궁부속기 적제술
12윤상체결술
22음경성형술
33음경전적제술
33음경절단술
XX음경콘딜로마 절제술
11음낭 탈장수술
XX음낭농양 절개술
11음낭수종 근본수술
XX음낭수종천자 흡입술
23의안 포매술
1X이개 성형수술
XX이개 종양적출술
XX이개 혈종개창술
23이과적 두개내 수술
11이관내 튜브 삽입술
11이관내 튜브삽입술
XX이륜매몰증 성형술
22이소골 재건술
XX이용적출술
23이하선 심엽적출술
23이하선 적출술
23이하선 종양적출술
23이하선 천엽적출술
23이하선 혼합종양적출술
XX이후누공봉합술
XX익상편 적출술
22인골골이식술
12인공골두 삽입술 또는 치환술
12인공관절치환술(인공관절수술)
21인공괄약근 삽입술(요실금)
21인공괄약근 삽입술(요실금)
22인공방광 조성술
21인공수정체 이식술(백내장)
34인공식도 설치술
23인공와우이식술
XX인공임신중절술
22인공정액류 설치술
22인공중이 매입술
24인공항문 조성술
24인공항문루 복원술
XX인공항문확장술
23인공혈관 치환술
11인대고정술
11인대봉축술
11인대성형술
11인대재건술
12일리자로브 외고정술
12자가연골세포 이식술
11자궁경관 결찰술
11자궁경관 봉축술
X1자궁경관 용종절제술
XX자궁경관 확장술
X1자궁경관용종 절제술
11자궁경부미란 고주파응고술
11자궁경부미란 고주파응고술
11자궁경부미란 레이져수술
11자궁경부미란 레이져수술
21자궁고정술
21자궁근종 고주파용해술
21자궁근종 용해술
22자궁근종 적출술
21자궁내막 유착박리술
21자궁내막소파술
22자궁부속기 유착박리술
22자궁부속기 절제술
22자궁부속기 종양적출술
21자궁소파수술
22자궁외임신 수술
22자궁절제술
22자궁종양 적출술
XX자궁질 절개술
X1자궁질부 냉동응고술
XX자궁질부 냉동응고술
X1자궁질부 소작술
XX자궁질부 소작술
11자궁체부용종 절제술
21자궁탈 수술
22자궁파열수술
11자동봉합기 치핵절제술
22잠복고환절제술
24장간막 종양적출술
24장간막복원술
12장골, 척골 절제술
22장골이식수술
24장관유착박리술
24장문합술
24장유착박리술
24장절개술
24장중첩수술
12장지관절 활막절제술
24장폐색수술
24저위전방절제술
11저위폐쇄항문(쇄항)근치수술
13전극도자 절제술
13전극도자 절제술(경피적 부전도로 절제술)
13전극도자 절제술(경피적 부전도로 절제술)
11전두근 수술
11전두동 근본수술
11전두동, 사골동 근본수술
11전두동, 사골동, 접형동 근본수술
22전립선 결석제거술
22전립선 농양절개술
22전립선 정낭 절제술
22전립선 피막하 적출술
23전립선암의 냉동수술요법
12전방, 홍채, 초자체내이물제거술
12전방우각 이물제거술
24전방절제술
XX전방천자
11전부비강 근본수술
23전이 병소의 수술
XX전이개 누공절제술
XX전자파온열요법(암온열요법)
12전층각막이식술
23전층피부이식술
12절골술(골절술)
23절단에 대한사지접합수술
12점액낭염 적출술
11접형동 근본비내수술
22정계(정색)정맥류 절제술
22정계정맥류수술(고환정맥류 결찰술)
XX정관 결찰술
22정관 결핵병소 절제술
22정관 성형수술
XX정관 재개통술
XX정관 절단술
22정관 종양수술
22정낭 절제술
11정맥류 고주파요법
11정맥류 레이져요법
11정맥류 박리 및 발거술
11정맥류 절제술
23정맥피판술
23정맥혈전정맥염 관혈적수술
12정복고정술
22정색수종근본수술
22정색염전수술
22정액류 적출술
12제1족지 외반증교정수술
23제3뇌실 개통법
11제대 탈장수술
11제왕절개만출술
XX제트 성형술
XX조갑적출술
12조혈모세포이식술
35조혈모세포이식술(혈액암)
12족관절 고정술(관혈적)
23족관절 절단술
12족삼관절 고정술
24종격기관구성형술
23종격동 이물제거술
34종격동 종양적출술
12종골골절 관혈수술
XX종골골절 직달견인
11좌골 탈장수술
24좌측 결장절제술
12주관절골연골종 적출술
12주상골골편 적출술
22중복자궁 수술
11중비갑개 절제술 및 점막절제술
12중심부감압술
XX중심정맥 영양법
12중심정맥관삽관술
22중이 근본수술
22중이 성형술(고실성형술)
12중족골외골종 적출술
12증식성 초자체망막증 수술
23지연피판술
22지이식수술
24직결장전절제술 & 회장루조성술
22직장거상고정술
22직장류 수술
22직장점막탈 성형수술
24직장종양적출술(개복)
XX직장주위 농양배액술
22직장탈 근본수술
22진주종성 중이염근치수술
21질벽성형수술과 자궁위치교정술
11질벽성형수술과 자궁전적술
XX질벽열창 봉합술
21질식 자궁방광 고정술
XX질전벽 협축술(성형술)
21질탈수술
XX창상봉합술
12처자체 치환술
22척골신경 박리술
22척골신경 이식술
22척골신경 전방이식술
12척골원위단 절제술
34척수 동맥기형 적출술
34척수 수내종양 적출술
34척수 수외종양 적출술
23척수 절제술
34척수 혈관종 적출술
23척수강 수액 단락술
23척수경막 절제술
23척수경막내 수술
23척수경막외 수술
23척수내 신경로 절단술
23척수늑골돌기 절제술
12척추 경피적 성형술
23척추 고정술
13척추 수핵융합술(척추 수핵융해술)
23척추 추체소파술
23척추 해링통수술
23척추 후부소파술
22척추, 골반골 이식술(이식용)
23척추강 협착증수술
23척추골, 골반종양절제술
23척추골절관혈술전방고정술
23척추골절관혈술후방고정술
23척추극돌기 절제술
23척추수액루 폐쇄술
23척추열 수술
23척추측만증 수술
23척추탈구 관혈적수술
XX척추탈구 비관혈적 정복술
23천공배액술
23천두생검술
23천두술
23천두술 통한 뇌척수액배액
23천두술을 통한 뇌척수액배액법
XX첩모발거술
35청신경종양 적출술
13체강 또는 간질내 동위원소치료
13체내용 경정맥 심박기 삽입술
13체내용 경정맥 심박기삽입술(혈관카테터)
23체외뇌실배액
23체외뇌실배액법
XX체외용 인공심박기 장치술
22체외충격파쇄석술 - 담낭(담석)
22체외충격파쇄석술 - 신장(신결석)
22체외충격파쇄석술 - 요관결석
22체외충격파쇄석술 - 요로결석
22체외충격파쇄석술 - 췌장(췌석)
35체폐동맥 단락술
22초음파 가이드 레이져 전립선 절제술
12초자체 박리술
12초자체 이단술
12초자체 절제술
12초자체 흡인술
23총담관 낭종봉축술
23총담관 절개술
23총담관위(장) 문합술
23추궁절제술
12추벽 절제술
23추체돌기 개방술
22추체첨단부수술
XX출혈성 비용적출술
12충수절제술
22충수주위 농양수술
24췌관 공장문합술
24췌관 외루 조성술
24췌관 유도수술
24췌낭포 외루조성술(개복)
24췌낭포 위(장)문합술
24췌루 폐쇄술
24췌장 결석적출술
24췌장 공장문합술
24췌장 낭포조대술
24췌장 농양외루술
24췌장 미측절제술
24췌장 부분절제술
24췌장관 문합술
24췌장관 수술
24췌장낭종장문합술
24췌장낭포외루조성술
24췌장염수술(급성, 만성)
25췌장이식술
24췌장전절제술
24췌장피막절제술
24췌종양 적출술
23측두골 절제술(소파술)
23치골결합해리 관혈적수술
XX치골결합해리비관혈적 정복술
11치루근본수술
11치루절제술
XX치수절단술
XX치수절단술
XX치수절제술
XX치수절제술
11치열수술
XX치핵 결찰술
XX치핵경화요법
11치핵근본수술
XX치핵소작술
11치핵절제술
24카사이 수술
X1칼드웰-룩 수술(caldwell-luc)
12케모포트삽입술(백혈병 이외의 암)
23케모포트삽입술(백혈병인 경우)
XX케모포트제거술(항암포트제거)
22코트수술
XX콘딜로마절제술(곤지름)
XX타석절개술
XX타액선 종양적출술
XX타액선관 성형수술
XX타액선관이동술
XX타액점액류 적출술
23타인, 인공피부에 의한 식피술
11탈장 근본수술
11탈항 근본수술
35판막 성형술
11퍼거슨(폐쇄성)치핵절제술
22페르테스씨병의 골이식
12페미스터수술
11편도선절제술
24폐 박피술
24폐 봉합술
24폐 쐐기절제술
24폐 전적제술
24폐구역 절제술
24폐낭포(기포)절개 및절제봉합술
24폐농양 절개배농술(폐절개동반)
35폐동맥 교액술
35폐동맥 색전(혈전)제거술
35폐동맥 성형술
35폐동맥색전(혈전)제거술
11폐쇄 탈장수술
35폐쇄식 승모판교련절개술
22폐쇄신경 절제술
11폐쇄적 우각 녹내장의 레이져 홍채절제술(녹내장시)
12폐쇄적 흉관삽입술
12폐쇄적정복술&내고정술(사지골)
24폐쇄항문(쇄항) 근치수술
24폐엽 절제술
25폐이식수술
24폐종양(종류)적출술
24폐첨 박리술
XX포경수술
XX포경수술
11포상기태 제거술
12표층각막 이식술
23풍극수술
XX피부 레이저요법
XX피부 박피술
11피부 양성종양 (냉동응고)적출술
XX피부 절개술
11피부양성종양 적출술
23피부판 이식술
23피부판성형술(피부이식)
23피하유방절제술(유방절제)
12하대정맥 필터설치술
XX하마종 적출술
11하모닉 치핵절제술
22하복부 신경총절제술
11하비갑개 절제술 및 점막절제술
12하사근 절제술
22하악골 관혈수술
22하악골 이단술
22하악골 절제술,봉합술, 접합술
XX하악골 탈구 도수정복술
XX하지정맥류 경화요법
12하퇴골 관혈적 골절수술
24하트만 수술
24하트만 수술
23할로베스트외 고정
11항문 성형술
XX항문 양성종양절제술
XX항문 용종절제술
XX항문농양절개배농술
XX항문용종절제술
XX항문콘딜로마절제술
XX항문협착성형술
22해표상지증
XX현미경하 각막발사술
XX혈관 노출술
23혈관 문합술
23혈관 성형술
11혈관종 적출술
11혈관종 적출술
23혈전 제거술
23혈종 관류제거술
23협골골절 관혈적 정복술
23홍채 원거 절제술(녹내장)
12홍채 유착박리술
12홍채 이단술
12홍채 절제술
12홍채 종양절제술
12홍채절제술(녹내장 외)
23홍채절제술(녹내장)
11화이트헤드 치핵근본수술
35활로씨 사징증 수술
12활액막제거술
11활차이완술
23황색인대골화증수술
24회맹부절제술
11회음 탈장수술
XX회음절개 및 봉합술
24회장루 복원술
24회장루 조성술
24회장의 맥켈게실절제술
12횡격막 봉합술
12횡격막 성형술
22횡격신경마비술
11횡경막 탈장수술
23횡경막하 농양 수술
23후두 부분절제술
23후두 전절제술
23후두 종양적출술
23후두점막하 이물삽입술
23후두협착증 전방개대술
23후두협착증T-튜브삽입술
23후두협착증전벽성형수술
23후두횡경막 절제술
11후발성 백내장 레이져수술
21후발성 백내장 수술
23후방요추융합술
23후종인대골화부절제술
23훙강내 혈종 제거술
22흉강경하 교감신경절 소작술
22흉강경하 교감신경절 절제술
34흉강내 식도위문합술
23흉강내 응혈괴 제거술
23흉강내 출혈 배제술
23흉골 골수염 수술
12흉골절제술
23흉곽근육충전술
23흉곽성형술
12흉관삽입술
24흉막(늑막) 박리술
24흉막(늑막) 유착술
23흉벽냉농양 근본수술
23흉벽루 근본수술
33흉선절제술
XX흡착식 혈관정화법
  `;
  function parseOps(text){
    const out=[], seen=new Set();
    const lines = text.split(/\r?\n/).map(s=>s.trim()).filter(Boolean).filter(s=>!s.startsWith('//'));
    const re = /^\s*([0-9X])([0-9X])\s*(?:\(([^)]+)\))?\s*(.+?)\s*$/;
    for(const line of lines){
      const m=line.match(re); if(!m) continue;
      const aTier=(m[1]>='1'&&m[1]<='3')?Number(m[1]):null;
      const bTier=(m[2]>='1'&&m[2]<='5')?Number(m[2]):null;
      const hint=m[3]||''; const name=m[4];
      const id=`${name}||${hint}||${aTier??'NA'}||${bTier??'NA'}`;
      if(seen.has(id)) continue; seen.add(id);
      out.push({name, aTier, bTier, kcdHint:hint});
    }
    return out;
  }
  const OP_DB = parseOps(RAW_DATA);

  /* ===== 렌더 ===== */
  const renderTier = (el, tier) => {
    el.innerHTML = (tier!=null)
      ? `<div class="big">${tier}종</div>`
      : `<span class="muted">해당 없음</span>`;
  };
  function renderList(target, pairs){
    if(!pairs.length){ target.innerHTML = `<li class="muted">관련 항목 없음</li>`; return; }
    target.innerHTML = pairs.map(p=> `<li><b>${p.code}</b> — ${p.name||''}${p.extra?` <span class="muted">(${p.extra})</span>`:""}</li>`).join('');
  }

  /* ===== 이름 정규화/검색 ===== */
  function normalizeQueryName(s){
    let t = nz(s);
    t = t.replace(/[()\[\]]/g,' ');
    t = t.replace(/내시경|복강경|수술|절제술|제거술|지혈술|봉합술|성형술|고주파|레이저|치환술|조성술|문합술|이식술/g,' ');
    t = t.replace(/대장/g,'결장'); // 용어 정규화
    t = t.replace(/맹장/g,'충수');
    return t.replace(/\s+/g,' ').trim();
  }
  function findKCDByName(keyword, limit=20){
    if(!READY_K) return [];
    const norm = normalizeQueryName(keyword);
    const tokens = norm.split(/\s+/).filter(Boolean);
    const out=[];
    outer: for(const r of KCD_NAME_IDX){
      const key = nkey(r.name);
      for(const tt of tokens){ if(!key.includes(nkey(tt))) continue outer; }
      out.push({code:r.code, name:r.name});
      if(out.length>=limit) break;
    }
    if(!out.length){
      for(const r of KCD_NAME_IDX){
        if(nkey(r.name).includes(nkey(norm))){
          out.push({code:r.code, name:r.name});
          if(out.length>=limit) break;
        }
      }
    }
    return out;
  }
  function findMByName(keyword, limit=20){
    if(!READY_M) return [];
    const norm = normalizeQueryName(keyword);
    const tokens = norm.split(/\s+/).filter(Boolean);
    const out=[];
    outer: for(const r of M_NAME_IDX){
      const key = nkey(r.name);
      for(const tt of tokens){ if(!key.includes(nkey(tt))) continue outer; }
      const rec = M_BY_CODE.get(r.code);
      out.push({code:r.code, name:r.name, extra:[...rec.cTopos].join(', ')});
      if(out.length>=limit) break;
    }
    if(!out.length){
      for(const r of M_NAME_IDX){
        if(nkey(r.name).includes(nkey(norm))){
          const rec = M_BY_CODE.get(r.code);
          out.push({code:r.code, name:r.name, extra:[...rec.cTopos].join(', ')});
          if(out.length>=limit) break;
        }
      }
    }
    return out;
  }

  /* ===== 표시 로직 ===== */
  function showByOp(opName){
    const rec = OP_DB.find(x=>x.name===opName) || OP_DB.find(x=> nkey(x.name)===nkey(opName) );
    renderTier(elRA, rec?.aTier ?? null);
    renderTier(elRB, rec?.bTier ?? null);

    // KCD
    let kcdPairs = [];
    if(rec?.kcdHint && isKcd(rec.kcdHint)){
      const code = normalizeCode(rec.kcdHint);
      const name = KCD_BY_CODE.get(code) || KCD_BY_CODE.get(code.replace('.',''));
      if(name) kcdPairs.push({code, name});
    }
    kcdPairs = kcdPairs.concat(findKCDByName(rec?.name || opName, 20)
      .filter(p=>!kcdPairs.some(x=>x.code===p.code)));
    renderList(elK, kcdPairs);

    // ICD-O
    const icdoPairs = findMByName(rec?.name || opName, 20);
    renderList(elM, icdoPairs);
  }

  function showByKCD(codeOrName){
    renderTier(elRA,null); renderTier(elRB,null);
    const codeNorm = normalizeCode(codeOrName);
    const kcdName = READY_K ? (KCD_BY_CODE.get(codeNorm) || KCD_BY_CODE.get(codeNorm.replace('.',''))) : null;
    if(kcdName){
      renderList(elK, [{code:codeNorm, name:kcdName}]);
      // 같은 명칭으로 형태코드 탐색
      renderList(elM, findMByName(kcdName, 20));
      return;
    }
    // 명칭 검색
    renderList(elK, findKCDByName(codeOrName, 20));
    renderList(elM, findMByName(codeOrName, 20));
  }

  function showByTopography(cCode){
    // C코드 → KCD명 / 연결된 형태코드(M)
    const topo = normTopo(cCode);
    const kName = topo ? (KCD_BY_CODE.get(topo) || KCD_BY_CODE.get(topo.replace('.',''))) : null;
    renderList(elK, kName ? [{code:topo, name:kName}] : []);
    if(READY_M && topo && TOPO_TO_M.has(topo)){
      const set = TOPO_TO_M.get(topo);
      const arr = [...set].slice(0,100).map(m=>{
        const rec = M_BY_CODE.get(m);
        return {code:m, name:rec?.name||'', extra:[...rec.cTopos].join(', ')};
      });
      renderList(elM, arr);
    }else{
      renderList(elM, []);
    }
    renderTier(elRA,null); renderTier(elRB,null);
  }

  function showByICDO(mCodeOrName){
    renderTier(elRA,null); renderTier(elRB,null);
    const c = normalizeCode(mCodeOrName);
    const rec = READY_M ? M_BY_CODE.get(c) : null;
    if(rec){
      renderList(elM, [{code:c, name:rec.name, extra:[...rec.cTopos].join(', ')}]);
      // 연결된 C코드로 KCD 명칭도 함께
      let kPairs=[];
      for(const t of rec.cTopos){
        const nm = KCD_BY_CODE.get(t) || KCD_BY_CODE.get(t.replace('.',''));
        if(nm) kPairs.push({code:t, name:nm});
      }
      if(!kPairs.length) kPairs = findKCDByName(rec.name, 10);
      renderList(elK, kPairs);
      return;
    }
    // 명칭으로 형태코드 검색
    renderList(elM, findMByName(mCodeOrName, 20));
    renderList(elK, findKCDByName(mCodeOrName, 20));
  }

/* ===== 자동완성 (부분 코드 Prefix 지원) ===== */
function suggest(q){
  const raw = (q ?? "").trim();
  const k = nkey(raw);
  if(!k || !(READY_K || READY_M)) return [];

  const out = [];
  const seen = new Set();
  const push = (item)=>{
    const id = item.type + '|' + (item.code || item.label);
    if(seen.has(id)) return true;
    out.push(item); seen.add(id);
    return out.length < 30;
  };

  const norm = normalizeCode(raw);

  // 1) 코드 완전 매치 우선
  if(READY_K && isKcd(raw)){
    const code = norm;
    const name = KCD_BY_CODE.get(code) || KCD_BY_CODE.get(code.replace('.',''));
    if(name) push({type:'kcd_code', label:name, code});
  }
  if(READY_K && isTopography(raw)){
    const code = normTopo(raw);
    const name = KCD_BY_CODE.get(code) || KCD_BY_CODE.get(code.replace('.',''));
    if(name) push({type:'topo_code', label:name, code});
  }
  if(READY_M && isIcdo(raw)){
    const rec = M_BY_CODE.get(norm);
    if(rec) push({type:'icdo_code', label:rec.name, code:norm});
  }

  // 2) 코드 부분(Prefix) 매치
  if(READY_K && /^[A-TV-Z]\d{0,2}(\.\d?)?$/i.test(raw)){
    const pref = norm.replace('.','');
    for(const [code,name] of KCD_BY_CODE){
      const key = code.replace('.','');
      if(key.startsWith(pref)){
        const type = code.startsWith('C') ? 'topo_code' : 'kcd_code';
        if(!push({type, label:name, code})) break;
      }
    }
  }
  if(READY_M && /^M\d{0,4}(\/[0-9]?)?$/i.test(raw)){
    const pref = norm;
    for(const [code,rec] of M_BY_CODE){
      if(code.startsWith(pref)){
        if(!push({type:'icdo_code', label:rec.name, code})) break;
      }
    }
  }

  // 3) 수술명/한글명 부분 포함
  for(const r of OP_DB){
    if(nkey(r.name).includes(k)){ if(!push({type:'op', label:r.name})) break; }
  }
  if(READY_K){
    for(const r of KCD_NAME_IDX){
      if(nkey(r.name).includes(k)){ if(!push({type:'kcd_name', label:r.name, code:r.code})) break; }
    }
  }
  if(READY_M){
    for(const r of M_NAME_IDX){
      if(nkey(r.name).includes(k)){ if(!push({type:'icdo_name', label:r.name, code:r.code})) break; }
    }
  }
  return out;
}
  function openAC(items){
    if(!items.length){ elAC.classList.remove('open'); elACList.innerHTML=''; return; }
    elACList.innerHTML = items.map((it,i)=>{
      let tag='수술';
      if(it.type.startsWith('kcd')) tag='KCD';
      else if(it.type.startsWith('icdo')) tag='ICD-O';
      else if(it.type.startsWith('topo')) tag='C코드';
      return `<li data-i="${i}" data-t="${it.type}">
        <span>${it.label}</span>
        ${it.code?`<span class="code">${it.code}</span>`:`<span class="desc">${tag}</span>`}
      </li>`;
    }).join('');
    elAC.classList.add('open');
  }
  const closeAC = ()=> elAC.classList.remove('open');

  /* ===== 검색 ===== */
  function doSearch(){
    const q = elQ.value.trim(); if(!q || !(READY_K||READY_M)) return;
    if(isIcdo(q)) return showByICDO(q);
    if(isTopography(q)) return showByTopography(q);
    if(isKcd(q)) return showByKCD(q);
    // 수술명 우선
    const op = OP_DB.find(r=> nkey(r.name).includes(nkey(q)));
    if(op) return showByOp(op.name);
    // 명칭 기반
    showByKCD(q);
  }

  /* ===== 이벤트 ===== */
  elBtn.addEventListener('click', doSearch);
  // Enter로 항상 검색 (한글 조합 중에는 제외)
let isComposing = false;
elQ.addEventListener('compositionstart', ()=> isComposing = true);
elQ.addEventListener('compositionend',  ()=> { isComposing = false; });

elQ.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter'){
    if(isComposing) return;      // 한글 조합 중이면 무시
    e.preventDefault();          // 폼 기본동작/캐럿 줄바꿈 방지
    closeAC();                   // 자동완성 닫기
    doSearch();                  // 즉시 검색
  }
});
  elQ.addEventListener('input', ()=> (READY_K||READY_M) && openAC(suggest(elQ.value)));
  elQ.addEventListener('focus', ()=> (READY_K||READY_M) && openAC(suggest(elQ.value)));
  elQ.addEventListener('blur', ()=> setTimeout(closeAC,120));
  elACList.addEventListener('click', (e)=>{
    const li = e.target.closest('li'); if(!li) return;
    const idx = Number(li.dataset.i);
    const items = suggest(elQ.value);
    const it = items[idx]; if(!it) return;
    if(it.type==='op'){ elQ.value = it.label; showByOp(it.label); }
    else if(it.type==='kcd_code'){ elQ.value = it.code; showByKCD(it.code); }
    else if(it.type==='kcd_name'){ elQ.value = it.label; showByKCD(it.label); }
    else if(it.type==='topo_code'){ elQ.value = it.code; showByTopography(it.code); }
    else if(it.type==='icdo_code'){ elQ.value = it.code; showByICDO(it.code); }
    else if(it.type==='icdo_name'){ elQ.value = it.label; showByICDO(it.label); }
    closeAC();
  });

  /* ===== 부팅 ===== */
  (async()=>{
    await new Promise(r=>{
      if(window.XLSX) return r();
      const t=setInterval(()=>{ if(window.XLSX){ clearInterval(t); r(); } },50);
    });
    let msgs=[];
    const okK = await loadKCD();  msgs.push(okK?`KCD ${KCD_BY_CODE.size}건`:`KCD 실패`);
    const okM = await loadICDO(); msgs.push(okM?`ICD-O ${M_BY_CODE.size}건`:`ICD-O 실패`);
    READY = okK || okM;
    elStatus.textContent = READY ? `로드 완료 · ${msgs.join(' / ')}` : `로드 실패`;
    elQ.disabled = !READY; elBtn.disabled = !READY;
  })();
  </script>
</body>
</html>
