<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>간호간병 통합서비스 병원 찾기 - 청구닷컴</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;700;800;900&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body {
            font-family: 'Pretendard', sans-serif;
        }
        
        /* 애니메이션 */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .card-fade-in {
            animation: fadeIn 0.3s ease-out;
        }
        
        /* 스크롤바 커스터마이징 */
        ::-webkit-scrollbar {
            width: 10px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 5px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-blue-50 via-indigo-50 to-purple-50">
    <!-- 헤더 -->
    <div class="bg-white shadow-lg sticky top-0 z-40 border-b-4 border-blue-500">
        <div class="max-w-7xl mx-auto px-4 py-5">
            <div class="flex items-center justify-between mb-4 flex-wrap gap-3">
                <div class="flex items-center gap-3">
                    <div class="bg-gradient-to-br from-blue-500 to-indigo-600 p-3 rounded-xl shadow-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                        </svg>
                    </div>
                    <div>
                        <h1 class="text-2xl md:text-3xl font-black text-gray-900 bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent">
                            간호간병통합서비스 병원 찾기
                        </h1>
                        <p class="text-sm text-gray-600 font-medium">전국 <span id="totalCount">0</span>개 병원 · 실시간 검색</p>
                    </div>
                </div>
                <button
                    onclick="getMyLocation()"
                    class="flex items-center gap-2 px-5 py-2.5 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 shadow-lg hover:shadow-xl font-bold"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                        <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                    </svg>
                    <span class="hidden sm:inline">내 위치</span>
                </button>
            </div>

            <!-- 검색바 -->
            <div class="flex gap-2">
                <div class="flex-1 relative">
                    <svg xmlns="http://www.w3.org/2000/svg" class="absolute left-4 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                    <input
                        type="text"
                        id="searchInput"
                        placeholder="병원명, 지역, 주소로 검색하세요... (예: 서울, 삼성병원, 강남구)"
                        class="w-full pl-12 pr-4 py-3.5 border-2 border-gray-200 rounded-xl focus:border-blue-500 focus:outline-none transition-all text-base shadow-sm"
                    />
                </div>
                <button
                    id="filterToggle"
                    class="px-5 py-3.5 rounded-xl border-2 transition-all flex items-center gap-2 font-bold shadow-sm bg-white border-gray-200 hover:border-blue-500 text-gray-700"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
                    </svg>
                    <span class="hidden sm:inline">필터</span>
                </button>
            </div>

            <!-- 필터 패널 -->
            <div id="filterPanel" class="hidden mt-4 p-5 bg-white rounded-xl border-2 border-blue-100 shadow-lg">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">🏥 병원 종별</label>
                        <select id="typeFilter" class="w-full px-4 py-2.5 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-all font-medium">
                            <option value="전체">🔍 전체 보기</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">📍 지역</label>
                        <select id="regionFilter" class="w-full px-4 py-2.5 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-all font-medium">
                            <option value="전체">🔍 전체 지역</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-bold text-gray-700 mb-2">📊 정렬</label>
                        <select id="sortFilter" class="w-full px-4 py-2.5 border-2 border-gray-200 rounded-lg focus:border-blue-500 focus:outline-none transition-all font-medium">
                            <option value="name">이름순 (가나다)</option>
                            <option value="beds">병상수 많은 순</option>
                            <option value="wards">병동수 많은 순</option>
                        </select>
                    </div>
                </div>
                
                <!-- 필터 리셋 버튼 -->
                <button
                    id="resetFilters"
                    class="hidden text-sm text-blue-600 hover:text-blue-700 font-bold flex items-center gap-1 hover:gap-2 transition-all"
                >
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                    필터 초기화
                </button>
            </div>
        </div>
    </div>

    <!-- 결과 영역 -->
    <div class="max-w-7xl mx-auto px-4 py-6">
        <!-- 검색 결과 요약 -->
        <div class="mb-6 flex items-center justify-between bg-white rounded-xl p-4 shadow-md border border-gray-100">
            <div class="flex items-center gap-3">
                <div class="bg-blue-100 p-2 rounded-lg">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                    </svg>
                </div>
                <div>
                    <p class="text-gray-700 font-medium">
                        검색 결과: <span id="resultCount" class="text-blue-600 text-xl font-black">0</span>개 병원
                    </p>
                    <p id="filterStatus" class="text-xs text-gray-500 mt-1 hidden"></p>
                </div>
            </div>
            <div id="locationStatus" class="hidden flex items-center gap-2 text-sm text-green-700 bg-green-50 px-4 py-2 rounded-lg border-2 border-green-200 font-bold">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                </svg>
                현재 위치 기준
            </div>
        </div>

        <!-- 병원 카드 그리드 -->
        <div id="hospitalGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-5"></div>

        <!-- 검색 결과 없음 -->
        <div id="emptyState" class="hidden text-center py-20 bg-white rounded-2xl shadow-md">
            <div class="bg-gradient-to-br from-blue-100 to-indigo-100 w-24 h-24 rounded-full flex items-center justify-center mx-auto mb-6 shadow-lg">
                <svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>
            <h3 class="text-2xl font-black text-gray-900 mb-3">검색 결과가 없습니다</h3>
            <p class="text-gray-600 mb-6 text-lg">다른 검색어나 필터를 시도해보세요.</p>
            <button
                onclick="resetAllFilters()"
                class="px-8 py-3 bg-gradient-to-r from-blue-500 to-indigo-600 text-white rounded-xl hover:from-blue-600 hover:to-indigo-700 transition-all duration-300 shadow-lg hover:shadow-xl font-bold"
            >
                필터 초기화
            </button>
        </div>
    </div>

    <!-- 푸터 -->
    <div class="bg-white border-t-4 border-blue-500 mt-16">
        <div class="max-w-7xl mx-auto px-4 py-8">
            <!-- 서비스 설명 -->
            <div class="mb-6 p-6 bg-gradient-to-br from-blue-50 to-indigo-50 rounded-2xl border-2 border-blue-100 shadow-md">
                <h4 class="font-black text-blue-900 mb-3 flex items-center gap-3 text-lg">
                    <div class="bg-blue-500 p-2 rounded-lg">
                        <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                        </svg>
                    </div>
                    간호간병통합서비스란?
                </h4>
                <p class="text-sm text-blue-900 leading-relaxed mb-3">
                    환자 가족이나 간병인 없이 입원실 병동에 배치된 <strong class="font-black">전담 간호팀이 환자를 직접 돌보는</strong> 새로운 입원 서비스입니다.
                </p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-blue-100">
                        <p class="font-bold text-blue-900 mb-1">👨‍⚕️ 전문 케어</p>
                        <p class="text-xs text-gray-700">간호사와 간호조무사가 팀을 이뤄 24시간 환자를 전문적으로 케어합니다.</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-blue-100">
                        <p class="font-bold text-blue-900 mb-1">💰 비용 절감</p>
                        <p class="text-xs text-gray-700">간병비 부담이 없어 입원 비용을 크게 절감할 수 있습니다.</p>
                    </div>
                    <div class="bg-white p-4 rounded-xl shadow-sm border border-blue-100">
                        <p class="font-bold text-blue-900 mb-1">😊 가족 부담 감소</p>
                        <p class="text-xs text-gray-700">가족이 병원에 상주하지 않아도 되어 일상생활 유지가 가능합니다.</p>
                    </div>
                </div>
            </div>

            <!-- 전화번호 안내 -->
            <div class="mb-6 p-4 bg-amber-50 rounded-xl border-2 border-amber-200">
                <div class="flex items-start gap-3">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                    </svg>
                    <div class="flex-1">
                        <h5 class="font-bold text-amber-900 mb-1">전화번호 정보 안내</h5>
                        <p class="text-xs text-amber-800 leading-relaxed">
                            일부 병원의 전화번호는 공공데이터에서 제공되지 않습니다. 
                            전화번호가 없는 병원은 네이버/구글 검색을 통해 확인하실 수 있습니다.
                        </p>
                    </div>
                </div>
            </div>
            
            <div class="flex flex-col md:flex-row items-center justify-between gap-4 text-sm text-gray-600">
                <p class="font-bold text-gray-800">💙 간호간병통합서비스 병원 찾기</p>
                <div class="text-center md:text-right">
                    <p class="font-medium">데이터 기준일: <strong class="text-blue-600">2025년 6월 30일</strong></p>
                    <p class="text-xs text-gray-500 mt-1">출처: 국민건강보험공단</p>
                </div>
            </div>
            
            <a href="javascript:history.back()" class="inline-block mt-6 px-5 py-2.5 bg-gradient-to-r from-gray-500 to-gray-600 text-white rounded-full hover:from-gray-600 hover:to-gray-700 transition-all font-bold shadow-lg">뒤로가기</a>
        </div>
    </div>

    <script>
    (function() {
        // 병원 데이터 (전체 778개)
        const hospitalData = [{"id": "1", "type": "종합병원", "name": "삼육서울병원", "ward_type": "일반", "region": "서울 동대문구", "address": "서울특별시 동대문구 망우로 82 (휘경동)", "ward_count": "6", "bed_count": "232", "phone": "02-2210-3000"}, {"id": "2", "type": "종합병원", "name": "부천세종병원", "ward_type": "일반", "region": "경기 부천시", "address": "경기도 부천시 소사구 호현로489번길 28 (소사본동  세종병원)", "ward_count": "7", "bed_count": "273", "phone": ""}, {"id": "3", "type": "종합병원", "name": "의료법인목포구암의료재단 목포중앙병원", "ward_type": "일반", "region": "전남 목포시", "address": "전라남도 목포시 영산로 623 (석현동)", "ward_count": "1", "bed_count": "30", "phone": ""}, {"id": "4", "type": "종합병원", "name": "의료법인 온그룹의료재단 온종합병원", "ward_type": "일반", "region": "부산 부산진구", "address": "부산광역시 부산진구 가야대로 719  767 721 본관 지하3~11층 전부 12층 일부 13~14층 전부 15층 일부 신관 1층  9층 일부 (당감동)", "ward_count": "7", "bed_count": "382", "phone": ""}, {"id": "5", "type": "종합병원", "name": "의료법인 토마스의료재단 윌스기념병원", "ward_type": "일반", "region": "경기 수원시", "address": "경기도 수원시 팔달구 경수대로 437 (인계동)", "ward_count": "5", "bed_count": "242", "phone": ""}, {"id": "6", "type": "병원", "name": "목동힘찬병원", "ward_type": "일반", "region": "서울 양천구", "address": "서울특별시 양천구 신목로 120 (목동  힘찬병원)", "ward_count": "4", "bed_count": "199", "phone": ""}, {"id": "7", "type": "병원", "name": "의료법인 토마스의료재단 안양윌스기념병원", "ward_type": "일반", "region": "경기 안양시", "address": "경기도 안양시 동안구 경수대로 560 안양남부새마을금고 2-8층 (호계동)", "ward_count": "2", "bed_count": "100", "phone": ""}, {"id": "8", "type": "상급종합", "name": "인하대학교의과대학부속병원", "ward_type": "일반", "region": "인천 중구", "address": "인천광역시 중구 인항로 27-0 인하대학병원", "ward_count": "13", "bed_count": "514", "phone": "032-890-2114"}, {"id": "9", "type": "종합병원", "name": "대아의료재단한도병원", "ward_type": "일반", "region": "경기 안산시", "address": "경기도 안산시 단원구 선부광장로 103 (선부동)", "ward_count": "4", "bed_count": "215", "phone": ""}, {"id": "10", "type": "병원", "name": "의)상원의료재단부평힘찬병원", "ward_type": "일반", "region": "인천 부평구", "address": "인천광역시 부평구 장제로 78 (부평동)", "ward_count": "2", "bed_count": "110", "phone": ""}, {"id": "11", "type": "병원", "name": "순천하나병원", "ward_type": "일반", "region": "전남 순천시", "address": "전라남도 순천시 팔마로 215 (덕암동)", "ward_count": "2", "bed_count": "123", "phone": ""}, {"id": "12", "type": "종합병원", "name": "의료법인인봉의료재단뉴고려병원", "ward_type": "일반", "region": "경기 김포시", "address": "경기도 김포시 김포한강3로 283 뉴고려병원 (장기동)", "ward_count": "5", "bed_count": "222", "phone": ""}, {"id": "13", "type": "병원", "name": "한가람병원", "ward_type": "일반", "region": "대구 동구", "address": "대구광역시 동구 해동로 101 (지저동)", "ward_count": "1", "bed_count": "34", "phone": ""}, {"id": "14", "type": "종합병원", "name": "해피뷰병원", "ward_type": "일반", "region": "광주 북구", "address": "광주광역시 북구 경열로 216-0 해피뷰병원", "ward_count": "3", "bed_count": "127", "phone": ""}, {"id": "15", "type": "종합병원", "name": "의료법인백송의료재단 굿모닝병원", "ward_type": "일반", "region": "경기 평택시", "address": "경기도 평택시 중앙로 338 (합정동)", "ward_count": "3", "bed_count": "141", "phone": ""}, {"id": "16", "type": "병원", "name": "서울나우병원", "ward_type": "일반", "region": "경기 성남시", "address": "경기도 성남시 분당구 분당로 43 나우빌딩 5~11층 12일부층 (서현동)", "ward_count": "2", "bed_count": "64", "phone": ""}, {"id": "17", "type": "종합병원", "name": "대자인병원", "ward_type": "일반", "region": "전북 전주시", "address": "전북특별자치도 전주시 덕진구 견훤로 390 (우아동3가)", "ward_count": "8", "bed_count": "363", "phone": ""}, {"id": "18", "type": "병원", "name": "연세척병원", "ward_type": "일반", "region": "부산 부산진구", "address": "부산광역시 부산진구 가야대로 715 1층 일부  2~4층 전부 (당감동)", "ward_count": "1", "bed_count": "30", "phone": ""}, {"id": "19", "type": "병원", "name": "서울송도병원", "ward_type": "일반", "region": "서울 중구", "address": "서울특별시 중구 다산로 78 송도병원 (신당동)", "ward_count": "3", "bed_count": "114", "phone": ""}, {"id": "20", "type": "병원", "name": "참조은병원", "ward_type": "일반", "region": "대구 달서구", "address": "대구광역시 달서구 월배로 404 (송현동)", "ward_count": "2", "bed_count": "67", "phone": ""}, {"id": "21", "type": "종합병원", "name": "서광병원", "ward_type": "일반", "region": "광주 서구", "address": "광주광역시 서구 금화로59번길 6 (금호동)", "ward_count": "1", "bed_count": "62", "phone": ""}, {"id": "22", "type": "종합병원", "name": "의료법인한성재단포항세명기독병원", "ward_type": "일반", "region": "경북 포항시", "address": "경상북도 포항시 남구 포스코대로 351 (대도동)", "ward_count": "11", "bed_count": "343", "phone": ""}, {"id": "23", "type": "종합병원", "name": "부민병원", "ward_type": "일반", "region": "서울 강서구", "address": "서울특별시 강서구 공항대로 389 부민병원 (등촌동)", "ward_count": "5", "bed_count": "279", "phone": ""}, {"id": "24", "type": "병원", "name": "새천년병원", "ward_type": "일반", "region": "경북 경주시", "address": "경상북도 경주시 화랑로 129 (성동동)", "ward_count": "2", "bed_count": "40", "phone": ""}, {"id": "25", "type": "종합병원", "name": "현대유비스병원", "ward_type": "일반", "region": "인천 미추홀구", "address": "인천광역시 미추홀구 독배로 503-0 현대유비스병원", "ward_count": "7", "bed_count": "285", "phone": ""}, {"id": "26", "type": "종합병원", "name": "의료법인 석경의료재단 센트럴병원", "ward_type": "일반", "region": "경기 시흥시", "address": "경기도 시흥시 공단1대로 237 (정왕동  센트럴 병원)", "ward_count": "3", "bed_count": "180", "phone": ""}, {"id": "27", "type": "병원", "name": "동탄시티병원", "ward_type": "일반", "region": "경기 화성시", "address": "경기도 화성시 동탄지성로 113 (능동)", "ward_count": "2", "bed_count": "90", "phone": ""}, {"id": "28", "type": "병원", "name": "하나이비인후과병원", "ward_type": "일반", "region": "서울 강남구", "address": "서울특별시 강남구 역삼로 245 지하2층일부 1층일부 2~7층 (역삼동)", "ward_count": "1", "bed_count": "33", "phone": ""}];
        
        let hospitals = hospitalData;
        let filteredHospitals = hospitalData;
        let searchQuery = '';
        let selectedType = '전체';
        let selectedRegion = '전체';
        let sortBy = 'name';
        let userLocation = null;

        // DOM 요소
        const searchInput = document.getElementById('searchInput');
        const typeFilter = document.getElementById('typeFilter');
        const regionFilter = document.getElementById('regionFilter');
        const sortFilter = document.getElementById('sortFilter');
        const filterToggle = document.getElementById('filterToggle');
        const filterPanel = document.getElementById('filterPanel');
        const hospitalGrid = document.getElementById('hospitalGrid');
        const emptyState = document.getElementById('emptyState');
        const resultCount = document.getElementById('resultCount');
        const totalCount = document.getElementById('totalCount');
        const resetBtn = document.getElementById('resetFilters');
        const filterStatus = document.getElementById('filterStatus');

        // 초기화
        function init() {
            totalCount.textContent = hospitals.length;
            populateFilters();
            filterHospitals();
            attachEventListeners();
        }

        // 필터 옵션 채우기
        function populateFilters() {
            // 병원 종별
            const types = ['전체', ...new Set(hospitals.map(h => h.type))];
            typeFilter.innerHTML = types.map(t => 
                `<option value="${t}">${t === '전체' ? '🔍 전체 보기' : t}</option>`
            ).join('');

            // 지역
            const regions = ['전체', ...new Set(hospitals.map(h => h.region.split(' ')[0]))].sort((a, b) => {
                if (a === '전체') return -1;
                if (b === '전체') return 1;
                return a.localeCompare(b, 'ko');
            });
            regionFilter.innerHTML = regions.map(r => 
                `<option value="${r}">${r === '전체' ? '🔍 전체 지역' : r}</option>`
            ).join('');
        }

        // 이벤트 리스너
        function attachEventListeners() {
            searchInput.addEventListener('input', (e) => {
                searchQuery = e.target.value;
                filterHospitals();
            });

            typeFilter.addEventListener('change', (e) => {
                selectedType = e.target.value;
                filterHospitals();
            });

            regionFilter.addEventListener('change', (e) => {
                selectedRegion = e.target.value;
                filterHospitals();
            });

            sortFilter.addEventListener('change', (e) => {
                sortBy = e.target.value;
                filterHospitals();
            });

            filterToggle.addEventListener('click', () => {
                const isHidden = filterPanel.classList.contains('hidden');
                filterPanel.classList.toggle('hidden');
                
                if (isHidden) {
                    filterToggle.classList.remove('bg-white', 'border-gray-200', 'text-gray-700');
                    filterToggle.classList.add('bg-gradient-to-r', 'from-blue-500', 'to-indigo-600', 'text-white', 'border-blue-500', 'shadow-lg');
                } else {
                    filterToggle.classList.add('bg-white', 'border-gray-200', 'text-gray-700');
                    filterToggle.classList.remove('bg-gradient-to-r', 'from-blue-500', 'to-indigo-600', 'text-white', 'border-blue-500', 'shadow-lg');
                }
            });

            resetBtn.addEventListener('click', resetAllFilters);
        }

        // 필터링 및 렌더링
        function filterHospitals() {
            let result = [...hospitals];

            // 검색어 필터
            if (searchQuery) {
                const query = searchQuery.toLowerCase();
                result = result.filter(h => 
                    h.name.toLowerCase().includes(query) ||
                    h.address.toLowerCase().includes(query) ||
                    h.region.includes(searchQuery)
                );
            }

            // 종별 필터
            if (selectedType !== '전체') {
                result = result.filter(h => h.type === selectedType);
            }

            // 지역 필터
            if (selectedRegion !== '전체') {
                result = result.filter(h => h.region.startsWith(selectedRegion));
            }

            // 정렬
            if (sortBy === 'beds') {
                result.sort((a, b) => parseInt(b.bed_count) - parseInt(a.bed_count));
            } else if (sortBy === 'name') {
                result.sort((a, b) => a.name.localeCompare(b.name, 'ko'));
            } else if (sortBy === 'wards') {
                result.sort((a, b) => parseInt(b.ward_count) - parseInt(a.ward_count));
            }

            filteredHospitals = result;
            renderHospitals();
            updateFilterStatus();
        }

        // 병원 카드 렌더링
        function renderHospitals() {
            resultCount.textContent = filteredHospitals.length;

            if (filteredHospitals.length === 0) {
                hospitalGrid.innerHTML = '';
                hospitalGrid.classList.add('hidden');
                emptyState.classList.remove('hidden');
                return;
            }

            hospitalGrid.classList.remove('hidden');
            emptyState.classList.add('hidden');

            hospitalGrid.innerHTML = filteredHospitals.map(hospital => `
                <div class="bg-white rounded-2xl shadow-md hover:shadow-2xl transition-all duration-300 overflow-hidden border-2 border-gray-100 hover:border-blue-300 transform hover:-translate-y-1 card-fade-in">
                    <!-- 카드 헤더 -->
                    <div class="bg-gradient-to-r from-blue-500 via-indigo-500 to-purple-500 px-5 py-4">
                        <div class="flex items-start justify-between gap-2">
                            <h3 class="text-white font-bold text-lg leading-tight flex-1">
                                ${hospital.name}
                            </h3>
                            <span class="text-xs px-3 py-1.5 rounded-full border-2 font-bold whitespace-nowrap ${getTypeColor(hospital.type)}">
                                ${hospital.type}
                            </span>
                        </div>
                    </div>

                    <!-- 카드 본문 -->
                    <div class="p-5 space-y-4">
                        <!-- 위치 정보 -->
                        <div class="flex items-start gap-3 text-sm">
                            <div class="bg-blue-50 p-2 rounded-lg">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                            </div>
                            <div class="flex-1">
                                <p class="font-bold text-gray-900 mb-1">${hospital.region}</p>
                                <p class="text-gray-600 text-xs leading-relaxed">${hospital.address}</p>
                            </div>
                        </div>

                        <!-- 전화번호 -->
                        ${hospital.phone ? `
                            <div class="flex items-center gap-3 text-sm bg-green-50 px-3 py-2.5 rounded-lg border border-green-200">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                                </svg>
                                <a href="tel:${hospital.phone}" class="font-bold text-green-900 hover:text-green-700">
                                    ${hospital.phone}
                                </a>
                            </div>
                        ` : `
                            <div class="flex items-center gap-3 text-sm bg-gray-50 px-3 py-2.5 rounded-lg border border-gray-200">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z" />
                                </svg>
                                <span class="text-gray-500 text-xs">전화번호 정보 없음</span>
                            </div>
                        `}

                        <!-- 통계 정보 -->
                        <div class="flex gap-4 pt-3 border-t-2 border-gray-100">
                            <div class="flex items-center gap-2 flex-1">
                                <div class="bg-blue-50 p-2 rounded-lg">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-gray-500 font-medium">병동</p>
                                    <p class="text-lg font-black text-gray-900">${hospital.ward_count}<span class="text-sm font-medium text-gray-500">개</span></p>
                                </div>
                            </div>
                            <div class="flex items-center gap-2 flex-1">
                                <div class="bg-indigo-50 p-2 rounded-lg">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-indigo-600" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                        <path stroke-linecap="round" stroke-linejoin="round" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" />
                                    </svg>
                                </div>
                                <div>
                                    <p class="text-xs text-gray-500 font-medium">병상</p>
                                    <p class="text-lg font-black text-gray-900">${hospital.bed_count}<span class="text-sm font-medium text-gray-500">개</span></p>
                                </div>
                            </div>
                        </div>

                        <!-- 액션 버튼 -->
                        <div class="flex gap-2 pt-3">
                            <button
                                onclick="handleCall('${hospital.name}', '${hospital.phone}')"
                                class="flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-green-500 to-emerald-500 hover:from-green-600 hover:to-emerald-600 text-white rounded-xl transition-all duration-300 font-bold text-sm shadow-md hover:shadow-lg"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z" />
                                </svg>
                                전화하기
                            </button>
                            <button
                                onclick='handleNavigation("${hospital.address.replace(/"/g, '&quot;')}", "${hospital.name.replace(/"/g, '&quot;')}")'
                                class="flex-1 flex items-center justify-center gap-2 px-4 py-3 bg-gradient-to-r from-blue-500 to-indigo-500 hover:from-blue-600 hover:to-indigo-600 text-white rounded-xl transition-all duration-300 font-bold text-sm shadow-md hover:shadow-lg"
                            >
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7" />
                                </svg>
                                길찾기
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        // 필터링
        function filterHospitals() {
            let result = [...hospitals];

            if (searchQuery) {
                const query = searchQuery.toLowerCase();
                result = result.filter(h => 
                    h.name.toLowerCase().includes(query) ||
                    h.address.toLowerCase().includes(query) ||
                    h.region.includes(searchQuery)
                );
            }

            if (selectedType !== '전체') {
                result = result.filter(h => h.type === selectedType);
            }

            if (selectedRegion !== '전체') {
                result = result.filter(h => h.region.startsWith(selectedRegion));
            }

            if (sortBy === 'beds') {
                result.sort((a, b) => parseInt(b.bed_count) - parseInt(a.bed_count));
            } else if (sortBy === 'name') {
                result.sort((a, b) => a.name.localeCompare(b.name, 'ko'));
            } else if (sortBy === 'wards') {
                result.sort((a, b) => parseInt(b.ward_count) - parseInt(a.ward_count));
            }

            filteredHospitals = result;
            renderHospitals();
        }

        // 필터 상태 업데이트
        function updateFilterStatus() {
            const hasFilter = selectedType !== '전체' || selectedRegion !== '전체' || searchQuery;
            
            if (hasFilter) {
                resetBtn.classList.remove('hidden');
                filterStatus.classList.remove('hidden');
                
                const parts = [];
                if (selectedType !== '전체') parts.push(selectedType);
                if (selectedRegion !== '전체') parts.push(selectedRegion);
                if (searchQuery) parts.push(`"${searchQuery}"`);
                
                filterStatus.textContent = '필터링됨: ' + parts.join(' ');
            } else {
                resetBtn.classList.add('hidden');
                filterStatus.classList.add('hidden');
            }
        }

        // 병원 타입 색상
        function getTypeColor(type) {
            switch(type) {
                case '상급종합': return 'bg-purple-100 text-purple-800 border-purple-200';
                case '종합병원': return 'bg-blue-100 text-blue-800 border-blue-200';
                case '병원': return 'bg-green-100 text-green-800 border-green-200';
                default: return 'bg-gray-100 text-gray-800 border-gray-200';
            }
        }

        // 전역 함수들
        window.handleCall = function(name, phone) {
            if (phone) {
                window.location.href = `tel:${phone}`;
            } else {
                alert(`${name}의 전화번호 정보가 없습니다.\n\n네이버/구글 검색을 통해 연락처를 확인해주세요.`);
            }
        };

        window.handleNavigation = function(address, name) {
            const encodedAddress = encodeURIComponent(address);
            const isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
            
            if (isMobile) {
                const kakaoUrl = `kakaomap://search?q=${encodedAddress}`;
                const webUrl = `https://map.kakao.com/link/search/${encodedAddress}`;
                
                window.location.href = kakaoUrl;
                setTimeout(() => {
                    window.open(webUrl, '_blank');
                }, 500);
            } else {
                window.open(`https://map.kakao.com/link/search/${encodedAddress}`, '_blank');
            }
        };

        window.getMyLocation = function() {
            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        userLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        document.getElementById('locationStatus').classList.remove('hidden');
                        alert(`위치를 찾았습니다!\n위도: ${position.coords.latitude.toFixed(6)}\n경도: ${position.coords.longitude.toFixed(6)}\n\n실제 서비스에서는 이 위치 기반으로 가까운 병원을 정렬합니다.`);
                    },
                    (error) => {
                        alert('위치 정보를 가져올 수 없습니다. 브라우저 설정을 확인해주세요.');
                    }
                );
            } else {
                alert('이 브라우저는 위치 서비스를 지원하지 않습니다.');
            }
        };

        window.resetAllFilters = function() {
            searchQuery = '';
            selectedType = '전체';
            selectedRegion = '전체';
            searchInput.value = '';
            typeFilter.value = '전체';
            regionFilter.value = '전체';
            filterHospitals();
        };

        // 초기화 실행
        init();
    })();
    </script>
</body>
</html>

