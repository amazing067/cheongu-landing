<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>전자청약정보 | 청구닷컴</title>
  <meta name="robots" content="noindex,nofollow"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/site.css?v=final-compact-13" />
  <style>
  :root{
    --ink:#0f172a; --muted:#475569; --line:#e2e8f0;
    --brand:#7c3aed; --brand-2:#0ea5e9; --good:#10b981; --bad:#ef4444;
    --bg:#f8fafc; --card:#ffffff;
    --chipbg:#f4f3ff; --chipbd:#e9e5ff; --chipfg:#4c1d95;
  }
  body{background:var(--bg);color:var(--ink);font-family:Pretendard,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}
  .maxw{max-width:78rem;margin:0 auto;padding:16px}
  .hstack{display:flex;flex-wrap:wrap;gap:12px;align-items:center}
  .title{font-size:32px;font-weight:900;letter-spacing:-.01em;margin:0}
  .subtitle{font-size:13px;color:#64748b;margin-top:2px}
  .logo{height:56px;object-fit:contain}

  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 3px 10px rgba(2,6,23,.04)}
  .chip{font-size:11px;border:1px solid var(--line);border-radius:999px;padding:2px 8px;background:#fff}
  .badge{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);border-radius:999px;padding:6px 10px;font-size:12px;background:#fff;white-space:nowrap}
  .badge.ok{border-color:#86efac;background:#ecfdf5;color:#065f46}
  .badge.no{border-color:#fecaca;background:#fef2f2;color:#991b1b}

  .btn{
    display:inline-flex;align-items:center;gap:8px;border-radius:12px;border:1px solid var(--line);background:#fff;
    padding:10px 14px;font-weight:800;text-decoration:none;color:#0f172a;
    transition:transform .15s ease, box-shadow .15s ease, background-color .15s ease, opacity .15s ease;
    box-shadow:0 4px 10px rgba(2,6,23,.06);
  }
  .btn:hover{transform:translateY(-1px);box-shadow:0 8px 18px rgba(2,6,23,.08);background:#f8fafc}
  .btn[disabled], .btn.muted{opacity:.55;cursor:not-allowed}
  .btn svg{width:16px;height:16px}

  .grid{display:grid;gap:16px}
  @media (min-width:1024px){ .grid-2{grid-template-columns:1fr 1fr} } /* 반반 */

  .hero{ border-radius:20px; padding:22px; border:1px solid rgba(124,58,237,.25); }
  .hero .heading{
    font-size:22px; font-weight:900; margin:0 0 12px; text-align:center;
    padding:12px 18px; border-radius:999px; color:#fff; letter-spacing:-.01em;
    background: linear-gradient(135deg,#2563eb,#1d4ed8);
    box-shadow: 0 10px 24px rgba(37,99,235,.25), inset 0 1px 0 rgba(255,255,255,.25);
    border: 1px solid rgba(29,78,216,.6);
  }
  .hero .rows{display:grid; gap:10px}
  @media (min-width:640px){ .hero .rows{grid-template-columns:1fr 1fr} }
  .kv{background:#fff;border:1px solid var(--line);border-radius:12px;padding:10px 12px}
  .kv .k{font-size:12px;color:#475569}
  .kv .v{font-size:16px;font-weight:800;color:#111827;margin-top:1px}
  .hero .actions{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}

  .rowspec{display:grid;gap:10px}
  .spec{
    display:grid;grid-template-columns:minmax(12rem,16rem) 1fr;
    align-items:center;gap:12px;padding:10px 0;border-top:1px dashed rgba(100,116,139,.28)
  }
  .spec:first-child{border-top:0}
  .key{
    display:inline-flex;align-items:center;justify-content:center;
    height:36px;padding:0 12px;border-radius:999px;background:#e6f0ff;border:1px solid #cfe1ff;
    font-weight:700;color:#1e3a8a;white-space:nowrap
  }
  .key.wide{min-width:16rem;}
  .val{color:#0f172a;text-align:center}

  .silson{background:#fff;border:1px solid rgba(100,116,139,.22);border-radius:16px;padding:16px;box-shadow:0 3px 10px rgba(2,6,23,.04)}
  .silson h3{margin:0 0 8px;font-weight:900}
  .list{display:grid;gap:8px}

  .row-kv{display:grid;grid-template-columns:minmax(10.5rem,13.5rem) 1fr;align-items:center;gap:12px;border-top:1px dashed rgba(100,116,139,.26);padding:12px 0}
  .row-kv:first-child{border-top:0}
  .row-kv .k{font-weight:800;color:#334155}
  .row-kv .v{color:#0f172a;line-height:1.55;word-break:keep-all;white-space:normal}

  /* 유병자/노후 요약 */
  .compact-grid{display:grid;gap:14px}
  @media (min-width:980px){ .compact-grid{grid-template-columns:1fr 1fr} }
  .compact-card .title-mini{
    font-weight:900;margin:0 auto 10px; text-align:center; display:inline-block; padding:8px 14px;
    border-radius:999px; background:linear-gradient(135deg,#e0f2fe,#e9d5ff); color:#111827; letter-spacing:-.01em;
  }
  .compact-card{position:relative}
  .kv-mini{display:grid;grid-template-columns:minmax(8rem,10rem) 1fr;gap:10px;align-items:center;border-top:1px dashed #e5e7eb;padding:8px 0}
  .kv-mini:first-child{border-top:0}
  .kv-mini .k{font-weight:700;color:#334155}
  .kv-mini .v{color:#0f172a}

  /* === 4세대 공통사항(좌우 1/2) === */
  #common_2col{
    display:grid;
    gap:12px;
    /* << 고정 1/2: 좁아져도 항상 두 칸 >> */
    grid-template-columns:1fr 1fr;
  }
  .common-box{border-top:1px dashed rgba(100,116,139,.26);padding-top:10px}
  .common-box h5{margin:0 0 6px;font-weight:900}
  .kv-vert .tt{font-size:12px;color:#64748b;margin-bottom:6px}
  .kv-vert .ln{
    display:grid;
    grid-template-columns:min-content auto; /* 칩은 글자만큼, 값은 나머지 */
    gap:8px;
    align-items:center;
    margin:6px 0;
  }
  .kv-vert .tag{
    display:inline-flex;
    align-items:center;
    padding:2px 8px;
    border:1px solid var(--chipbd);
    border-radius:999px;
    font-size:12px;
    color:var(--chipfg);
    background:var(--chipbg);
    white-space:nowrap;
    /* 전역 스타일이 늘리는 것 방지 */
    width:auto !important;
    min-width:0 !important;
    max-width:max-content !important;
    flex:0 0 auto !important;
    box-sizing:border-box;
  }
  .kv-vert .num{font-weight:800}
  .kv-vert small{font-size:11px;color:#64748b}

  /* 4세대 공통사항 - 두 칸 행 */
  .row-2col{display:grid;grid-template-columns:1fr 1fr;gap:12px}
  .row-2col .row-kv{border-top:1px dashed rgba(100,116,139,.26);padding:12px 0}

  /* 제목 버튼들 */
  .quick-nav{margin-left:auto;display:flex;gap:8px;flex-wrap:wrap}
  .quick-nav a{font-size:12px;padding:8px 10px}

  /* 테마 보정 */
  .page-enroll.theme-pro{
    background:
      radial-gradient(28px 28px at 14px 14px, rgba(124,58,237,.08) 1px, transparent 1px),
      linear-gradient(180deg, #eef3ff 0%, #eaf0ff 32%, #f7f9ff 100%) !important;
    background-size:28px 28px, auto !important;
  }
  .page-enroll .section-title{
    text-align:center; font-weight:900; margin:0 0 12px; padding:10px 16px; border-radius:999px;
    color:#0f172a; letter-spacing:-.01em; box-shadow:0 6px 16px rgba(2,6,23,.10);
    background:linear-gradient(135deg,#eef2ff,#e0f2fe);
  }
  .page-enroll .section-title.st-violet{ background:linear-gradient(135deg,#ede9fe,#e0e7ff); }
  .page-enroll .section-title.st-blue  { background:linear-gradient(135deg,#dbeafe,#e0f2fe); }
  .page-enroll .section-title.st-teal  { background:linear-gradient(135deg,#ccfbf1,#d1fae5); }
  .page-enroll.theme-pro .card,
  .page-enroll.theme-pro .silson{
    background:#fff !important; border:1px solid rgba(100,116,139,.26) !important;
    border-radius:18px !important; box-shadow:0 10px 24px rgba(2,6,23,.08) !important;
  }
  .page-enroll.theme-pro .btn{border-color:#cad3ff !important;background:#fff !important;box-shadow:0 5px 14px rgba(2,6,23,.10) !important}
  .page-enroll.theme-pro .btn:hover{ transform:translateY(-2px) !important; box-shadow:0 12px 26px rgba(2,6,23,.16) !important; }
  </style>
</head>

<body class="page-enroll theme-pro">
  <header class="maxw">
    <div class="hstack" style="gap:12px">
      <a href="/" class="btn">← 목록으로</a>
      <span class="chip">전자청약</span>

      <div class="quick-nav">
        <a class="btn" href="#enroll">모바일청약</a>
        <a class="btn" href="#silson_single">단독실손</a>
        <a class="btn" href="#silson_common_card">4세대실손</a>
        <a class="btn" href="#ub_section">유병자실손</a>
        <a class="btn" href="#senior_section">노후실손</a>
      </div>
    </div>

    <div class="hstack" style="gap:14px;margin-top:12px">
      <img id="logo" class="logo" alt="로고" />
      <div>
        <h1 class="title" id="company">전자청약정보</h1>
        <p class="subtitle">회사별 전자청약 핵심 지표를 한눈에 확인하고, 바로 실행하세요.</p>
        <div class="hstack" id="badges" style="gap:8px;margin-top:6px"></div>
      </div>
    </div>
  </header>

  <main class="maxw grid grid-2" style="margin-top:14px">
    <!-- 모바일 전자청약 -->
    <section id="enroll" class="hero" style="grid-column:1/-1">
      <div class="heading">모바일 전자청약 정보</div>
      <div class="rows">
        <div class="kv"><div class="k">모바일 청약 가능 나이</div><div class="v" id="kv_mobile_age">–</div></div>
        <div class="kv"><div class="k">전자청약 사용시간</div><div class="v" id="kv_usage_hours">–</div></div>
        <div class="kv"><div class="k">통화가능시간</div><div class="v" id="kv_call_hours">–</div></div>
        <div class="kv"><div class="k">인콜 모니터링</div><div class="v" id="kv_incall">–</div></div>
      </div>
      <div class="actions">
        <a id="btn_cs_tel" class="btn">고객센터: <span id="txt_cs_tel">–</span></a>
        <a id="btn_fax_tel" class="btn">보험금청구 FAX: <span id="txt_fax_tel">–</span></a>
        <a id="btn_help_tel" class="btn">헬프데스크(전산): <span id="txt_help_tel">–</span></a>
      </div>
    </section>

    <!-- 좌: 상세 -->
    <section class="card">
      <h2 class="section-title st-blue">모바일 전자청약 정보 상세내용</h2>
      <div class="rowspec">
        <div class="spec"><div class="key">사용기한</div><div class="val" id="usage_period">–</div></div>
        <div class="spec"><div class="key">사용시간</div><div class="val" id="usage_hours">–</div></div>
        <div class="spec"><div class="key">통화가능시간</div><div class="val" id="call_hours">–</div></div>
        <div class="spec"><div class="key">모바일 청약 가능 나이</div><div class="val" id="mobile_age">–</div></div>
        <div class="spec"><div class="key">미성년자 모바일 청약</div><div class="val" id="minor">-</div></div>
        <div class="spec">
          <div class="key wide">계약자·피보험자 불일치시 가능여부</div>
          <div class="val" id="gps">–</div>
        </div>

        <div class="spec">
          <div class="key">카드납 가능 여부</div>
          <div class="val" id="cardpay">–</div>
        </div>

        <div class="spec"><div class="key">인콜 모니터링</div><div class="val" id="incall">–</div></div>
      </div>
      <p class="subtitle" id="note" style="margin-top:12px;display:none"></p>
      <p class="subtitle" id="warn" style="margin-top:8px;color:#b45309;display:none"></p>
    </section>

    <!-- 우: 단독 실손 -->
    <aside class="silson" id="silson_single">
      <h3 class="section-title st-violet">단독 실손 안내</h3>
      <div class="hstack" id="silson_badges" style="gap:8px;margin-bottom:6px"></div>

      <div class="card narrow" style="margin-top:8px">
        <div class="list" id="silson_summary"></div>
      </div>

      <div class="card narrow" id="silson_common_card" style="margin-top:10px">
        <h4 class="section-title st-blue" style="margin-bottom:10px">4세대 실손 공통사항</h4>
        <!-- 좌우 1/2 출력 영역 -->
        <div id="common_2col"></div>

        <!-- 2칸 행으로 묶인 나머지 -->
        <div class="list" id="silson_common_rest" style="margin-top:8px"></div>
      </div>

      <div class="card narrow" style="margin-top:10px">
        <h4 class="section-title st-teal" style="margin-bottom:10px">전환/인수</h4>
        <div class="list" id="silson_convert"></div>
      </div>

      <div class="card narrow" style="margin-top:10px">
        <div class="list" id="silson_specials"></div>
      </div>

      <p class="subtitle" style="margin-top:8px" id="silson_updated"></p>
    </aside>

    <!-- 유병자/노후 요약 -->
    <section class="card" style="grid-column:1/-1">
      <h2 class="section-title st-teal" style="margin-bottom:12px">유병자·노후 실손 요약</h2>
      <div class="compact-grid">
        <div id="ub_section" class="card compact-card narrow">
          <h3 class="title-mini">유병자 실손의료비</h3>
          <div id="ub_kvs"></div>
        </div>
        <div id="senior_section" class="card compact-card narrow">
          <h3 class="title-mini">노후 실손의료비</h3>
          <div id="senior_kvs"></div>
        </div>
      </div>
    </section>

    <section class="card" style="grid-column:1/-1">
      <h2 class="section-title st-violet" style="margin-bottom:12px">설명 & 주의</h2>
      <p class="subtitle">회사 정책 변경 시 실제 적용과 차이가 있을 수 있습니다. 언제나 최신 공지와 약관을 우선하세요.</p>
    </section>
  </main>

  <script>
  (function(){
    const $ = s => document.querySelector(s);
    const company = new URL(location.href).searchParams.get('c') || '';

    const telfmt = (s) => {
      const d = String(s || '').replace(/[^0-9]/g, '');
      if (!d) return '';
      if (/^(15|16|18)\d{6}$/.test(d)) return d.slice(0,4) + '-' + d.slice(4);
      if (d.startsWith('02') && (d.length === 9 || d.length === 10)) {
        return d.length === 9 ? `02-${d.slice(2,5)}-${d.slice(5)}` : `02-${d.slice(2,6)}-${d.slice(6)}`;
      }
      if (d.length === 10) return `${d.slice(0,3)}-${d.slice(3,6)}-${d.slice(6)}`;
      if (d.length === 11) return `${d.slice(0,3)}-${d.slice(3,7)}-${d.slice(7)}`;
      return s || '';
    };

    const asBool = (v) => {
      const s = String(v ?? '').trim().toLowerCase();
      if (!s) return null;
      if (['가능','yes','true','o','ok','y','1'].includes(s)) return true;
      if (['불가','no','false','x','0'].includes(s)) return false;
      return null;
    };

    const kvRow = (k,v) => `<div class="row-kv"><div class="k">${k}</div><div class="v">${v || '–'}</div></div>`;
    const kvCell = (k,v) => `<div class="row-kv"><div class="k">${k}</div><div class="v">${v||'–'}</div></div>`;

    async function fetchMaybe(url){
      const res = await fetch(url);
      if(!res.ok){ if(res.status===404) return null; throw new Error(`[${url}] HTTP ${res.status}`); }
      try{ return await res.json(); }catch(e){ throw new Error(`[${url}] JSON 파싱 실패: ${e.message}`); }
    }

    // 단독실손 배지만 생성(카드 배지는 enroll 데이터로 연동해서 따로 갱신)
    function addBadgesFromSilson(record){
      const bf = $('#badges');
      bf.innerHTML = '';
      const solo = asBool(record['단독가입여부']);
      bf.insertAdjacentHTML(
        'beforeend',
        `<span class="badge ${solo===false?'no':(solo===true?'ok':'')}" data-badge="solo">`+
        `${solo===false?'단독실손 가입 불가':(solo===true?'단독실손 가입가능':'단독실손 정보 없음')}</span>`
      );
    }

    function buildMini(container, fields, data){
      const el = $(container); el.innerHTML = '';
      fields.forEach(f=>{
        let v = (data && (data[f] ?? data[f.replace(/\s+/g,'')])) ?? '–';
        if (f === '3대비급여/약제비' && data){
          const a = data['3대비급여'] ?? null;
          const b = data['약제비'] ?? null;
          if (a || b) v = [a,b].filter(Boolean).join(' / ');
        }
        el.insertAdjacentHTML('beforeend', `<div class="kv-mini"><div class="k">${f}</div><div class="v">${(v||'–')}</div></div>`);
      });
    }

    function renderSilsonCompany(bundle, name){
      const updated = bundle?.last_updated || '';
      const record = bundle?.companies?.[name] || {};

      addBadgesFromSilson(record);

      // 요약/배지
      $('#silson_summary').innerHTML =
        kvRow('단독가입여부', record['단독가입여부']) +
        kvRow('가입나이',     record['가입나이']) +
        kvRow('중복가입',     record['중복가입']) +
        kvRow('진단여부',     record['진단여부']) +
        kvRow('특이사항',     record['특이사항']);

      // === 4세대 공통사항: 좌/우 1/2 출력 ===
      const c = record['공통사항'] || {};
      const leftHTML = `
        <div class="common-box">
          <h5>주계약(급여)</h5>
          <div class="kv-vert">
            <div class="tt">80% 보상 · 공제금액</div>
            <div class="ln"><span class="tag">의원</span><span class="num">1만원</span></div>
            <div class="ln"><span class="tag">상급·종합병원</span><span class="num">2만원</span></div>
          </div>
        </div>`;
      const rightHTML = `
        <div class="common-box">
          <h5>특약(비급여)</h5>
          <div class="kv-vert">
            <div class="tt">보상/공제 · 3만원 또는 30%</div>
            <div class="ln"><span class="tag">보상비율</span><span class="num">70%</span></div>
            <div class="ln"><span class="tag">공제</span><span class="num">3만원</span></div>
          </div>
        </div>`;
      $('#common_2col').innerHTML = leftHTML + rightHTML;

      // 나머지 항목: 1/2 그리드로 묶어서 두 줄
      $('#silson_common_rest').innerHTML = `
        <div class="row-2col">
          ${kvCell('재가입주기',   c['재가입주기'] || '5년')}
          ${kvCell('보험기간',     c['보험기간']   || '1년 갱신형')}
        </div>
        <div class="row-2col">
          ${kvCell('자기부담금',   c['자기부담금'] || '급여 20% / 비급여 30%')}
          ${kvCell('보험료차등제', c['보험료차등제'] || '있음(손해율 연동)')}
        </div>`;

      // 전환/인수
      const conv = record['전환/인수'] || {};
      $('#silson_convert').innerHTML =
        kvRow('전환인수기준 조건',      conv['전환인수기준조건']) +
        kvRow('과거 실손상품별 전환여부', conv['과거실손상품별전환여부']) +
        kvRow('전환시 고지사항',        conv['전환시고지사항']);

      // 기타
      // 변경
const specials = [];
Object.entries(record).forEach(([k, v]) => {
  if (!v) return;
  // 화면에 따로 보여주는 키들은 전부 제외
  const EXCLUDE = [
    '단독가입여부','중복가입','진단여부','특이사항',
    '공통사항','전환/인수',
    '유병자 실손의료비','노후 실손의료비',
    '유병자 실손 컴팩트','노후 실손 컴팩트','유병자 공통사항',
    // 여기 추가: 기타 카드에 나오지 않게
    '가입나이','카드납 가능'
  ];
  if (EXCLUDE.includes(k)) return;
  specials.push(kvRow(k, v));
});

// 예비 문구 없이 렌더 + 내용 없으면 카드 자체 숨김
const spHost = document.getElementById('silson_specials');
spHost.innerHTML = specials.join('');
if (!specials.length) {
  const spCard = spHost.closest('.card');
  if (spCard) spCard.style.display = 'none';
}
      $('#silson_updated').textContent = updated ? `※ 데이터 기준일: ${updated}` : '';

      // 유병자/노후 컴팩트
      const ubData = record['유병자 실손 컴팩트'] || {};
      buildMini('#ub_kvs', ['가입나이','단독가입여부','진단여부','입원','통원','재가입주기','보험기간','자기부담금','3대비급여/약제비','알릴의무'], ubData);

      const snData = record['노후 실손 컴팩트'] || {};
      buildMini('#senior_kvs', ['가입나이','단독가입여부','진단여부','기본계약1','기본계약2','선택계약1','선택계약2','재가입주기','보험기간','3대비급여/약제비','알릴의무'], snData);
    }

    // 스무스 스크롤
    document.querySelectorAll('a[href^="#"]').forEach(a=>{
      a.addEventListener('click', (e)=>{
        const id = a.getAttribute('href');
        const el = document.querySelector(id);
        if(el){ e.preventDefault(); el.scrollIntoView({behavior:'smooth', block:'start'}); }
      });
    });

    (async function init(){
      try{
        const [linksData, enrollData, silsonCompany] = await Promise.all([
          fetchMaybe('/data/links.json?ts='+Date.now()),
          fetchMaybe('/data/enroll.json?ts='+Date.now()),
          fetchMaybe('/data/silson-company.json?ts='+Date.now())
        ]);

        const carriers = Array.isArray(linksData?.carriers) ? linksData.carriers : [];
        const base = carriers.find(x => x.name === company) || {};
        const enr  = (Array.isArray(enrollData?.items) ? enrollData.items : []).find(x => x.name === company) || {};
        const L = base.links || {};

        // 헤더
        $('#company').textContent = company || '전자청약정보';
        const logoSrc = base.logo || (company ? `/assets/logos/${company}.png` : '');
        if (logoSrc){ const img = $('#logo'); img.src = logoSrc; img.alt = company + ' 로고'; }

        // 히어로 KV
        const ageTxt = enr.mobile_enroll_age_text || (enr.mobile_enroll_age ? `${enr.mobile_enroll_age.min ?? '?'} ~ ${enr.mobile_enroll_age.max ?? '?'}세` : '–');
        $('#kv_mobile_age').textContent = ageTxt || '–';
        $('#kv_usage_hours').textContent = enr.usage_hours || '–';
        $('#kv_call_hours').textContent  = enr.call_hours  || '–';
        const incall = enr.incall_monitoring_phone || L.monitor || '';
        $('#kv_incall').textContent = incall ? telfmt(incall) : '–';

        // 전화 버튼
        const csTel   = L.cs || '';
        const faxTel  = L.fax || '';
        const helpTel = enr.helpdesk_phone || L.helpdesk || '';
        const bindTelBtn = (btnId, txtId, tel) => {
          const btn = document.getElementById(btnId);
          const span= document.getElementById(txtId);
          if (tel){
            const fmt = telfmt(tel);
            btn.href = 'tel:' + (tel.replace(/\D/g,'')); span.textContent = fmt || tel;
          } else {
            span.textContent = '–'; btn.removeAttribute('href'); btn.classList.add('muted');
          }
        };
        bindTelBtn('btn_cs_tel','txt_cs_tel',csTel);
        bindTelBtn('btn_fax_tel','txt_fax_tel',faxTel);
        bindTelBtn('btn_help_tel','txt_help_tel',helpTel);

        // 상세 값 바인딩
        const setTXT = (id, v) => { const el = document.getElementById(id); if(el) el.textContent = (v ?? '') || '–'; };
        const gpsBool  = asBool(enr.gye_pi_sang_available);
        const cardBool = asBool(enr.card_payment_available);

        setTXT('usage_period', enr.usage_period);
        setTXT('usage_hours',  enr.usage_hours);
        setTXT('call_hours',   enr.call_hours);
        setTXT('mobile_age',   ageTxt);
        setTXT('incall', incall ? telfmt(incall) : '–');

        // 상세(계피상/카드) 영역
        const gpsDetail = (enr.gye_pi_sang_detail || enr.monitoring_criteria || '').trim();
        const gpsWrap = document.getElementById('gps');
        gpsWrap.innerHTML =
          (gpsBool==null ? '' : `<span class="badge ${gpsBool?'ok':'no'}">${gpsBool?'계피상이 가능':'계피상이 불가'}</span>`)
          + (gpsDetail ? ` <span style="color:#0f172a">${gpsDetail}</span>` : '');

        const cardDetail = (enr.card_payment_detail || '').trim();
        const cardWrap = document.getElementById('cardpay');
        cardWrap.innerHTML =
          (cardBool==null ? '' : `<span class="badge ${cardBool?'ok':'no'}">${cardBool?'카드납 가능':'카드납 불가'}</span>`)
          + (cardDetail ? ` <span style="color:#0f172a;white-space:pre-line">${cardDetail}</span>` : '');

        // 실손 카드(이 호출로 상단에 '단독실손' 배지가 먼저 생김)
        renderSilsonCompany(silsonCompany || {companies:{}}, company);

        // === 상단 배지의 '카드납 …'을 enroll.json 기준으로 동기화 ===
        (function syncTopCardBadge(){
          const bf = $('#badges');
          // 기존 카드 배지 제거
          const old = bf.querySelector('[data-badge="card"]');
          if (old) old.remove();
          // 새 카드 배지 삽입
          if (cardBool !== null){
            const label = cardBool ? '카드납 가능' : '카드납 불가';
            bf.insertAdjacentHTML('beforeend',
              `<span class="badge ${cardBool?'ok':'no'}" data-badge="card">${label}</span>`);
          } else {
            bf.insertAdjacentHTML('beforeend',
              `<span class="badge" data-badge="card">카드납 정보 없음</span>`);
          }
        })();

        // 시간 외 경고/노트
        const inHours = (str) => {
          if(!str) return true;
          if(/24\s*시간/.test(str)) return true;
          const m = str.match(/(\d{2}):(\d{2})\s*[–-]\s*(\d{2}):(\d{2})/);
          if(!m) return true;
          const now = new Date(), cur = now.getHours()*60 + now.getMinutes();
          const a = (+m[1])*60+(+m[2]), b=(+m[3])*60+(+m[4]);
          return cur>=a && cur<=b;
        };
        if(enr.usage_hours && !inHours(enr.usage_hours)){
          const w = document.getElementById('warn'); w.style.display='block';
          w.textContent = `지금은 사용시간(${enr.usage_hours}) 외일 수 있습니다. 회사 정책상 제한될 수 있습니다.`;
        }
        if(enr.note){
          const n = document.getElementById('note'); n.style.display='block'; n.textContent = enr.note;
        }

        // 헤더 배지: 계피상 여부(상단)
        (function addGpsBadgeTop(){
          const bf = $('#badges');
          const v = enr.gye_pi_sang_available;
          const s = String(v ?? '').trim().toLowerCase();
          let b = null;
          if (!s) b = null;
          else if (['가능','yes','true','o','ok','y','1'].includes(s)) b = true;
          else if (['불가','no','false','x','0'].includes(s)) b = false;
          if (b === null) return;
          bf.insertAdjacentHTML('beforeend',
            `<span class="badge ${b?'ok':'no'}">${b?'계피상이 가능':'계피상이 불가'}</span>`);
        })();

      }catch(err){
        console.error(err);
        const host = document.createElement('div');
        host.className = 'maxw';
        host.style.padding = '24px';
        host.innerHTML = `<h1>데이터 로드 오류</h1><p style="white-space:pre-line">${String(err.message || err)}</p>`;
        document.body.innerHTML = '';
        document.body.appendChild(host);
      }
    })();
  })();
  </script>
  <!-- ===== CopyGuard: 무단복제 금지 배지 + 복사 안내 ===== -->
<style>
  .cg-badge{
    position:fixed; right:12px; bottom:12px; z-index:9999;
    padding:8px 12px; border-radius:999px; font-size:12px; font-weight:700;
    color:#0f172a; background:rgba(255,255,255,.9); border:1px solid #e2e8f0;
    box-shadow:0 6px 16px rgba(2,6,23,.12);
    user-select:none; -webkit-user-select:none;
    backdrop-filter:saturate(140%) blur(6px);
  }
  .cg-badge small{font-weight:600; color:#64748b; margin-left:6px}
  /* 인쇄 시 배지 숨김 */
  @media print { .cg-badge, .cg-toast{ display:none !important; } }

  .cg-toast{
    position:fixed; left:50%; bottom:64px; transform:translateX(-50%) translateY(20px);
    z-index:10000; padding:10px 14px; border-radius:12px; font-size:13px; color:#111827;
    background:#fff; border:1px solid #e2e8f0; box-shadow:0 10px 24px rgba(2,6,23,.16);
    opacity:0; pointer-events:none; transition:transform .25s ease, opacity .25s ease;
  }
  .cg-toast.show{ opacity:1; transform:translateX(-50%) translateY(0); }
</style>

<div class="cg-badge" aria-label="저작권 보호 안내">
  무단복제 금지 <small>저작권 보호중</small>
</div>
<div class="cg-toast" id="cgToast" role="status" aria-live="polite">
  복사 내용은 저작권 보호 대상입니다.
</div>

<script>
(() => {
  // 복사 시 토스트 노출
  const toast = document.getElementById('cgToast');
  let t;
  const showToast = (msg) => {
    if (!toast) return;
    if (msg) toast.textContent = msg;
    toast.classList.add('show');
    clearTimeout(t);
    t = setTimeout(()=> toast.classList.remove('show'), 1600);
  };

  document.addEventListener('copy', (e) => {
    // (선택) 클립보드에 출처 꼬리표 추가 — 필요 없으면 이 블록 주석 처리
    try {
      const sel = window.getSelection?.().toString() || '';
      const src = location.origin + location.pathname;
      const note = `\n\n— 출처: ${src} (무단복제 금지)`;
      const text = sel ? (sel + note) : note;
      e.clipboardData.setData('text/plain', text);
      e.preventDefault();
    } catch(_) {}
    showToast('복사 내용은 저작권 보호 대상입니다.');
  }, { capture:true });

  // 우클릭/F12 차단 스크립트 이미 넣었다면 아래는 중복 실행돼도 무방
  const block = (ev) => { ev.preventDefault(); ev.stopPropagation(); return false; };
  document.addEventListener('contextmenu', block, { capture:true });
  document.addEventListener('keydown', (e) => {
    const k = (e.key||'').toLowerCase();
    if (k === 'f12') return block(e);
    if (e.ctrlKey && e.shiftKey && ['i','j','c'].includes(k)) return block(e);
    if (e.ctrlKey && ['u','s','p'].includes(k)) return block(e);
  }, { capture:true });
})();
</script>
<!-- ===== /CopyGuard ===== -->
</body>
</html>
