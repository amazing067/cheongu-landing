<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>전자청약정보 | 청구닷컴</title>
  <meta name="robots" content="noindex,nofollow"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;600;800;900&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="/assets/site.css?v=final-compact-12" />
  <style>
  :root{
    --ink:#0f172a; --muted:#475569; --line:#e2e8f0;
    --brand:#7c3aed; --brand-2:#0ea5e9; --good:#10b981; --bad:#ef4444;
    --bg:#f8fafc; --card:#ffffff;
  }

  /* ===== Base ===== */
  body{background:var(--bg);color:var(--ink);font-family:Pretendard,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;}
  .maxw{max-width:78rem;margin:0 auto;padding:16px}
  .hstack{display:flex;flex-wrap:wrap;gap:12px;align-items:center}
  .title{font-size:32px;font-weight:900;letter-spacing:-.01em;margin:0}
  .subtitle{font-size:13px;color:#64748b;margin-top:2px}
  .logo{height:56px;object-fit:contain}

  /* ===== Card / Chip / Badge ===== */
  .card{background:var(--card);border:1px solid var(--line);border-radius:16px;padding:16px;box-shadow:0 3px 10px rgba(2,6,23,.04)}
  .chip{font-size:11px;border:1px solid var(--line);border-radius:999px;padding:2px 8px;background:#fff}
  .badge{display:inline-flex;align-items:center;gap:6px;border:1px solid var(--line);border-radius:999px;padding:6px 12px;font-size:12px;background:#fff}
  .badge.ok{border-color:#86efac;background:#ecfdf5;color:#065f46}
  .badge.no{border-color:#fecaca;background:#fef2f2;color:#991b1b}

  /* ===== Buttons ===== */
  .btn{
    display:inline-flex;align-items:center;gap:8px;border-radius:12px;border:1px solid var(--line);background:#fff;
    padding:10px 14px;font-weight:800;text-decoration:none;color:#0f172a;
    transition:transform .15s ease, box-shadow .15s ease, filter .15s ease, background-color .15s ease, opacity .15s ease;
    box-shadow:0 4px 10px rgba(2,6,23,.06);
  }
  .btn:hover{transform:translateY(-1px);box-shadow:0 8px 18px rgba(2,6,23,.08);background:#f8fafc}
  .btn[disabled], .btn.muted{opacity:.55;cursor:not-allowed}
  .btn svg{width:16px;height:16px}

  /* ===== Grid ===== */
  .grid{display:grid;gap:16px}
  @media (min-width:1024px){ .grid-2{grid-template-columns:1.35fr 1fr} }

  /* ===== Hero 기본 ===== */
  .hero{ border-radius:20px; padding:22px; border:1px solid rgba(124,58,237,.25); }
  .hero .heading{font-size:22px;font-weight:900;margin:0 0 6px}
  .hero .rows{display:grid; gap:10px}
  @media (min-width:640px){ .hero .rows{grid-template-columns:1fr 1fr} }
  .kv{background:#fff;border:1px solid var(--line);border-radius:12px;padding:10px 12px}
  .kv .k{font-size:12px;color:#475569}
  .kv .v{font-size:16px;font-weight:800;color:#111827;margin-top:1px}
  .hero .actions{display:flex;flex-wrap:wrap;gap:8px;margin-top:12px}

  /* 표 카드 */
  .rowspec{display:grid;gap:10px}
  .spec{display:flex;justify-content:space-between;gap:12px;padding:10px 0;border-top:1px dashed rgba(100,116,139,.28)}
  .spec:first-child{border-top:0}
  .key{font-weight:700;color:#334155}
  .val{color:#0f172a}

  /* 실손 블록 */
  .silson{background:#fff;border:1px solid rgba(100,116,139,.22);border-radius:16px;padding:16px;box-shadow:0 3px 10px rgba(2,6,23,.04)}
  .silson h3{margin:0 0 8px;font-weight:900}
  .list{display:grid;gap:8px}

  /* K–V 줄고정 & 와이드 보정 */
  .row-kv{
    display:grid;
    grid-template-columns:minmax(9rem,12rem) 1fr;
    align-items:center; gap:10px;
    border-top:1px dashed rgba(100,116,139,.26); padding:8px 0;
  }
  .row-kv:first-child{border-top:0}
  .row-kv .k{font-weight:800;color:#334155}
  .row-kv .v{color:#0f172a; line-height:1.55; word-break:keep-all; white-space:normal}
  .cols2{display:grid; gap:10px}
  @media (min-width:860px){ .cols2{grid-template-columns:1fr 1fr} }
  </style>

  <!-- ===== 페이지 전용 오버라이드(공통 CSS보다 우선) — 반드시 </head> 직전에 둠 ===== -->
  <style id="enroll-override">
  /* ===== 페이지 전용 스킨(강제 적용) — 더 강한 토닝 ===== */
.page-enroll{
  background:
    radial-gradient(28px 28px at 14px 14px, rgba(124,58,237,.06) 1px, transparent 1px),
    linear-gradient(180deg, #f7f9ff 0%, #f2f6ff 38%, #f8fafc 100%) !important;
  background-size:28px 28px, auto !important;
}

/* 히어로: 유리카드 느낌 + 진한 보더/섀도우 */
.page-enroll .hero{
  background: linear-gradient(135deg, rgba(124,58,237,.15), rgba(14,165,233,.15)) !important;
  border: 1px solid rgba(124,58,237,.35) !important;
  border-radius: 20px !important;
  box-shadow: 0 14px 34px rgba(79,70,229,.12), 0 2px 0 rgba(255,255,255,.45) inset !important;
}

/* 히어로 내부 KV 박스: 살짝 반투명 + 라운드 강화 */
.page-enroll .kv{
  background: rgba(255,255,255,.9) !important;
  border: 1px solid rgba(100,116,139,.28) !important;
  border-radius: 14px !important;
  box-shadow: 0 3px 8px rgba(2,6,23,.06) !important;
}
.page-enroll .kv .k{ font-size:12px !important; color:#475569 !important; opacity:.95 !important; }
.page-enroll .kv .v{ font-size:16px !important; font-weight:800 !important; color:#0f172a !important; }

/* 카드/실손 카드: 라운드 + 그림자 업 */
.page-enroll .card,
.page-enroll .silson{
  border:1px solid rgba(100,116,139,.26) !important;
  border-radius:16px !important;
  box-shadow:0 6px 18px rgba(2,6,23,.06) !important;
  background:#fff !important;
}

/* 배지: 색감 조금 더 선명하게 */
.page-enroll .badge{
  border-color: rgba(99,102,241,.28) !important;
  box-shadow: inset 0 0 0 1px rgba(255,255,255,.7) !important;
  background:#fff !important;
}
.page-enroll .badge.ok{ background:#ecfdf5 !important; border-color:#86efac !important; color:#065f46 !important; }
.page-enroll .badge.no{ background:#fef2f2 !important; border-color:#fecaca !important; color:#991b1b !important; }

/* 버튼: 살짝 리프트 + 아웃라인 톤 */
.page-enroll .btn{
  box-shadow:0 4px 12px rgba(2,6,23,.08) !important;
  transition: transform .15s ease, box-shadow .15s ease, filter .15s ease, background-color .15s ease !important;
  border-color:#d6daf0 !important;
}
.page-enroll .btn:hover{ transform:translateY(-2px) !important; box-shadow:0 10px 22px rgba(2,6,23,.12) !important; }
.page-enroll #btn_cs_tel,
.page-enroll #btn_fax_tel,
.page-enroll #btn_help_tel{
  background:#fff !important;
  border-color:#c7d2fe !important;
}

/* 공통사항 2열: 와이드에서도 줄깨짐 방지 */
.page-enroll .row-kv{
  display:grid !important;
  grid-template-columns:minmax(10rem,13rem) 1fr !important;
  align-items:center !important;
  gap:10px !important;
  border-top:1px dashed rgba(100,116,139,.26) !important;
  padding:10px 0 !important;
}
.page-enroll .row-kv .k{ font-weight:800 !important; color:#334155 !important; }
.page-enroll .row-kv .v{ line-height:1.6 !important; word-break:keep-all !important; white-space:normal !important; }
.page-enroll .cols2{ display:grid !important; gap:12px !important; }
@media (min-width:860px){ .page-enroll .cols2{ grid-template-columns:1fr 1fr !important; } }

  </style>
</head>

<body class="page-enroll">
  <header class="maxw">
    <div class="hstack">
      <a href="/" class="btn">← 목록으로</a>
      <span class="chip">전자청약</span>
    </div>

    <div class="hstack" style="gap:14px;margin-top:12px">
      <img id="logo" class="logo" alt="로고" />
      <div>
        <h1 class="title" id="company">전자청약정보</h1>
        <p class="subtitle">회사별 전자청약 핵심 지표를 한눈에 확인하고, 바로 실행하세요.</p>
        <div class="hstack" id="badges" style="gap:8px;margin-top:6px"></div>
      </div>
    </div>
  </header>

  <main class="maxw grid grid-2" style="margin-top:14px">
    <!-- 모바일 전자청약 정보(히어로) -->
    <section class="hero" style="grid-column:1/-1">
      <div class="heading">모바일 전자청약 정보</div>
      <div class="rows">
        <div class="kv">
          <div class="k">모바일 청약 가능 나이</div>
          <div class="v" id="kv_mobile_age">–</div>
        </div>
        <div class="kv">
          <div class="k">전자청약 사용시간</div>
          <div class="v" id="kv_usage_hours">–</div>
        </div>
        <div class="kv">
          <div class="k">통화가능시간</div>
          <div class="v" id="kv_call_hours">–</div>
        </div>
        <div class="kv">
          <div class="k">인콜 모니터링</div>
          <div class="v" id="kv_incall">–</div>
        </div>
      </div>
      <div class="actions">
        <!-- 전화 버튼 3종 -->
        <a id="btn_cs_tel" class="btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.8 19.8 0 0 1-8.63-3.07A19.5 19.5 0 0 1 3.15 9.81 19.8 19.8 0 0 1 .08 1.18 2 2 0 0 1 2.06 0h3a2 2 0 0 1 2 1.72c.12.89.31 1.76.57 2.6a2 2 0 0 1-.45 2.11L6.09 7.91a16 16 0 0 0 10 10l1.48-1.09a2 2 0 0 1 2.11-.45c.84.26 1.71.45 2.6.57A2 2 0 0 1 22 16.92z"/></svg>
          고객센터: <span id="txt_cs_tel">–</span>
        </a>
        <a id="btn_fax_tel" class="btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><rect x="3" y="7" width="18" height="13" rx="2"/><path d="M7 7V3h10v4"/><path d="M8 13h8M8 17h6"/></svg>
          보험금청구 FAX: <span id="txt_fax_tel">–</span>
        </a>
        <a id="btn_help_tel" class="btn">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor"><circle cx="12" cy="12" r="10"/><path d="M9.09 9a3 3 0 1 1 5.82 1c0 2-3 2-3 4"/><path d="M12 17h.01"/></svg>
          헬프데스크(전산): <span id="txt_help_tel">–</span>
        </a>
      </div>
    </section>

    <!-- 좌: 세부 스펙 -->
    <section class="card">
      <h2 style="margin:0 0 10px;font-weight:900">모바일 전자청약 정보</h2>
      <div class="rowspec">
        <div class="spec"><div class="key">사용기한</div><div class="val" id="usage_period">–</div></div>
        <div class="spec"><div class="key">사용시간</div><div class="val" id="usage_hours">–</div></div>
        <div class="spec"><div class="key">통화가능시간</div><div class="val" id="call_hours">–</div></div>
        <div class="spec"><div class="key">모바일 청약 가능 나이</div><div class="val" id="mobile_age">–</div></div>
        <div class="spec"><div class="key">계약자·피보험자 불일치 가능 여부</div><div class="val" id="gps">–</div></div>
        <div class="spec"><div class="key">불일치 시 모니터링 기준</div><div class="val" id="monitoring_criteria">–</div></div>
        <div class="spec"><div class="key">카드납 가능 여부</div><div class="val" id="cardpay">–</div></div>
        <div class="spec"><div class="key">인콜 모니터링</div><div class="val" id="incall">–</div></div>
      </div>
      <p class="subtitle" id="note" style="margin-top:12px;display:none"></p>
      <p class="subtitle" id="warn" style="margin-top:8px;color:#b45309;display:none"></p>
    </section>

    <!-- 우: 실손 안내(회사별 구조) -->
    <aside class="silson">
      <h3>실손 안내</h3>
      <div class="hstack" id="silson_badges" style="gap:8px;margin-bottom:6px"></div>

      <!-- 요약 -->
      <div class="card" style="margin-top:8px">
        <div class="list" id="silson_summary"></div>
      </div>

      <!-- 공통사항 -->
      <div class="card" style="margin-top:10px">
        <h4 style="margin:0 0 8px;font-weight:900">공통사항</h4>
        <div class="list cols2" id="silson_common"></div>
      </div>

      <!-- 전환/인수 -->
      <div class="card" style="margin-top:10px">
        <h4 style="margin:0 0 8px;font-weight:900">전환/인수</h4>
        <div class="list" id="silson_convert"></div>
      </div>

      <!-- 유병자/노후 -->
      <div class="card" style="margin-top:10px">
        <div class="list" id="silson_specials"></div>
      </div>

      <div style="margin-top:10px" class="hstack">
        <a href="/#medcalc" class="btn">실손 간편 계산기 열기</a>
      </div>
      <p class="subtitle" style="margin-top:8px" id="silson_updated"></p>
    </aside>

    <section class="card" style="grid-column:1/-1">
      <h2 style="margin:0 0 10px;font-weight:900">설명 & 주의</h2>
      <p class="subtitle">회사 정책 변경 시 실제 적용과 차이가 있을 수 있습니다. 언제나 최신 공지와 약관을 우선하세요.</p>
    </section>
  </main>

  <script>
  (function(){
    const $ = s => document.querySelector(s);
    const company = new URL(location.href).searchParams.get('c') || '';

    // 전화번호 포맷터
    const telfmt = (s) => {
      const d = String(s || '').replace(/[^0-9]/g, '');
      if (!d) return '';
      if (/^(15|16|18)\d{6}$/.test(d)) return d.slice(0,4) + '-' + d.slice(4); // 15660757 → 1566-0757
      if (d.startsWith('02') && (d.length === 9 || d.length === 10)) {
        return d.length === 9 ? `02-${d.slice(2,5)}-${d.slice(5)}` : `02-${d.slice(2,6)}-${d.slice(6)}`;
      }
      if (d.length === 10) return `${d.slice(0,3)}-${d.slice(3,6)}-${d.slice(6)}`;
      if (d.length === 11) return `${d.slice(0,3)}-${d.slice(3,7)}-${d.slice(7)}`;
      return s || '';
    };

    const asBool = (v) => {
      const s = String(v ?? '').trim().toLowerCase();
      if (!s) return null;
      if (['가능','yes','true','o','ok','y','1'].includes(s)) return true;
      if (['불가','no','false','x','0'].includes(s)) return false;
      return null;
    };

    const kvRow = (k,v) => `<div class="row-kv"><div class="k">${k}</div><div class="v">${v || '–'}</div></div>`;

    async function fetchMaybe(url){
      const res = await fetch(url);
      if(!res.ok){ if(res.status===404) return null; throw new Error(`[${url}] HTTP ${res.status}`); }
      try{ return await res.json(); }catch(e){ throw new Error(`[${url}] JSON 파싱 실패: ${e.message}`); }
    }

    function renderSilsonCompany(bundle, name){
      const updated = bundle?.last_updated || '';
      const record = bundle?.companies?.[name] || {};

      // 상단 배지: 단독실손 / 카드납
      const bf = $('#badges');
      bf.innerHTML = '';
      const solo = asBool(record['단독가입여부']);
      const card = asBool(record['카드납 가능']);
      bf.insertAdjacentHTML('beforeend', `<span class="badge ${solo===false?'no':(solo===true?'ok':'')}">${solo===false?'단독실손 가입 불가':(solo===true?'단독실손 가입가능':'단독실손 정보 없음')}</span>`);
      bf.insertAdjacentHTML('beforeend', `<span class="badge ${card===false?'no':(card===true?'ok':'')}">${card===false?'카드납 불가':(card===true?'카드납 가능':'카드납 정보 없음')}</span>`);

      // 실손 카드들
      $('#silson_summary').innerHTML =
        kvRow('단독가입여부', record['단독가입여부']) +
        kvRow('중복가입',     record['중복가입']) +
        kvRow('진단여부',     record['진단여부']) +
        kvRow('특이사항',     record['특이사항']);

      const c = record['공통사항'] || {};
      $('#silson_common').innerHTML =
        kvRow('주계약(급여)', c['주계약(급여)']) +
        kvRow('특약(비급여)', c['특약(비급여)']) +
        kvRow('재가입주기',   c['재가입주기']) +
        kvRow('보험기간',     c['보험기간']) +
        kvRow('자기부담금',   c['자기부담금']) +
        kvRow('보험료차등제', c['보험료차등제']);

      const conv = record['전환/인수'] || {};
      $('#silson_convert').innerHTML =
        kvRow('전환인수기준 조건',      conv['전환인수기준조건']) +
        kvRow('과거 실손상품별 전환여부', conv['과거실손상품별전환여부']) +
        kvRow('전환시 고지사항',        conv['전환시고지사항']);

      $('#silson_specials').innerHTML =
        kvRow('유병자 실손의료비', record['유병자 실손의료비']) +
        kvRow('노후 실손의료비',   record['노후 실손의료비']);

      $('#silson_updated').textContent = updated ? `※ 데이터 기준일: ${updated}` : '';
    }

    (async function init(){
      try{
        const [linksData, enrollData, silsonCompany] = await Promise.all([
          fetchMaybe('/data/links.json?ts='+Date.now()),
          fetchMaybe('/data/enroll.json?ts='+Date.now()),
          fetchMaybe('/data/silson-company.json?ts='+Date.now())
        ]);

        const carriers = Array.isArray(linksData?.carriers) ? linksData.carriers : [];
        const base = carriers.find(x => x.name === company) || {};
        const enr  = (Array.isArray(enrollData?.items) ? enrollData.items : []).find(x => x.name === company) || {};
        const L = base.links || {};

        // 헤더
        $('#company').textContent = company || '전자청약정보';
        const logoSrc = base.logo || (company ? `/assets/logos/${company}.png` : '');
        if (logoSrc){ const img = $('#logo'); img.src = logoSrc; img.alt = company + ' 로고'; }

        // 히어로 KV
        const ageTxt = enr.mobile_enroll_age_text || (enr.mobile_enroll_age ? `${enr.mobile_enroll_age.min ?? '?'} ~ ${enr.mobile_enroll_age.max ?? '?'}세` : '–');
        $('#kv_mobile_age').textContent = ageTxt || '–';
        $('#kv_usage_hours').textContent = enr.usage_hours || '–';
        $('#kv_call_hours').textContent  = enr.call_hours  || '–';
        const incall = enr.incall_monitoring_phone || L.monitor || '';
        $('#kv_incall').textContent = incall ? telfmt(incall) : '–';

        // 전화 버튼(고객센터/FAX/헬프데스크)
        const csTel   = L.cs || '';
        const faxTel  = L.fax || '';
        const helpTel = enr.helpdesk_phone || L.helpdesk || '';
        const bindTelBtn = (btnId, txtId, tel) => {
          const btn = document.getElementById(btnId);
          const span= document.getElementById(txtId);
          if (tel){
            const fmt = telfmt(tel);
            btn.href = 'tel:' + (tel.replace(/\D/g,''));
            span.textContent = fmt || tel;
          } else {
            span.textContent = '–';
            btn.removeAttribute('href');
            btn.classList.add('muted');
          }
        };
        bindTelBtn('btn_cs_tel','txt_cs_tel',csTel);
        bindTelBtn('btn_fax_tel','txt_fax_tel',faxTel);
        bindTelBtn('btn_help_tel','txt_help_tel',helpTel);

        // 상세 정보
        const set = (id, v) => { const el = document.getElementById(id); if(el) el.textContent = (v ?? '') || '–'; };
        const gps  = asBool(enr.gye_pi_sang_available);
        const card = asBool(enr.card_payment_available);
        set('usage_period', enr.usage_period);
        set('usage_hours',  enr.usage_hours);
        set('call_hours',   enr.call_hours);
        set('mobile_age',   ageTxt);
        set('gps',          gps===false?'불가':(gps===true?'가능':'정보 없음'));
        set('monitoring_criteria', enr.monitoring_criteria);
        set('cardpay',      card===false?'불가':(card===true?'가능':'정보 없음'));
        set('incall',       incall ? telfmt(incall) : '–');

        // 실손 카드
        renderSilsonCompany(silsonCompany || {companies:{}}, company);

        // 시간 외 경고/노트
        const inHours = (str) => {
          if(!str) return true;
          if(/24\s*시간/.test(str)) return true;
          const m = str.match(/(\d{2}):(\d{2})\s*[–-]\s*(\d{2}):(\d{2})/);
          if(!m) return true;
          const now = new Date(), cur = now.getHours()*60 + now.getMinutes();
          const a = (+m[1])*60+(+m[2]), b=(+m[3])*60+(+m[4]);
          return cur>=a && cur<=b;
        };
        if(enr.usage_hours && !inHours(enr.usage_hours)){
          const w = document.getElementById('warn'); w.style.display='block';
          w.textContent = `지금은 사용시간(${enr.usage_hours}) 외일 수 있습니다. 회사 정책상 제한될 수 있습니다.`;
        }
        if(enr.note){
          const n = document.getElementById('note'); n.style.display='block'; n.textContent = enr.note;
        }

      }catch(err){
        console.error(err);
        const host = document.createElement('div');
        host.className = 'maxw';
        host.style.padding = '24px';
        host.innerHTML = `<h1>데이터 로드 오류</h1><p style="white-space:pre-line">${String(err.message || err)}</p>`;
        document.body.innerHTML = '';
        document.body.appendChild(host);
      }
    })();
  })();
  </script>
</body>
</html>
