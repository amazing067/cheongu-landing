<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF í•„ë“œ ë§¤í•‘ ë„êµ¬ (AcroFormìš©) - ì²­êµ¬ë‹·ì»´</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Pretendard', -apple-system, sans-serif; background: #f6f8fb; padding: 20px; }
        .container { max-width: 1600px; margin: 0 auto; }
        
        .header { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
        h1 { font-size: 24px; color: #111827; margin-bottom: 8px; }
        .subtitle { color: #6b7280; font-size: 14px; }
        
        .tools { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; }
        .tools input[type="file"] { display: none; }
        .tools label, .tools button, .tools select, .tools input[type="text"] { padding: 10px 16px; border-radius: 8px; border: 1px solid #e5e7eb; background: white; font-weight: 600; font-size: 14px; transition: all 0.2s; }
        .tools label { cursor: pointer; display: flex; align-items: center; justify-content: center; }
        .tools button { cursor: pointer; }
        .tools label:hover, .tools button:hover { background: #f9fafb; border-color: #3a64ff; }
        .tools button.primary { background: #3a64ff; color: white; border-color: #3a64ff; }
        .tools button.primary:hover { background: #2d50cc; }
        .tools input[type="text"] { font-weight: 400; }
        
        .workspace { display: grid; grid-template-columns: 1fr 400px; gap: 20px; }
        
        .canvas-wrapper { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); position: relative; overflow: auto; max-height: calc(100vh - 300px); }
        .canvas-container { position: relative; display: inline-block; }
        #pdf-canvas { border: 2px solid #e5e7eb; cursor: crosshair; display: block; }
        
        .crosshair { position: absolute; pointer-events: none; z-index: 10; }
        .crosshair-h { width: 100%; height: 1px; background: #3a64ff; opacity: 0.6; }
        .crosshair-v { height: 100%; width: 1px; background: #3a64ff; opacity: 0.6; }
        
        .marker { position: absolute; transform: translate(-50%, -50%); pointer-events: none; z-index: 20; }
        .marker-dot { width: 12px; height: 12px; background: #ef4444; border: 3px solid white; border-radius: 50%; box-shadow: 0 2px 8px rgba(0,0,0,0.3); }
        .marker-label { position: absolute; top: -25px; left: 10px; background: rgba(0,0,0,0.85); color: white; padding: 4px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; white-space: nowrap; }
        
        .drag-rect { position: absolute; border: 3px dashed #3a64ff; background: rgba(58, 100, 255, 0.1); pointer-events: none; z-index: 15; }
        
        .coord-display { position: sticky; top: 10px; right: 10px; float: right; background: rgba(0,0,0,0.85); color: white; padding: 10px 14px; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 13px; z-index: 30; margin-bottom: 10px; }
        
        .panel { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); max-height: calc(100vh - 300px); overflow-y: auto; }
        .panel h2 { font-size: 18px; margin-bottom: 16px; color: #111827; padding-bottom: 12px; border-bottom: 2px solid #e5e7eb; }
        
        .quick-fields { margin-bottom: 20px; padding: 16px; background: #f0f9ff; border-radius: 8px; border: 1px solid #bae6fd; }
        .quick-fields h3 { font-size: 14px; margin-bottom: 10px; color: #0c4a6e; }
        .quick-btn-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; }
        .quick-btn { padding: 8px 10px; border-radius: 6px; border: 1px solid #0ea5e9; background: white; color: #0369a1; cursor: pointer; font-size: 12px; font-weight: 600; transition: all 0.15s; }
        .quick-btn:hover { background: #0ea5e9; color: white; }
        
        .field-list { display: flex; flex-direction: column; gap: 8px; margin-top: 16px; }
        .field-item { display: grid; grid-template-columns: auto 1fr auto auto auto; gap: 6px; padding: 10px; background: #f9fafb; border-radius: 8px; border: 1px solid #e5e7eb; align-items: center; transition: all 0.2s; }
        .field-item:hover { border-color: #3b82f6; box-shadow: 0 2px 6px rgba(59, 130, 246, 0.15); }
        .field-item.waiting { background: #fef3c7; border-color: #fbbf24; }
        .field-item.waiting:hover { border-color: #f59e0b; box-shadow: 0 2px 6px rgba(245, 158, 11, 0.25); }
        .field-item.complete { background: #d1fae5; border-color: #10b981; }
        .field-item.complete:hover { border-color: #059669; }
        .field-item .index { width: 24px; height: 24px; background: #6b7280; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 12px; font-weight: 700; }
        .field-item.waiting .index { background: #f59e0b; }
        .field-item.complete .index { background: #10b981; }
        .field-item .info { display: flex; flex-direction: column; gap: 2px; }
        .field-item .name { font-weight: 700; color: #111827; font-size: 13px; }
        .field-item .coords { color: #6b7280; font-family: 'Courier New', monospace; font-size: 11px; }
        .field-item button { padding: 6px 8px; border-radius: 6px; border: 1px solid #e5e7eb; background: white; cursor: pointer; font-size: 10px; font-weight: 600; transition: all 0.15s; white-space: nowrap; }
        .field-item button.edit { color: #3b82f6; border-color: #3b82f6; }
        .field-item button.edit:hover { background: #3b82f6; color: white; }
        .field-item button.delete { color: #ef4444; border-color: #ef4444; }
        .field-item button.delete:hover { background: #ef4444; color: white; }
        
        .export-section { margin-top: 20px; padding-top: 20px; border-top: 2px solid #e5e7eb; }
        .export-section h3 { font-size: 16px; margin-bottom: 12px; color: #111827; }
        .export-section textarea { width: 100%; height: 250px; padding: 12px; border: 1px solid #e5e7eb; border-radius: 8px; font-family: 'Courier New', monospace; font-size: 11px; resize: vertical; background: #f9fafb; }
        .export-section .btn-group { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-top: 10px; }
        .export-section button { width: 100%; padding: 12px; background: #3a64ff; color: white; border: none; border-radius: 8px; font-weight: 700; cursor: pointer; font-size: 14px; }
        .export-section button:hover { background: #2d50cc; }
        .export-section button.secondary { background: #10b981; }
        .export-section button.secondary:hover { background: #059669; }
        
        .instructions { background: #fffbeb; border: 1px solid #fde68a; padding: 16px; border-radius: 8px; margin-bottom: 20px; }
        .instructions h3 { font-size: 16px; color: #92400e; margin-bottom: 10px; }
        .instructions ol { margin-left: 20px; color: #78350f; line-height: 1.8; }
        .instructions ol li { margin: 4px 0; font-size: 14px; }
        .instructions strong { color: #92400e; }
        
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px; margin-bottom: 20px; }
        .stat-card { background: white; padding: 16px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.05); text-align: center; }
        .stat-card .value { font-size: 28px; font-weight: 800; color: #3a64ff; }
        .stat-card .label { font-size: 12px; color: #6b7280; margin-top: 4px; }
        
        @media (max-width: 1400px) {
            .workspace { grid-template-columns: 1fr; }
            .panel { max-height: 500px; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ“‹ PDF í•„ë“œ ë§¤í•‘ ë„êµ¬ (AcroFormìš©)</h1>
            <p class="subtitle">ë³´í—˜ê¸ˆ ì²­êµ¬ì„œì— ìë™ìœ¼ë¡œ ì…ë ¥ë  í•„ë“œë¥¼ í´ë¦­ìœ¼ë¡œ ê°„í¸í•˜ê²Œ ì„¤ì •í•˜ì„¸ìš”</p>
        </div>
        
        <div class="instructions">
            <h3>ğŸ¯ ì‚¬ìš© ë°©ë²•</h3>
            <ol>
                <li><strong>PDF ì—…ë¡œë“œ:</strong> ë³´í—˜ì‚¬ ì²­êµ¬ì„œ PDF íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”.</li>
                <li><strong>ë³´í—˜ì‚¬ í‚¤ ì…ë ¥:</strong> ì˜ë¬¸ ë³´í—˜ì‚¬ ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: HYUNDAI_MARINE, DB_INSURANCE).</li>
                <li><strong>ë¹ ë¥¸ í•„ë“œ ì¶”ê°€:</strong> ìš°ì¸¡ "ğŸ“¦ ì „ì²´" ë²„íŠ¼ìœ¼ë¡œ ëª¨ë“  í•„ë“œë¥¼ í•œë²ˆì— ì¶”ê°€í•˜ì„¸ìš”! ìë™ìœ¼ë¡œ ì²« í•„ë“œê°€ ë…¸ë€ìƒ‰(ëŒ€ê¸° ìƒíƒœ)ì´ ë©ë‹ˆë‹¤.</li>
                <li><strong>ë“œë˜ê·¸ë¡œ ì˜ì—­ ì„ íƒ:</strong> <strong style="color: #f59e0b;">ë…¸ë€ìƒ‰ í•„ë“œ</strong>ì— ë°”ë¡œ <strong style="color: #dc2626;">PDF ì…ë ¥ë€ì„ ë“œë˜ê·¸</strong>í•˜ì„¸ìš”! ì™„ë£Œë˜ë©´ ìë™ìœ¼ë¡œ ë‹¤ìŒ í•„ë“œê°€ ë…¸ë€ìƒ‰ì´ ë©ë‹ˆë‹¤.</li>
                <li><strong>í•„ë“œ ì„ íƒ:</strong> í•„ë“œ ì´ë¦„ì„ í´ë¦­í•˜ê±°ë‚˜ "ğŸ“ ì„¤ì •" ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í•´ë‹¹ í•„ë“œê°€ ë…¸ë€ìƒ‰(ëŒ€ê¸°)ì´ ë©ë‹ˆë‹¤.</li>
                <li><strong>ì¤‘ë³µ í•„ë“œ ì¶”ê°€:</strong> "ğŸ“‹ ë³µì œ" ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìë™ìœ¼ë¡œ ë³µì œë˜ê³  ë…¸ë€ìƒ‰ì´ ë©ë‹ˆë‹¤!</li>
                <li><strong>ì£¼ë¯¼ë²ˆí˜¸ ë“± ì—¬ëŸ¬ ì¹¸:</strong> ã…ã…ã…ã…ã…ã… ê°™ì´ ì¹¸ì´ ì—¬ëŸ¬ ê°œì¸ ê²½ìš°, <strong style="color: #dc2626;">ëª¨ë“  ì¹¸ì„ í¬í•¨í•´ì„œ ë“œë˜ê·¸</strong>í•˜ì„¸ìš”!</li>
                <li><strong>ì½”ë“œ ìƒì„±:</strong> ëª¨ë“  í•„ë“œë¥¼ ì„¤ì •í•˜ë©´ ìë™ìœ¼ë¡œ JavaScript ì½”ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤.</li>
            </ol>
        </div>
        
        <div class="stats">
            <div class="stat-card">
                <div class="value" id="stat-total">0</div>
                <div class="label">ì „ì²´ í•„ë“œ</div>
            </div>
            <div class="stat-card">
                <div class="value" id="stat-waiting">0</div>
                <div class="label">ëŒ€ê¸° ì¤‘</div>
            </div>
            <div class="stat-card">
                <div class="value" id="stat-complete">0</div>
                <div class="label">ì™„ë£Œ</div>
            </div>
        </div>
        
        <div class="tools">
            <label for="pdf-upload" style="background: #3a64ff; color: white; border-color: #3a64ff;">
                ğŸ“„ PDF ì—…ë¡œë“œ
                <input type="file" id="pdf-upload" accept="application/pdf">
            </label>
            
            <input type="text" id="carrier-key" placeholder="ë³´í—˜ì‚¬ í‚¤ (ì˜ˆ: HYUNDAI_MARINE)" />
            
            <select id="page-select" disabled>
                <option>í˜ì´ì§€ ì„ íƒ...</option>
            </select>
            
            <select id="scale-select">
                <option value="1">100%</option>
                <option value="1.5" selected>150%</option>
                <option value="2">200%</option>
            </select>
            
            <button id="undo-btn" disabled style="background: #f59e0b; color: white; border-color: #f59e0b;">â¬…ï¸ ì´ì „ ë‹¨ê³„ë¡œ</button>
            
            <button id="clear-all" disabled>ğŸ—‘ï¸ ì „ì²´ ì´ˆê¸°í™”</button>
        </div>
        
        <div class="workspace">
            <div class="canvas-wrapper">
                <div class="coord-display" id="coord-display" style="display: none;">
                    <div>Canvas: <span id="coord-canvas">X: 0, Y: 0</span></div>
                    <div>PDF: <span id="coord-pdf">X: 0, Y: 0</span></div>
                </div>
                <div class="canvas-container">
                    <canvas id="pdf-canvas"></canvas>
                    <div class="crosshair crosshair-h" id="crosshair-h" style="display: none;"></div>
                    <div class="crosshair crosshair-v" id="crosshair-v" style="display: none;"></div>
                </div>
            </div>
            
            <div class="panel">
                <h2>í•„ë“œ ì„¤ì •</h2>
                
                <div class="quick-fields">
                    <h3>âš¡ ë¹ ë¥¸ ì¶”ê°€ (í´ë¦­ í•œë²ˆì— ì—¬ëŸ¬ í•„ë“œ ì¶”ê°€)</h3>
                    <div class="quick-btn-grid">
                        <button class="quick-btn" onclick="addQuickFields('basic')">ê¸°ë³¸ ì •ë³´</button>
                        <button class="quick-btn" onclick="addQuickFields('subscriber')">ê³„ì•½ì</button>
                        <button class="quick-btn" onclick="addQuickFields('insured')">í”¼ë³´í—˜ì</button>
                        <button class="quick-btn" onclick="addQuickFields('address')">ì£¼ì†Œ</button>
                        <button class="quick-btn" onclick="addQuickFields('bank')">ê³„ì¢Œ</button>
                        <button class="quick-btn" onclick="addQuickFields('accident')">ì‚¬ê³ ì •ë³´</button>
                        <button class="quick-btn" onclick="addQuickFields('date')">ì²­êµ¬ì¼</button>
                        <button class="quick-btn" onclick="addQuickFields('all')">ğŸ“¦ ì „ì²´</button>
                    </div>
                </div>
                
                <div class="field-list" id="field-list">
                    <p style="text-align: center; color: #6b7280; padding: 20px;">ìœ„ "ë¹ ë¥¸ ì¶”ê°€" ë²„íŠ¼ì„ ëˆŒëŸ¬ í•„ë“œë¥¼ ì¶”ê°€í•˜ì„¸ìš”</p>
                </div>
                
                <div class="export-section">
                    <h3>ğŸ“¤ ìƒì„±ëœ ì½”ë“œ</h3>
                    <textarea id="export-code" readonly placeholder="í•„ë“œ ì¢Œí‘œë¥¼ ì„¤ì •í•˜ë©´ ìë™ìœ¼ë¡œ ì½”ë“œê°€ ìƒì„±ë©ë‹ˆë‹¤..."></textarea>
                    <div class="btn-group">
                        <button onclick="copyCode()">ğŸ“‹ ì½”ë“œ ë³µì‚¬</button>
                        <button class="secondary" onclick="downloadScript()">ğŸ’¾ ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ì €ì¥</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

        let pdfDoc = null;
        let currentPage = 1;
        let scale = 1.5;
        let waitingFieldIndex = -1;
        let fields = [];
        let fileName = '';
        let lastSetFieldIndex = -1; // Undoìš©: ê°€ì¥ ìµœê·¼ì— ì„¤ì •í•œ í•„ë“œ
        
        // ë“œë˜ê·¸ ê´€ë ¨ ë³€ìˆ˜
        let isDragging = false;
        let dragStartX = 0;
        let dragStartY = 0;
        
        // PDF í˜ì´ì§€ ì›ë³¸ ë†’ì´ (ì¢Œí‘œ ë³€í™˜ìš©)
        let pdfPageHeight = 0;

        const canvas = document.getElementById('pdf-canvas');
        const ctx = canvas.getContext('2d');

        // ============== ë¹ ë¥¸ í•„ë“œ ì •ì˜ ==============
        const QUICK_FIELD_SETS = {
            basic: [
                { name: 'ins_name', label: 'í”¼ë³´í—˜ì ì´ë¦„', type: 'text', width: 200, height: 30, fontSize: 12 },
                { name: 'sub_name', label: 'ê³„ì•½ì ì´ë¦„', type: 'text', width: 200, height: 30, fontSize: 12 },
            ],
            subscriber: [
                { name: 'sub_name', label: 'ê³„ì•½ì ì´ë¦„', type: 'text', width: 200, height: 30, fontSize: 12 },
                { name: 'sub_rrn1', label: 'ê³„ì•½ì ì£¼ë¯¼ë²ˆí˜¸ ì• (6ì¹¸ í†µí•©)', type: 'text', width: 120, height: 25, fontSize: 12 },
                { name: 'sub_rrn2', label: 'ê³„ì•½ì ì£¼ë¯¼ë²ˆí˜¸ ë’¤ (7ì¹¸ í†µí•©)', type: 'text', width: 140, height: 25, fontSize: 12 },
                { name: 'sub_full_phone', label: 'ê³„ì•½ì ì „í™”ë²ˆí˜¸ (í†µí•©)', type: 'text', width: 180, height: 25, fontSize: 11 },
            ],
            insured: [
                { name: 'ins_name', label: 'í”¼ë³´í—˜ì ì´ë¦„', type: 'text', width: 200, height: 30, fontSize: 12 },
                { name: 'ins_rrn1', label: 'í”¼ë³´í—˜ì ì£¼ë¯¼ë²ˆí˜¸ ì• (6ì¹¸ í†µí•©)', type: 'text', width: 120, height: 25, fontSize: 12 },
                { name: 'ins_rrn2', label: 'í”¼ë³´í—˜ì ì£¼ë¯¼ë²ˆí˜¸ ë’¤ (7ì¹¸ í†µí•©)', type: 'text', width: 140, height: 25, fontSize: 12 },
                { name: 'ins_full_phone', label: 'í”¼ë³´í—˜ì ì „í™”ë²ˆí˜¸ (í†µí•©)', type: 'text', width: 180, height: 25, fontSize: 11 },
            ],
            address: [
                { name: 'zip', label: 'ìš°í¸ë²ˆí˜¸', type: 'text', width: 80, height: 30, fontSize: 11 },
                { name: 'addr', label: 'ë„ë¡œëª…ì£¼ì†Œ', type: 'text', width: 400, height: 30, fontSize: 10 },
                { name: 'addr_detail', label: 'ìƒì„¸ì£¼ì†Œ', type: 'text', width: 400, height: 30, fontSize: 10 },
            ],
            bank: [
                { name: 'bank_name', label: 'ì€í–‰ëª…', type: 'text', width: 150, height: 30, fontSize: 11 },
                { name: 'bank_account', label: 'ê³„ì¢Œë²ˆí˜¸', type: 'text', width: 200, height: 30, fontSize: 11 },
                { name: 'bank_depositor', label: 'ì˜ˆê¸ˆì£¼', type: 'text', width: 150, height: 30, fontSize: 11 },
            ],
            accident: [
                { name: 'accident_date', label: 'ì‚¬ê³ ì¼/ë°œë³‘ì¼', type: 'text', width: 150, height: 30, fontSize: 11 },
                { name: 'diagnosis', label: 'ì§„ë‹¨ëª…', type: 'text', width: 300, height: 30, fontSize: 11 },
                { name: 'hospital_name', label: 'ë³‘ì›ëª…', type: 'text', width: 250, height: 30, fontSize: 11 },
                { name: 'accident_detail', label: 'ì‚¬ê³  ê²½ìœ„', type: 'text', width: 350, height: 40, fontSize: 10 },
            ],
            date: [
                { name: 'date_y_full', label: 'ì²­êµ¬ì¼ ì—°ë„(4ì)', type: 'text', width: 50, height: 25, fontSize: 11 },
                { name: 'date_y_short', label: 'ì²­êµ¬ì¼ ì—°ë„(2ì)', type: 'text', width: 35, height: 25, fontSize: 11 },
                { name: 'date_m', label: 'ì²­êµ¬ì¼ ì›”', type: 'text', width: 35, height: 25, fontSize: 11 },
                { name: 'date_d', label: 'ì²­êµ¬ì¼ ì¼', type: 'text', width: 35, height: 25, fontSize: 11 },
            ],
            all: [] // ì•„ë˜ì—ì„œ ì¡°í•©
        };

        // 'all'ì€ ëª¨ë“  í•„ë“œ ì¡°í•©
        QUICK_FIELD_SETS.all = [
            ...QUICK_FIELD_SETS.insured,
            ...QUICK_FIELD_SETS.subscriber,
            ...QUICK_FIELD_SETS.address,
            ...QUICK_FIELD_SETS.bank,
            ...QUICK_FIELD_SETS.accident,
            ...QUICK_FIELD_SETS.date,
            { name: 'employer_job', label: 'ì§ì¥/ì§ë¬´', type: 'text', width: 250, height: 30, fontSize: 11 },
            
            // ë³´í—˜ê¸ˆ ì²˜ë¦¬ì•ˆë‚´ - ì•ˆë‚´ëŒ€ìƒ
            { name: 'guide_target_insured', label: 'ì•ˆë‚´ëŒ€ìƒ: í”¼ë³´í—˜ì', type: 'checkbox', width: 15, height: 15 },
            { name: 'guide_target_subscriber', label: 'ì•ˆë‚´ëŒ€ìƒ: ê³„ì•½ì', type: 'checkbox', width: 15, height: 15 },
            { name: 'guide_target_other', label: 'ì•ˆë‚´ëŒ€ìƒ: ê¸°íƒ€', type: 'checkbox', width: 15, height: 15 },
            
            // ë³´í—˜ê¸ˆ ì²˜ë¦¬ì•ˆë‚´ - ì•ˆë‚´ë°©ë²•
            { name: 'guide_method_sms', label: 'ì•ˆë‚´ë°©ë²•: ë¬¸ì (ê¸°ë³¸)', type: 'checkbox', width: 15, height: 15 },
            { name: 'guide_method_phone', label: 'ì•ˆë‚´ë°©ë²•: ì „í™”', type: 'checkbox', width: 15, height: 15 },
            { name: 'guide_method_mail', label: 'ì•ˆë‚´ë°©ë²•: ìš°í¸', type: 'checkbox', width: 15, height: 15 },
            { name: 'guide_method_email', label: 'ì•ˆë‚´ë°©ë²•: E-MAIL', type: 'checkbox', width: 15, height: 15 },
            { name: 'guide_method_refuse', label: 'ì•ˆë‚´ë°©ë²•: ê±°ë¶€', type: 'checkbox', width: 15, height: 15 },
            
            // í”Œë˜ë„ˆ ë¬¸ìì•ˆë‚´
            { name: 'planner_sms_yes', label: 'í”Œë˜ë„ˆ ë¬¸ìì•ˆë‚´: ì˜ˆ', type: 'checkbox', width: 15, height: 15 },
            { name: 'planner_sms_no', label: 'í”Œë˜ë„ˆ ë¬¸ìì•ˆë‚´: ì•„ë‹ˆì˜¤', type: 'checkbox', width: 15, height: 15 },
            
            // ì²­êµ¬ì‚¬í•­
            { name: 'claim_type_sickness', label: 'ì²­êµ¬: ì§ˆë³‘', type: 'checkbox', width: 15, height: 15 },
            { name: 'claim_type_injury', label: 'ì²­êµ¬: ìƒí•´', type: 'checkbox', width: 15, height: 15 },
            { name: 'claim_detail_hospital', label: 'ì¹˜ë£Œí˜•íƒœ: ì…ì›', type: 'checkbox', width: 15, height: 15 },
            { name: 'claim_detail_outpatient', label: 'ì¹˜ë£Œí˜•íƒœ: í†µì›', type: 'checkbox', width: 15, height: 15 },
            
            // ì²­êµ¬í•­ëª© (ì²­êµ¬ ë‹´ë³´) - ì¤‘ë³µ ì²´í¬ ê°€ëŠ¥
            { name: 'claim_item_actual_medical', label: 'ì²­êµ¬í•­ëª©: ì‹¤ì†ì˜ë£Œë¹„', type: 'checkbox', width: 15, height: 15 },
            { name: 'claim_item_daily_allowance', label: 'ì²­êµ¬í•­ëª©: ì…ì›ì¼ë‹¹', type: 'checkbox', width: 15, height: 15 },
            { name: 'claim_item_diagnosis', label: 'ì²­êµ¬í•­ëª©: ì§„ë‹¨ë¹„', type: 'checkbox', width: 15, height: 15 },
            { name: 'claim_item_surgery', label: 'ì²­êµ¬í•­ëª©: ìˆ˜ìˆ ë¹„', type: 'checkbox', width: 15, height: 15 },
            { name: 'claim_item_disability', label: 'ì²­êµ¬í•­ëª©: í›„ìœ ì¥í•´', type: 'checkbox', width: 15, height: 15 },
            { name: 'claim_item_death', label: 'ì²­êµ¬í•­ëª©: ì‚¬ë§', type: 'checkbox', width: 15, height: 15 },
            { name: 'claim_item_other', label: 'ì²­êµ¬í•­ëª©: ê¸°íƒ€', type: 'checkbox', width: 15, height: 15 },
            
            // ì„œëª… (ì´ë¯¸ì§€ ë°°ì¹˜ìš© ì¢Œí‘œ)
            { name: 'signature_beneficiary', label: 'ì„œëª…: ë³´í—˜ê¸ˆ ìˆ˜ë ¹ì¸', type: 'signature', width: 80, height: 40 },
            { name: 'signature_claimant', label: 'ì„œëª…: ì²­êµ¬ì¸', type: 'signature', width: 80, height: 40 },
        ];

        // ============== ë¹ ë¥¸ í•„ë“œ ì¶”ê°€ ==============
        window.addQuickFields = function(setName) {
            const set = QUICK_FIELD_SETS[setName];
            if (!set) return;
            
            // ì¤‘ë³µ ì²´í¬
            const existingNames = new Set(fields.map(f => f.name));
            const newFields = set.filter(f => !existingNames.has(f.name));
            
            if (newFields.length === 0) {
                alert('ì„ íƒí•œ í•„ë“œë“¤ì´ ì´ë¯¸ ëª¨ë‘ ì¶”ê°€ë˜ì–´ ìˆìŠµë‹ˆë‹¤.');
                return;
            }
            
            newFields.forEach(fieldDef => {
                fields.push({
                    ...fieldDef,
                    x: null,
                    y: null,
                    pdfX: null,
                    pdfY: null,
                    page: null
                });
            });
            
            // ì²« ë²ˆì§¸ ë¯¸ì™„ë£Œ í•„ë“œë¥¼ ìë™ìœ¼ë¡œ ëŒ€ê¸° ìƒíƒœë¡œ
            if (waitingFieldIndex === -1) {
                const firstWaiting = fields.findIndex(f => f.pdfX === null);
                if (firstWaiting !== -1) {
                    waitingFieldIndex = firstWaiting;
                }
            }
            
            updateFieldList();
            updateStats();
            
            alert(`âœ… ${newFields.length}ê°œ í•„ë“œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.\në…¸ë€ìƒ‰ í•„ë“œì— ë°”ë¡œ PDFì—ì„œ ë“œë˜ê·¸í•˜ì„¸ìš”!`);
        };

        // ============== PDF ì—…ë¡œë“œ ==============
        document.getElementById('pdf-upload').addEventListener('change', async (e) => {
            const file = e.target.files[0];
            if (!file) return;

            fileName = file.name;
            const fileReader = new FileReader();
            
            fileReader.onload = async (event) => {
                const typedArray = new Uint8Array(event.target.result);
                pdfDoc = await pdfjsLib.getDocument(typedArray).promise;
                
                // í˜ì´ì§€ ì„ íƒ í™œì„±í™”
                const pageSelect = document.getElementById('page-select');
                pageSelect.disabled = false;
                pageSelect.innerHTML = '';
                for (let i = 1; i <= pdfDoc.numPages; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `í˜ì´ì§€ ${i}`;
                    pageSelect.appendChild(option);
                }
                
                document.getElementById('clear-all').disabled = false;
                
                renderPage(currentPage);
            };
            
            fileReader.readAsArrayBuffer(file);
        });

        // ============== í˜ì´ì§€/ìŠ¤ì¼€ì¼ ë³€ê²½ ==============
        document.getElementById('page-select').addEventListener('change', (e) => {
            currentPage = parseInt(e.target.value);
            renderPage(currentPage);
        });

        document.getElementById('scale-select').addEventListener('change', (e) => {
            scale = parseFloat(e.target.value);
            renderPage(currentPage);
        });

        // ============== PDF ë Œë”ë§ ==============
        async function renderPage(pageNum) {
            if (!pdfDoc) return;
            
            const page = await pdfDoc.getPage(pageNum);
            const viewport = page.getViewport({ scale });
            
            // PDF ì›ë³¸ í˜ì´ì§€ ë†’ì´ ì €ì¥ (scale=1.0 ê¸°ì¤€)
            const originalViewport = page.getViewport({ scale: 1.0 });
            pdfPageHeight = originalViewport.height;
            
            canvas.width = viewport.width;
            canvas.height = viewport.height;
            
            const renderContext = {
                canvasContext: ctx,
                viewport: viewport
            };
            
            await page.render(renderContext).promise;
            drawMarkers();
        }

        // ============== ë§ˆì»¤ ê·¸ë¦¬ê¸° ==============
        function drawMarkers() {
            document.querySelectorAll('.marker').forEach(m => m.remove());
            document.querySelectorAll('.field-rect').forEach(r => r.remove());
            
            fields.forEach((field, idx) => {
                if (field.x !== null && field.y !== null && field.page === currentPage) {
                    // í•„ë“œ ì‚¬ê°í˜• í‘œì‹œ
                    const fieldRect = document.createElement('div');
                    fieldRect.className = 'field-rect';
                    fieldRect.style.position = 'absolute';
                    fieldRect.style.left = field.x + 'px';
                    fieldRect.style.top = field.y + 'px';
                    fieldRect.style.width = (field.width * scale) + 'px';
                    fieldRect.style.height = (field.height * scale) + 'px';
                    fieldRect.style.border = '2px solid #10b981';
                    fieldRect.style.background = 'rgba(16, 185, 129, 0.1)';
                    fieldRect.style.pointerEvents = 'none';
                    fieldRect.style.zIndex = '15';
                    
                    document.querySelector('.canvas-container').appendChild(fieldRect);
                    
                    // ë§ˆì»¤ ì  (ì™¼ìª½ ìƒë‹¨)
                    const marker = document.createElement('div');
                    marker.className = 'marker';
                    marker.style.left = field.x + 'px';
                    marker.style.top = field.y + 'px';
                    
                    marker.innerHTML = `
                        <div class="marker-dot"></div>
                        <div class="marker-label">${idx + 1}. ${field.label}</div>
                    `;
                    
                    document.querySelector('.canvas-container').appendChild(marker);
                }
            });
        }

        canvas.addEventListener('mouseleave', () => {
            document.getElementById('crosshair-h').style.display = 'none';
            document.getElementById('crosshair-v').style.display = 'none';
            document.getElementById('coord-display').style.display = 'none';
            
            // ë“œë˜ê·¸ ì¤‘ë‹¨
            if (isDragging) {
                isDragging = false;
                const oldRect = document.querySelector('.drag-rect');
                if (oldRect) oldRect.remove();
            }
        });

        // ============== ìº”ë²„ìŠ¤ ë“œë˜ê·¸ (ì‹œì‘) ==============
        canvas.addEventListener('mousedown', (e) => {
            if (waitingFieldIndex === -1) {
                alert('ë¨¼ì € í•„ë“œ ëª©ë¡ì—ì„œ ë…¸ë€ìƒ‰ í•„ë“œë¥¼ í´ë¦­í•˜ì„¸ìš”!');
                return;
            }
            
            isDragging = true;
            const rect = canvas.getBoundingClientRect();
            dragStartX = e.clientX - rect.left;
            dragStartY = e.clientY - rect.top;
            
            // ê¸°ì¡´ ë“œë˜ê·¸ ì‚¬ê°í˜• ì œê±°
            const oldRect = document.querySelector('.drag-rect');
            if (oldRect) oldRect.remove();
        });
        
        // ============== ìº”ë²„ìŠ¤ ë“œë˜ê·¸ (ì§„í–‰ ì¤‘) ==============
        canvas.addEventListener('mousemove', (e) => {
            if (!pdfDoc) return;
            
            const rect = canvas.getBoundingClientRect();
            const canvasX = Math.round(e.clientX - rect.left);
            const canvasY = Math.round(e.clientY - rect.top);
            const pdfX = Math.round(canvasX / scale);
            const pdfY = Math.round(pdfPageHeight - (canvasY / scale));
            
            // ì¢Œí‘œ í‘œì‹œ
            document.getElementById('crosshair-h').style.top = canvasY + 'px';
            document.getElementById('crosshair-h').style.display = 'block';
            document.getElementById('crosshair-v').style.left = canvasX + 'px';
            document.getElementById('crosshair-v').style.display = 'block';
            
            document.getElementById('coord-canvas').textContent = `X: ${canvasX}, Y: ${canvasY}`;
            document.getElementById('coord-pdf').textContent = `X: ${pdfX}, Y: ${pdfY}`;
            document.getElementById('coord-display').style.display = 'block';
            
            // ë“œë˜ê·¸ ì¤‘ì´ë©´ ì‚¬ê°í˜• í‘œì‹œ
            if (isDragging) {
                const oldRect = document.querySelector('.drag-rect');
                if (oldRect) oldRect.remove();
                
                const x = Math.min(dragStartX, canvasX);
                const y = Math.min(dragStartY, canvasY);
                const width = Math.abs(canvasX - dragStartX);
                const height = Math.abs(canvasY - dragStartY);
                
                const dragRect = document.createElement('div');
                dragRect.className = 'drag-rect';
                dragRect.style.left = x + 'px';
                dragRect.style.top = y + 'px';
                dragRect.style.width = width + 'px';
                dragRect.style.height = height + 'px';
                
                document.querySelector('.canvas-container').appendChild(dragRect);
            }
        });
        
        // ============== ìº”ë²„ìŠ¤ ë“œë˜ê·¸ (ì¢…ë£Œ) ==============
        canvas.addEventListener('mouseup', (e) => {
            if (!isDragging || waitingFieldIndex === -1) {
                isDragging = false;
                return;
            }
            
            const rect = canvas.getBoundingClientRect();
            const endX = e.clientX - rect.left;
            const endY = e.clientY - rect.top;
            
            // ìµœì†Œ í¬ê¸° ì²´í¬ (ì‹¤ìˆ˜ë¡œ í´ë¦­ë§Œ í•œ ê²½ìš°)
            const width = Math.abs(endX - dragStartX);
            const height = Math.abs(endY - dragStartY);
            
            if (width < 10 || height < 10) {
                alert('ì˜ì—­ì´ ë„ˆë¬´ ì‘ìŠµë‹ˆë‹¤. ì…ë ¥ë€ ì „ì²´ë¥¼ ë“œë˜ê·¸í•´ì£¼ì„¸ìš”!');
                isDragging = false;
                const oldRect = document.querySelector('.drag-rect');
                if (oldRect) oldRect.remove();
                return;
            }
            
            // ì¢Œí‘œ ê³„ì‚° (í•­ìƒ ì™¼ìª½ ìƒë‹¨ì´ ì‹œì‘ì )
            const x = Math.min(dragStartX, endX);
            const y = Math.min(dragStartY, endY);
            const pdfX = Math.round(x / scale);
            const pdfY = Math.round(pdfPageHeight - (y / scale));
            const pdfWidth = Math.round(width / scale);
            const pdfHeight = Math.round(height / scale);
            
            // í•„ë“œì— ì €ì¥
            fields[waitingFieldIndex].x = x;
            fields[waitingFieldIndex].y = y;
            fields[waitingFieldIndex].pdfX = pdfX;
            fields[waitingFieldIndex].pdfY = pdfY;
            fields[waitingFieldIndex].width = pdfWidth;
            fields[waitingFieldIndex].height = pdfHeight;
            fields[waitingFieldIndex].page = currentPage;
            
            // Undoìš©: ê°€ì¥ ìµœê·¼ì— ì„¤ì •í•œ í•„ë“œ ì €ì¥
            lastSetFieldIndex = waitingFieldIndex;
            document.getElementById('undo-btn').disabled = false;
            
            // ë“œë˜ê·¸ ì‚¬ê°í˜• ì œê±°
            const oldRect = document.querySelector('.drag-rect');
            if (oldRect) oldRect.remove();
            
            // ë‹¤ìŒ ëŒ€ê¸° í•„ë“œ ìë™ ì„ íƒ
            isDragging = false;
            waitingFieldIndex = -1;
            const nextWaitingIdx = fields.findIndex(f => f.pdfX === null);
            if (nextWaitingIdx !== -1) {
                waitingFieldIndex = nextWaitingIdx;
            }
            
            updateFieldList();
            updateStats();
            updateExportCode();
            drawMarkers();
        });

        // ============== í•„ë“œ ëª©ë¡ ì—…ë°ì´íŠ¸ ==============
        function updateFieldList() {
            const container = document.getElementById('field-list');
            
            if (fields.length === 0) {
                container.innerHTML = '<p style="text-align: center; color: #6b7280; padding: 20px;">ìœ„ "ë¹ ë¥¸ ì¶”ê°€" ë²„íŠ¼ì„ ëˆŒëŸ¬ í•„ë“œë¥¼ ì¶”ê°€í•˜ì„¸ìš”</p>';
                return;
            }
            
            container.innerHTML = '';
            fields.forEach((field, idx) => {
                const isWaiting = idx === waitingFieldIndex;
                const isComplete = field.pdfX !== null;
                
                const item = document.createElement('div');
                item.className = 'field-item';
                if (isWaiting) item.classList.add('waiting');
                if (isComplete) item.classList.add('complete');
                
                const status = isComplete ? 
                    `P${field.page} (${field.pdfX}, ${field.pdfY}) ${field.width}Ã—${field.height}` : 
                    isWaiting ? 'ğŸ–±ï¸ ë“œë˜ê·¸ë¡œ ì˜ì—­ ì„ íƒ...' : 'ëŒ€ê¸°';
                
                const btnText = isComplete ? 'ğŸ“ ì¬ì„¤ì •' : 'ğŸ“ ì„¤ì •';
                item.innerHTML = `
                    <div class="index">${idx + 1}</div>
                    <div class="info" style="cursor: pointer;" onclick="setWaitingField(${idx})">
                        <div class="name">${field.label} [${field.type}]</div>
                        <div class="coords">${status}</div>
                    </div>
                    <button class="edit" onclick="setWaitingField(${idx})">${btnText}</button>
                    <button class="edit" onclick="duplicateField(${idx})" style="background: #6366f1; border-color: #6366f1;">ğŸ“‹ ë³µì œ</button>
                    <button class="delete" onclick="deleteField(${idx})">ğŸ—‘ï¸</button>
                `;
                
                container.appendChild(item);
            });
        }

        window.setWaitingField = function(idx) {
            waitingFieldIndex = idx;
            updateFieldList();
        };

        window.duplicateField = function(idx) {
            const originalField = fields[idx];
            if (!originalField) return;
            
            // ê°™ì€ ì´ë¦„ì˜ í•„ë“œê°€ ëª‡ ê°œë‚˜ ìˆëŠ”ì§€ í™•ì¸
            const sameName = fields.filter(f => f.name.startsWith(originalField.name.split('_').slice(0, -1).join('_') || originalField.name));
            const count = sameName.length + 1;
            
            // ìƒˆ í•„ë“œëª… ìƒì„±
            let newName = originalField.name;
            let newLabel = originalField.label;
            
            // _ìˆ«ìê°€ ì´ë¯¸ ìˆìœ¼ë©´ ì¦ê°€, ì—†ìœ¼ë©´ _2 ì¶”ê°€
            if (/_\d+$/.test(originalField.name)) {
                const baseName = originalField.name.replace(/_\d+$/, '');
                const baseLabel = originalField.label.replace(/\s*\(\d+\)$/, '').replace(/\s*\d+$/, '');
                const existingNumbers = fields
                    .filter(f => f.name.startsWith(baseName))
                    .map(f => {
                        const match = f.name.match(/_(\d+)$/);
                        return match ? parseInt(match[1]) : 1;
                    });
                const nextNumber = Math.max(...existingNumbers, 1) + 1;
                newName = `${baseName}_${nextNumber}`;
                newLabel = `${baseLabel} (${nextNumber})`;
            } else {
                newName = `${originalField.name}_2`;
                newLabel = `${originalField.label} (2)`;
            }
            
            // í•„ë“œ ë³µì œ
            const newField = {
                name: newName,
                label: newLabel,
                type: originalField.type,
                width: originalField.width,
                height: originalField.height,
                fontSize: originalField.fontSize,
                x: null,
                y: null,
                pdfX: null,
                pdfY: null,
                page: null
            };
            
            fields.push(newField);
            
            // ğŸ¯ ë³µì œëœ í•„ë“œë¥¼ ìë™ìœ¼ë¡œ ëŒ€ê¸° ìƒíƒœë¡œ!
            waitingFieldIndex = fields.length - 1;
            
            updateFieldList();
            updateStats();
            updateExportCode();
            
            alert(`âœ… "${newLabel}" í•„ë“œê°€ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤!\në…¸ë€ìƒ‰ìœ¼ë¡œ ë°”ë¡œ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤. PDFì—ì„œ ë“œë˜ê·¸í•˜ì„¸ìš”!`);
        };

        window.deleteField = function(idx) {
            fields.splice(idx, 1);
            if (waitingFieldIndex === idx) waitingFieldIndex = -1;
            else if (waitingFieldIndex > idx) waitingFieldIndex--;
            updateFieldList();
            updateStats();
            updateExportCode();
            drawMarkers();
        };

        // ============== í†µê³„ ì—…ë°ì´íŠ¸ ==============
        function updateStats() {
            const total = fields.length;
            const complete = fields.filter(f => f.pdfX !== null).length;
            const waiting = total - complete;
            
            document.getElementById('stat-total').textContent = total;
            document.getElementById('stat-waiting').textContent = waiting;
            document.getElementById('stat-complete').textContent = complete;
        }

        // ============== ì½”ë“œ ìƒì„± ==============
        function updateExportCode() {
            const carrierKey = document.getElementById('carrier-key').value.trim() || 'CARRIER_KEY';
            const completeFields = fields.filter(f => f.pdfX !== null);
            
            if (completeFields.length === 0) {
                document.getElementById('export-code').value = '// í•„ë“œ ì¢Œí‘œë¥¼ ì„¤ì •í•˜ì„¸ìš”';
                return;
            }
            
            const fieldLines = completeFields.map((f, idx) => {
                const typeComment = f.type === 'checkbox' ? ' // ì²´í¬ë°•ìŠ¤' : f.type === 'radio' ? ' // ë¼ë””ì˜¤' : '';
                return `      { name: '${f.name}', type: '${f.type}', page: ${f.page - 1}, x: ${f.pdfX}, y: ${f.pdfY}, width: ${f.width}, height: ${f.height}, fontSize: ${f.fontSize || 11} }${typeComment}`;
            }).join(',\n');
            
            const code = `// ${carrierKey} AcroForm í•„ë“œ ì •ì˜
// íŒŒì¼: ${fileName}
// ìƒì„±ì¼: ${new Date().toLocaleString('ko-KR')}

const FIELD_DEFINITIONS = {
  ${carrierKey}: {
    inputFile: 'assets/pdf-templates/${carrierKey}-template.pdf',
    outputFile: 'assets/pdf-templates/${carrierKey}-template-acroform.pdf',
    fields: [
${fieldLines}
    ]
  }
};

// create-acroform-template.js ìŠ¤í¬ë¦½íŠ¸ì— ìœ„ ì½”ë“œë¥¼ ì¶”ê°€í•˜ì„¸ìš”!`;
            
            document.getElementById('export-code').value = code;
        }

        // ============== ì½”ë“œ ë³µì‚¬ ==============
        window.copyCode = function() {
            const textarea = document.getElementById('export-code');
            textarea.select();
            document.execCommand('copy');
            
            alert('âœ… ì½”ë“œê°€ í´ë¦½ë³´ë“œì— ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!');
        };

        // ============== ìŠ¤í¬ë¦½íŠ¸ íŒŒì¼ ë‹¤ìš´ë¡œë“œ ==============
        window.downloadScript = function() {
            const carrierKey = document.getElementById('carrier-key').value.trim() || 'CARRIER_KEY';
            const code = document.getElementById('export-code').value;
            
            const blob = new Blob([code], { type: 'text/javascript' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `${carrierKey}-fields.js`;
            a.click();
            URL.revokeObjectURL(url);
            
            alert(`âœ… ${carrierKey}-fields.js íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!`);
        };

        // ============== Undo (ì´ì „ ë‹¨ê³„ë¡œ) ==============
        document.getElementById('undo-btn').addEventListener('click', () => {
            if (lastSetFieldIndex === -1 || !fields[lastSetFieldIndex]) {
                alert('ë˜ëŒë¦´ í•„ë“œê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ê°€ì¥ ìµœê·¼ì— ì„¤ì •í•œ í•„ë“œë¥¼ ë¯¸ì„¤ì • ìƒíƒœë¡œ ë˜ëŒë¦¼
            fields[lastSetFieldIndex].x = null;
            fields[lastSetFieldIndex].y = null;
            fields[lastSetFieldIndex].pdfX = null;
            fields[lastSetFieldIndex].pdfY = null;
            fields[lastSetFieldIndex].page = null;
            
            // ğŸ¯ í•´ë‹¹ í•„ë“œë¥¼ ìë™ìœ¼ë¡œ ëŒ€ê¸° ìƒíƒœë¡œ!
            waitingFieldIndex = lastSetFieldIndex;
            lastSetFieldIndex = -1;
            document.getElementById('undo-btn').disabled = true;
            
            updateFieldList();
            updateStats();
            updateExportCode();
            drawMarkers();
            
            // alert ì œê±° - ìë™ìœ¼ë¡œ ëŒ€ê¸° ì¤‘ì´ë¯€ë¡œ ë°”ë¡œ ë“œë˜ê·¸ ê°€ëŠ¥
        });

        // ============== ì´ˆê¸°í™” ==============
        document.getElementById('clear-all').addEventListener('click', () => {
            if (!confirm('ëª¨ë“  í•„ë“œë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) return;
            
            fields = [];
            waitingFieldIndex = -1;
            lastSetFieldIndex = -1;
            document.getElementById('undo-btn').disabled = true;
            
            // localStorageë„ ì‚­ì œ (ì™„ì „ ì´ˆê¸°í™”)
            localStorage.removeItem('pdf-field-mapper-fields');
            localStorage.removeItem('pdf-field-mapper-carrierKey');
            
            updateFieldList();
            updateStats();
            updateExportCode();
            drawMarkers();
            
            alert('âœ… ì™„ì „íˆ ì´ˆê¸°í™”ë˜ì—ˆìŠµë‹ˆë‹¤!');
        });

        // ============== ì´ˆê¸° ìƒíƒœ ==============
        updateFieldList();
        updateStats();
        updateExportCode();
    </script>
</body>
</html>

