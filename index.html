<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>청구닷컴 | 보험금 청구 허브</title>
  <meta name="description" content="전산 접속 · 필요서류 · 보험금 청구서 PDF · 치과치료확인서 · 홈페이지 · 고객센터 · 인콜 모니터링 · 보험금청구 FAX · 보험나이 · 실손 계산기" />
  <meta name="format-detection" content="telephone=no" />
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    :root{--ring:#e2e8f0}
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial;background:#f8fafc}
    .section{margin-top:36px}
    .section h2{font-weight:900;font-size:28px;letter-spacing:-.01em;text-align:center}
    .section p{margin-top:6px;color:#475569;font-size:12.5px;text-align:center}
    .sep{height:1px;background:#e2e8f0;margin:18px auto;border-radius:999px;max-width:980px}
    .tbl{background:#fff;border:1px solid #e2e8f0;border-radius:14px;overflow:hidden}
    .row{display:grid;grid-template-columns:220px 1fr;align-items:center;gap:8px;padding:10px;border-top:1px solid rgba(100,116,139,.25)}
    .row:first-child{border-top:0}
    .brand{display:flex;justify-content:center;align-items:center}
    .logo{max-height:26px;width:auto;object-fit:contain}
    .vh{position:absolute;width:1px;height:1px;margin:-1px;overflow:hidden;clip:rect(0,0,0,0)}
    .btn{min-height:30px;padding:6px 10px;font-size:12px;border-radius:8px;border:1px solid #e2e8f0;background:#fff}
    .btn:hover{background:#f1f5f9}
    .btn-muted{opacity:.55;cursor:not-allowed}
    .btn-primary{background:#7c3aed;border-color:#7c3aed;color:#fff}
    .btn-pdf{background:#0ea5e9;border-color:#0ea5e9;color:#fff;padding:6px 12px}
    .btn-green{background:#10b981;border-color:#10b981;color:#fff;padding:6px 12px}
    .card{background:#fff;border:1px solid #e2e8f0;border-radius:12px}
    .wrap-narrow{max-width:760px;margin:0 auto}
  </style>
</head>
<body class="text-slate-900">
  <!-- 헤더 -->
  <header class="max-w-6xl mx-auto px-5 py-5 flex items-center gap-3">
    <a href="/" class="text-xl font-extrabold">청구닷컴</a>
    <nav class="ml-auto flex items-center gap-2">
      <a class="btn" href="#loss">손해보험사</a>
      <a class="btn" href="#life">생명보험사</a>
      <a class="btn" href="#medical">실손 계산기</a>
    </nav>
  </header>

  <!-- 히어로 + 검색 -->
  <section class="max-w-6xl mx-auto px-5">
    <h1 class="text-center text-3xl sm:text-4xl font-black">
      보험금 청구 링크, <span class="bg-gradient-to-r from-fuchsia-500 via-violet-600 to-cyan-500 bg-clip-text text-transparent">한 곳에서</span>
    </h1>
    <p class="text-center text-slate-700 mt-2">전산·서류·PDF·치확·홈페이지·고객센터·인콜·청구FAX</p>
    <div class="mt-5 card p-4 max-w-4xl mx-auto">
      <label class="text-sm font-semibold">검색</label>
      <div class="mt-2 grid sm:grid-cols-[1fr_auto_auto] gap-2 items-center">
        <input id="q" type="search" class="w-full border border-slate-300 rounded-xl px-4 py-2.5" placeholder="회사명·키워드 (예: 삼성화재, 고객센터, PDF, FAX)">
        <button id="q-clear" class="btn" type="button">지우기</button>
        <a class="btn" href="#loss">손해부터 보기</a>
      </div>
      <div class="mt-2 text-center text-xs text-slate-600">단축키: <kbd class="btn">/</kbd> 검색 · <kbd class="btn">Esc</kbd> 지우기</div>
    </div>
  </section>

  <main class="max-w-6xl mx-auto px-5 pb-24">
    <!-- 손해보험사 -->
    <section id="loss" class="section">
      <h2>손해보험사</h2>
      <p>콤팩트 표. 비어있는 항목은 비활성 버튼으로 표시됩니다.</p>
      <div class="sep"></div>
      <div id="loss-list" class="tbl"></div>
    </section>

    <!-- 생명보험사 -->
    <section id="life" class="section">
      <h2>생명보험사</h2>
      <p>콤팩트 표. 비어있는 항목은 비활성 버튼으로 표시됩니다.</p>
      <div class="sep"></div>
      <div id="life-list" class="tbl"></div>
    </section>

    <!-- 실손의료비 계산기 (요청 코드로 교체) -->
    <section id="medical" class="section">
      <h2>실손의료비 <span class="text-indigo-600">간편 계산기</span></h2>
      <p>※ 입력은 <b>환자부담총액(실제 납부액)</b> 기준입니다. 진료비총액/공단부담금은 입력하지 않습니다.</p>
      <div class="sep"></div>

      <div class="wrap-narrow">
        <!-- ==== 여기부터는 사용자가 준 계산기 코드 그대로 ==== -->
        <section class="bg-white rounded-2xl shadow-lg p-6 border border-slate-200">
          <!-- Generation & Facility Controls -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div class="space-y-2">
              <div class="inline-flex items-center rounded-full px-3 py-1 text-xs font-bold uppercase tracking-wider bg-indigo-600 text-white">세대 선택</div>
              <div class="text-xl font-extrabold text-slate-900" id="currentLabel">현재 선택: <span class="text-indigo-700">4세대(현행)</span></div>
              <select id="genSelect" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg mt-2">
                <option value="4th-basic" selected>4세대(현행)</option>
                <option value="3rd-standard">3세대(표준)</option>
                <option value="2nd-legacy">2세대</option>
              </select>
            </div>
            <div class="space-y-2">
              <div class="inline-flex items-center rounded-full px-3 py-1 text-xs font-bold uppercase tracking-wider bg-emerald-600 text-white">의료기관 유형</div>
              <div class="text-xl font-extrabold text-slate-900">급여 공제 자동 적용</div>
              <select id="facilitySelect" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg mt-2">
                <option value="clinic" selected>의원</option>
                <option value="hospital">병원</option>
                <option value="general">종합병원</option>
                <option value="tertiary">상급종합병원</option>
              </select>
            </div>
          </div>

          <div id="dedSummary" class="mt-2 text-xs text-slate-600"></div>

          <!-- Inputs: Out-of-pocket only -->
          <div class="mt-6 grid grid-cols-1 gap-5">
            <div>
              <label class="block text-base font-bold mb-1 text-slate-800">환자부담총액 - 급여(원)</label>
              <input id="inpCoveredCo" type="text" inputmode="numeric" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg" placeholder="예: 30,000" />
              <p class="text-xs text-slate-500 mt-1">영수증의 “요양급여 본인부담금” 합계</p>
            </div>
            <div>
              <label class="block text-base font-bold mb-1 text-slate-800">환자부담총액 - 비급여(원)</label>
              <input id="inpNonCovered" type="text" inputmode="numeric" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg" placeholder="예: 70,000" />
              <p class="text-xs text-slate-500 mt-1">영수증의 “비급여/전액본인부담/비급여 재료대” 합계(제증명료 등 비보장 제외)</p>
            </div>
          </div>

          <!-- Advanced (still editable, prefilled automatically) -->
          <details class="mt-6">
            <summary class="cursor-pointer text-slate-700 font-semibold">고급 설정(자동 입력값 확인/수정)</summary>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mt-4">
              <div>
                <label class="block text-base font-bold mb-1 text-slate-800">급여 보상(%)</label>
                <input id="advCoveredRate" type="number" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg" />
              </div>
              <div>
                <label class="block text-base font-bold mb-1 text-slate-800">비급여 보상(%)</label>
                <input id="advNonCoveredRate" type="number" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg" />
              </div>
              <div>
                <label class="block text-base font-bold mb-1 text-slate-800">1회 한도(원)</label>
                <input id="advPerCap" type="text" inputmode="numeric" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg" value="0" />
              </div>
              <div>
                <label class="block text-base font-bold mb-1 text-slate-800">급여 공제(원)</label>
                <input id="advDedCovered" type="text" inputmode="numeric" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg" value="0" />
                <p class="text-xs text-slate-500 mt-1">의료기관 유형에 따라 자동 설정</p>
              </div>
              <div>
                <label class="block text-base font-bold mb-1 text-slate-800">비급여 공제(원)</label>
                <input id="advDedNonCovered" type="text" inputmode="numeric" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg" value="0" />
                <p class="text-xs text-slate-500 mt-1">세대 선택에 따라 자동 설정</p>
              </div>
              <div>
                <label class="block text-base font-bold mb-1 text-slate-800">도수·주사·체외(1회 한도)</label>
                <input id="advPhysioCap" type="text" inputmode="numeric" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg" value="0" />
              </div>
              <div>
                <label class="block text-base font-bold mb-1 text-slate-800">연간 한도(남은액)</label>
                <input id="advAnnualRemain" type="text" inputmode="numeric" class="w-full rounded-2xl border border-slate-300 px-4 py-3 text-lg" value="999,999,999" />
              </div>
            </div>
          </details>

          <!-- Actions -->
          <div class="mt-8 flex items-center gap-4">
            <button id="btnCalc" class="inline-flex items-center justify-center rounded-2xl px-7 py-3 text-lg font-semibold shadow-lg text-white bg-gradient-to-r from-sky-500 to-blue-600 hover:from-sky-600 hover:to-blue-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="mr-2" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
              계산하기
            </button>
            <button id="btnReset" class="inline-flex items-center justify-center rounded-2xl px-7 py-3 text-lg font-semibold shadow-lg text-white bg-gradient-to-r from-emerald-500 to-teal-600 hover:from-emerald-600 hover:to-teal-700">
              <svg xmlns="http://www.w3.org/2000/svg" class="mr-2" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="1 4 1 10 7 10"></polyline><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"></path></svg>
              초기화
            </button>
            <button id="btnExample" class="inline-flex items-center justify-center rounded-2xl px-4 py-3 font-semibold shadow bg-gradient-to-r from-slate-200 to-slate-100 hover:from-slate-300 hover:to-slate-200 text-slate-900">예시 입력</button>
          </div>

          <!-- Result -->
          <div id="boxResult" class="mt-6 bg-slate-50 border border-slate-200 rounded-2xl p-5">
            <div class="text-slate-700 text-sm">예상 수령액</div>
            <div class="mt-2 text-4xl font-extrabold" id="txtPayout">0원</div>
            <ul class="mt-3 text-slate-700 text-base space-y-1" id="listExplain"></ul>
          </div>

          <p class="mt-4 text-xs text-slate-500">※ 참고용 계산 결과입니다. 실제 지급은 약관·심사에 따라 달라질 수 있습니다.</p>
        </section>
        <!-- ==== 계산기 코드 여기까지 ==== -->
      </div>
    </section>
  </main>

  <footer class="border-t border-slate-200 bg-white">
    <div class="max-w-6xl mx-auto px-5 py-6 text-sm text-slate-600 text-center">© <span id="y"></span> 청구닷컴</div>
  </footer>

  <script>
  // ===== 공통 유틸/검색 =====
  const $ = (s, el=document)=>el.querySelector(s);
  const $$ = (s, el=document)=>Array.from(el.querySelectorAll(s));
  $("#y").textContent = new Date().getFullYear();

  const q = $("#q"), qClear=$("#q-clear");
  document.addEventListener("keydown", (e)=>{ if(e.key==="/"){e.preventDefault(); q.focus();} if(e.key==="Escape"){ q.value=""; filterRows(); } });
  q.addEventListener("input", filterRows);
  qClear.addEventListener("click", ()=>{ q.value=""; filterRows(); q.focus(); });

  const lossList = $("#loss-list"), lifeList = $("#life-list");

  function telHref(num){ if(!num) return ""; const t = String(num).replace(/[^\d+]/g,""); return t?`tel:${t}`:""; }
  function makeBtn(label, href, cls){
    if(!href) return `<button class="btn btn-muted" disabled>${label}</button>`;
    const isFile=/PDF|확인서/.test(label);
    const isTel = href.startsWith('tel:');
    const attr = isFile ? ' download' : (isTel ? '' : ' target="_blank" rel="noopener"');
    return `<a class="btn ${cls||''}" href="${href}"${attr}>${label}</a>`;
  }
  function brandCell(item){
    const L=item.links||{}; const logo=L.logo||item.logo||(`/assets/logos/${item.name}.png`);
    const inner=`<div class="brand"><img class="logo" src="${logo}" alt="${item.name} 로고" onerror="this.style.display='none'"/><span class="vh">${item.name}</span></div>`;
    return L.system ? `<a href="${L.system}" target="_blank" rel="noopener">${inner}</a>` : inner;
  }
  function row(item){
    const L=item.links||{};
    // 보여줄 번호(텍스트)와 tel: 링크
    const customerTxt = L.customer || L.phone || "";
    const monitorTxt  = L.monitor  || "";
    const faxTxt      = L.fax      || "";

    const customerHref = telHref(customerTxt);
    const monitorHref  = telHref(monitorTxt);
    const faxHref      = telHref(faxTxt);

    // 모바일청구는 의도적으로 제외
    return `
      <div class="row" data-name="${item.name}" data-tags="${(item.tags||[]).join(' ').toLowerCase()}">
        <div>${brandCell(item)}</div>
        <div class="flex flex-wrap gap-2">
          ${makeBtn("전산 접속", L.system, "btn-primary")}
          ${makeBtn("필요서류 안내", L.guide)}
          ${L.dental ? `<a class="btn btn-green" href="${L.dental}" download>치과치료확인서</a>` : `<button class="btn btn-muted" disabled>치과치료확인서</button>`}
          ${L.pdf ? `<a class="btn btn-pdf" href="${L.pdf}" download>보험금 청구서 PDF 다운로드</a>` : `<button class="btn btn-muted" disabled>보험금 청구서 PDF 다운로드</button>`}
          ${makeBtn("홈페이지", L.support)}
          ${makeBtn(customerTxt ? ("고객센터 " + customerTxt) : "고객센터", customerHref)}
          ${makeBtn(monitorTxt ? ("인콜 모니터링 " + monitorTxt) : "인콜 모니터링", monitorHref)}
          ${makeBtn(faxTxt ? ("보험금청구 FAX " + faxTxt) : "보험금청구 FAX", faxHref)}
        </div>
      </div>`;
  }
  function filterRows(){
    const v=(q.value||"").toLowerCase().trim();
    $$(".row").forEach(el=>{
      const key=(el.dataset.name+" "+(el.dataset.tags||"")).toLowerCase();
      el.style.display = key.includes(v) ? "" : "none";
    });
  }
  // 데이터 로드
  fetch("/data/links.json?ts="+Date.now(),{cache:"no-store"})
    .then(r=>r.json())
    .then(json=>{
      const arr=json.carriers||[];
      const loss=arr.filter(x=>x.type==="손해");
      const life=arr.filter(x=>x.type==="생명");
      lossList.innerHTML = loss.map(row).join("");
      lifeList.innerHTML = life.map(row).join("");
      filterRows();
    })
    .catch(()=>{ const err='<div class="p-4 text-center text-sm text-red-600">/data/links.json 로드 실패</div>'; lossList.innerHTML=err; lifeList.innerHTML=err; });
  </script>

  <!-- ===== 실손 계산기: 사용자 제공 코드 스크립트 그대로 삽입 ===== -->
  <script>
    // ===== JS in English only =====
    const KRW = new Intl.NumberFormat('ko-KR');
    const byId = (id)=> document.getElementById(id);

    // Inputs
    const inputs = {
      coveredCo: byId('inpCoveredCo'),
      nonCov: byId('inpNonCovered'),
      covRate: byId('advCoveredRate'),
      nonRate: byId('advNonCoveredRate'),
      perCap: byId('advPerCap'),
      dedCov: byId('advDedCovered'),
      dedNon: byId('advDedNonCovered'),
      physioCap: byId('advPhysioCap'),
      annualRemain: byId('advAnnualRemain')
    };

    // Presets (editable defaults)
    const presets = {
      '4th-basic': { label: '4세대(현행)', coveredRate: 0.8, nonCoveredRate: 0.7, perVisitCap: 0, coveredDeductible: 10000, nonCoveredDeductible: 15000, physioPerVisitCap: 0, annualRemain: 999999999 },
      '3rd-standard': { label: '3세대(표준)', coveredRate: 0.9, nonCoveredRate: 0.8, perVisitCap: 0, coveredDeductible: 10000, nonCoveredDeductible: 20000, physioPerVisitCap: 0, annualRemain: 999999999 },
      '2nd-legacy': { label: '2세대', coveredRate: 0.9, nonCoveredRate: 0.8, perVisitCap: 0, coveredDeductible: 10000, nonCoveredDeductible: 30000, physioPerVisitCap: 0, annualRemain: 999999999 }
    };

    // Facility deductibles for covered (editable defaults)
    const facilityCoveredDed = { // per-visit covered deductible
      clinic: 10000,     // 의원
      hospital: 15000,   // 병원
      general: 20000,    // 종합병원
      tertiary: 20000    // 상급종합병원
    };

    function onlyDigits(s){ return String(s||'').replace(/[^0-9]/g, ''); }
    function toNumber(text){ return Number(onlyDigits(text)||0); }
    function fmtKRW(n){ return KRW.format(Math.max(0, Math.round(Number(n||0)))); }

    function attachCurrencyFormatter(el){
      el.addEventListener('blur', ()=>{ el.value = fmtKRW(toNumber(el.value)); });
      el.addEventListener('focus', ()=>{ const v = onlyDigits(el.value); el.value = v ? KRW.format(v) : ''; });
      el.addEventListener('input', ()=>{
        const raw = onlyDigits(el.value);
        el.value = raw ? KRW.format(raw) : '';
        el.setSelectionRange(el.value.length, el.value.length);
      });
    }

    [inputs.coveredCo, inputs.nonCov, inputs.perCap, inputs.dedCov, inputs.dedNon, inputs.physioCap, inputs.annualRemain].forEach(attachCurrencyFormatter);

    const genSelect = byId('genSelect');
    const facilitySelect = byId('facilitySelect');
    const dedSummary = byId('dedSummary');

    const LSK_GEN = 'calc_gen';
    const LSK_FAC = 'calc_fac';

    function updateDedSummary(){
      const cov = toNumber(inputs.dedCov.value);
      const non = toNumber(inputs.dedNon.value);
      dedSummary.textContent = `적용 공제(방문 1회): 급여 ${fmtKRW(cov)}원 / 비급여 ${fmtKRW(non)}원`;
    }

    function applyGen(key){
      const p = presets[key];
      if(!p) return;
      inputs.covRate.value = Math.round((p.coveredRate||0)*100);
      inputs.nonRate.value = Math.round((p.nonCoveredRate||0)*100);
      inputs.perCap.value = fmtKRW(p.perVisitCap||0);
      inputs.dedNon.value = fmtKRW(p.nonCoveredDeductible||0);
      inputs.physioCap.value = fmtKRW(p.physioPerVisitCap||0);
      inputs.annualRemain.value = fmtKRW(p.annualRemain||999999999);
      const lbl = byId('currentLabel');
      if(lbl) lbl.innerHTML = `현재 선택: <span class="text-indigo-700">${p.label}</span>`;
      localStorage.setItem(LSK_GEN, key);
      applyFacility(facilitySelect.value);
      updateDedSummary();
    }

    function applyFacility(fac){
      const ded = facilityCoveredDed[fac] ?? 10000;
      inputs.dedCov.value = fmtKRW(ded);
      localStorage.setItem(LSK_FAC, fac);
      updateDedSummary();
    }

    const savedGen = localStorage.getItem(LSK_GEN) || '4th-basic';
    const savedFac = localStorage.getItem(LSK_FAC) || 'clinic';
    genSelect.value = savedGen;
    facilitySelect.value = savedFac;

    applyGen(savedGen);
    applyFacility(savedFac);

    genSelect.addEventListener('change', ()=> applyGen(genSelect.value));
    facilitySelect.addEventListener('change', ()=> applyFacility(facilitySelect.value));

    byId('btnExample').addEventListener('click', ()=>{
      inputs.coveredCo.value = fmtKRW(30000);
      inputs.nonCov.value = fmtKRW(70000);
      const box = byId('boxResult');
      if(box){ box.classList.add('ring-2','ring-amber-300'); setTimeout(()=> box.classList.remove('ring-2','ring-amber-300'), 500); }
    });

    function calc(){
      const coveredCo = toNumber(inputs.coveredCo.value);
      const nonCovAmt = toNumber(inputs.nonCov.value);
      if(coveredCo === 0 && nonCovAmt === 0){ alert('금액을 입력하세요'); return; }

      const covRate = Number(inputs.covRate.value||0)/100;
      const nonRate = Number(inputs.nonRate.value||0)/100;
      const perCap = toNumber(inputs.perCap.value);
      const dedCov = toNumber(inputs.dedCov.value);
      const dedNon = toNumber(inputs.dedNon.value);
      const physioCap = toNumber(inputs.physioCap.value);
      const annualRemain = toNumber(inputs.annualRemain.value) || 999999999;

      const covBase = Math.max(0, coveredCo - dedCov);
      const nonBase = Math.max(0, Math.max(0, nonCovAmt - dedNon));

      const covPay = covBase * covRate;
      let nonPay = nonBase * nonRate;
      if(physioCap>0) nonPay = Math.min(nonPay, physioCap);

      let payout = covPay + nonPay;
      if(perCap>0) payout = Math.min(payout, perCap);
      payout = Math.min(payout, annualRemain);

      byId('txtPayout').textContent = fmtKRW(payout) + '원';

      const lines = [
        `급여 보상: ${fmtKRW(covPay)}원 (기준 ${fmtKRW(covBase)}원 × ${Math.round(covRate*100)}%)`,
        `비급여 보상: ${fmtKRW(nonPay)}원 (기준 ${fmtKRW(nonBase)}원 × ${Math.round(nonRate*100)}%)`,
        `적용 공제: 급여 ${fmtKRW(dedCov)}원 / 비급여 ${fmtKRW(dedNon)}원`
      ];
      if(perCap>0) lines.push(`1회 한도 적용: 최대 ${fmtKRW(perCap)}원`);
      if(physioCap>0) lines.push(`도수·주사·체외 한도 적용: 최대 ${fmtKRW(physioCap)}원`);
      if(annualRemain>0 && annualRemain<999999999) lines.push(`연간 잔여 한도: ${fmtKRW(annualRemain)}원`);

      const ul = byId('listExplain');
      ul.innerHTML = '';
      lines.forEach(t=>{ const li = document.createElement('li'); li.textContent = '• ' + t; ul.appendChild(li); });
    }

    byId('btnCalc').addEventListener('click', calc);

    byId('btnReset').addEventListener('click', ()=>{
      [inputs.coveredCo, inputs.nonCov].forEach(el=> el.value='');
      genSelect.value = '4th-basic';
      facilitySelect.value = 'clinic';
      applyGen('4th-basic');
      applyFacility('clinic');
      byId('txtPayout').textContent = '0원';
      byId('listExplain').innerHTML = '';
    });
  </script>
</body>
</html>
